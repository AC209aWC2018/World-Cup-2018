<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>&lt;no title&gt; &#8212; World Cup  documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          World Cup</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/problem_statement.html">Overview and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/related_works.html">Literature Review and Related Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/data_description.html">Description of Data</a></li>
</ul>
<p class="caption"><span class="caption-text">EDA:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/eda_writeup.html">Exploratory Data Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Models:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/baseline_writeup.html">Baseline Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/beyond_baseline_writeup.html">Beyond Baseline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/neural_network_writeup.html">Bonus: Neural Network on Small Training Set</a></li>
</ul>
<p class="caption"><span class="caption-text">Summary and Conclusion:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/results_writeup.html">Results Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/summary.html">Project Summary and Future Work</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul class="simple">
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/scrap/GDP.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/fifa/international_results.csv&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># restrict dates</span>
<span class="n">earliest_date</span> <span class="o">=</span> <span class="s1">&#39;2010-01-01&#39;</span>
<span class="n">latest_date</span> <span class="o">=</span> <span class="s1">&#39;2018-06-14&#39;</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="p">[(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">earliest_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">latest_date</span><span class="p">)]</span>
<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>home_team</th>
      <th>away_team</th>
      <th>home_score</th>
      <th>away_score</th>
      <th>tournament</th>
      <th>city</th>
      <th>country</th>
      <th>neutral</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>31700</th>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Iran</td>
      <td>Korea DPR</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Doha</td>
      <td>Qatar</td>
      <td>True</td>
    </tr>
    <tr>
      <th>31701</th>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Qatar</td>
      <td>Mali</td>
      <td>0</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Doha</td>
      <td>Qatar</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31702</th>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Syria</td>
      <td>Zimbabwe</td>
      <td>6</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Kuala Lumpur</td>
      <td>Malaysia</td>
      <td>True</td>
    </tr>
    <tr>
      <th>31703</th>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Yemen</td>
      <td>Tajikistan</td>
      <td>0</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Sana'a</td>
      <td>Yemen</td>
      <td>False</td>
    </tr>
    <tr>
      <th>31704</th>
      <td>2010-01-03 00:00:00+00:00</td>
      <td>Angola</td>
      <td>Gambia</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Vila Real de Santo António</td>
      <td>Portugal</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># response variable</span>
<span class="n">score_diff</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;home_score&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;away_score&#39;</span><span class="p">]</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;home_win&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">score_diff</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/team_stats_final.csv&#39;</span><span class="p">)</span>
<span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>

<span class="c1"># restrict dates</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[(</span><span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">earliest_date</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">latest_date</span><span class="p">)]</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team</th>
      <th>date</th>
      <th>attack</th>
      <th>defence</th>
      <th>full_age</th>
      <th>midfield</th>
      <th>overall</th>
      <th>prestige</th>
      <th>start_age</th>
      <th>bup_speed</th>
      <th>...</th>
      <th>cc_passing</th>
      <th>cc_crossing</th>
      <th>cc_shooting</th>
      <th>d_pressure</th>
      <th>d_aggresion</th>
      <th>d_width</th>
      <th>wage_euros_thousands</th>
      <th>value_euros_millions</th>
      <th>growth</th>
      <th>goalkeeeper_overall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1364</th>
      <td>Brazil</td>
      <td>2018-05-28</td>
      <td>86.0</td>
      <td>85.0</td>
      <td>27.09</td>
      <td>83.0</td>
      <td>85.0</td>
      <td>10.0</td>
      <td>26.73</td>
      <td>51.0</td>
      <td>...</td>
      <td>39.0</td>
      <td>33.0</td>
      <td>67.0</td>
      <td>76.0</td>
      <td>73.0</td>
      <td>63.0</td>
      <td>123.608696</td>
      <td>32.500000</td>
      <td>1.826087</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1365</th>
      <td>England</td>
      <td>2018-05-28</td>
      <td>84.0</td>
      <td>81.0</td>
      <td>24.65</td>
      <td>81.0</td>
      <td>82.0</td>
      <td>8.0</td>
      <td>25.00</td>
      <td>49.0</td>
      <td>...</td>
      <td>55.0</td>
      <td>41.0</td>
      <td>49.0</td>
      <td>43.0</td>
      <td>55.0</td>
      <td>49.0</td>
      <td>100.391304</td>
      <td>21.065217</td>
      <td>3.608696</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>1366</th>
      <td>Italy</td>
      <td>2018-05-28</td>
      <td>85.0</td>
      <td>85.0</td>
      <td>26.04</td>
      <td>81.0</td>
      <td>83.0</td>
      <td>9.0</td>
      <td>28.45</td>
      <td>73.0</td>
      <td>...</td>
      <td>64.0</td>
      <td>80.0</td>
      <td>78.0</td>
      <td>29.0</td>
      <td>33.0</td>
      <td>32.0</td>
      <td>91.521739</td>
      <td>24.869565</td>
      <td>3.173913</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>1367</th>
      <td>Spain</td>
      <td>2018-05-28</td>
      <td>84.0</td>
      <td>86.0</td>
      <td>27.04</td>
      <td>86.0</td>
      <td>86.0</td>
      <td>9.0</td>
      <td>28.18</td>
      <td>32.0</td>
      <td>...</td>
      <td>27.0</td>
      <td>32.0</td>
      <td>20.0</td>
      <td>75.0</td>
      <td>62.0</td>
      <td>52.0</td>
      <td>168.695652</td>
      <td>39.239130</td>
      <td>1.826087</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>1368</th>
      <td>France</td>
      <td>2018-05-28</td>
      <td>83.0</td>
      <td>82.0</td>
      <td>25.65</td>
      <td>85.0</td>
      <td>84.0</td>
      <td>9.0</td>
      <td>25.18</td>
      <td>35.0</td>
      <td>...</td>
      <td>24.0</td>
      <td>53.0</td>
      <td>35.0</td>
      <td>47.0</td>
      <td>47.0</td>
      <td>67.0</td>
      <td>110.782609</td>
      <td>31.304348</td>
      <td>3.173913</td>
      <td>88.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">fifa_rankings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/fifa_ranking.csv&#39;</span><span class="p">)</span>
<span class="n">fifa_rankings</span><span class="p">[</span><span class="s1">&#39;rank_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">fifa_rankings</span><span class="p">[</span><span class="s1">&#39;rank_date&#39;</span><span class="p">])</span>
<span class="n">fifa_rankings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rank</th>
      <th>country_full</th>
      <th>country_abrv</th>
      <th>total_points</th>
      <th>previous_points</th>
      <th>rank_change</th>
      <th>cur_year_avg</th>
      <th>cur_year_avg_weighted</th>
      <th>last_year_avg</th>
      <th>last_year_avg_weighted</th>
      <th>two_year_ago_avg</th>
      <th>two_year_ago_weighted</th>
      <th>three_year_ago_avg</th>
      <th>three_year_ago_weighted</th>
      <th>confederation</th>
      <th>rank_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>Germany</td>
      <td>GER</td>
      <td>0.0</td>
      <td>57</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>UEFA</td>
      <td>1993-08-08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>Italy</td>
      <td>ITA</td>
      <td>0.0</td>
      <td>57</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>UEFA</td>
      <td>1993-08-08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Switzerland</td>
      <td>SUI</td>
      <td>0.0</td>
      <td>50</td>
      <td>9</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>UEFA</td>
      <td>1993-08-08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>Sweden</td>
      <td>SWE</td>
      <td>0.0</td>
      <td>55</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>UEFA</td>
      <td>1993-08-08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>Argentina</td>
      <td>ARG</td>
      <td>0.0</td>
      <td>51</td>
      <td>5</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>CONMEBOL</td>
      <td>1993-08-08</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>We now have to find for each match the latest team ratings and ranking.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ratings</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
<span class="n">teams</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># check that we found the corresponding team from team ratings in results</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">home_team</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot Find </span><span class="si">{}</span><span class="s1"> in Results Home&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">away_team</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot Find </span><span class="si">{}</span><span class="s1"> in Results Away&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">teams</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fifa_rankings</span><span class="o">.</span><span class="n">country_full</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot Find </span><span class="si">{}</span><span class="s1"> in Rankings&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cannot Find Republic of Ireland in Results Home
Cannot Find United States in Results Home
Cannot Find China PR in Results Home
Cannot Find Côte d&#39;Ivoire in Results Home
Cannot Find Republic of Ireland in Results Away
Cannot Find United States in Results Away
Cannot Find China PR in Results Away
Cannot Find Côte d&#39;Ivoire in Results Away
Cannot Find United States in Rankings
Cannot Find Iran in Rankings
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">unicodedata</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">get_countries_by_continent</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://simple.wikipedia.org/wiki/List_of_countries_by_continents&quot;</span>
    <span class="n">my_page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">my_page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
    <span class="n">continents_obj</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;mw-headline&#39;</span><span class="p">})</span>
    <span class="n">continents_obj</span> <span class="o">=</span> <span class="n">continents_obj</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">country_to_continent</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">continents</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">continent</span> <span class="ow">in</span> <span class="n">continents_obj</span><span class="p">:</span>
        <span class="n">continents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">continent</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
        <span class="n">raw_countries</span> <span class="o">=</span> <span class="n">continent</span><span class="o">.</span><span class="n">findNext</span><span class="p">(</span><span class="s1">&#39;ul&#39;</span><span class="p">)</span>
        <span class="n">raw_countries</span> <span class="o">=</span> <span class="n">raw_countries</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">raw_countries</span><span class="p">:</span>
            <span class="n">country_name</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># remove secondary names</span>
            <span class="n">idx</span> <span class="o">=</span> <span class="n">country_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;(&#39;</span><span class="p">)</span>
            <span class="n">idx2</span> <span class="o">=</span> <span class="n">country_name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;[&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">country_name</span> <span class="o">=</span> <span class="n">country_name</span><span class="p">[:</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">idx</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">country_name</span> <span class="o">=</span> <span class="n">country_name</span><span class="p">[:</span><span class="n">idx2</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">country_name</span> <span class="o">=</span> <span class="n">country_name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
            <span class="n">country_to_continent</span><span class="p">[</span><span class="n">country_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">continent</span><span class="o">.</span><span class="n">text</span>


    <span class="k">return</span> <span class="n">country_to_continent</span><span class="p">,</span><span class="n">continents</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">country_to_continent</span><span class="p">,</span><span class="n">continents</span> <span class="o">=</span> <span class="n">get_countries_by_continent</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Ivory Coast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Côte d&#39;Ivoire&quot;</span><span class="p">)</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;England&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;United Kingdom&quot;</span><span class="p">)</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Korea Republic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;South Korea&quot;</span><span class="p">)</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;USA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;United States of America&quot;</span><span class="p">)</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Ireland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Republic of Ireland&quot;</span><span class="p">)</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Northern Ireland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Ireland&#39;</span><span class="p">]</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Iceland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Eastern Iceland&quot;</span><span class="p">)</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Wales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;England&#39;</span><span class="p">]</span>
<span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;Scotland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="s1">&#39;England&#39;</span><span class="p">]</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">my_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">my_set</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Before we proceed with anything else, let’s check that country names are
spelled similarly. We find that ‘Republic of Ireland’, ‘United States’,
‘China PR’, and ‘Côte d’Ivoire’ might be spelled differently.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;Republic of Ireland&#39;</span><span class="p">,</span> <span class="s1">&#39;Ireland&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;United States&#39;</span><span class="p">,</span> <span class="s1">&#39;USA&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;China PR&#39;</span><span class="p">,</span> <span class="s1">&#39;China&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Côte d&#39;Ivoire&quot;</span><span class="p">,</span> <span class="s1">&#39;Ivory Coast&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fifa_rankings</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;IR Iran&quot;</span><span class="p">,</span> <span class="s2">&quot;Iran&quot;</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">ratings</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">my_set</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">countries</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">country_to_continent</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ratings</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
         <span class="n">countries</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">scrape_gdp_pp</span><span class="p">():</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(PPP)_per_capita&quot;</span>
    <span class="n">my_page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">my_page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
    <span class="n">tables</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;wikitable sortable&#39;</span><span class="p">})</span>
    <span class="n">country_rows</span> <span class="o">=</span> <span class="n">tables</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)</span>
    <span class="n">countries_data</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">country</span> <span class="ow">in</span> <span class="n">country_rows</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="n">country_data</span> <span class="o">=</span> <span class="n">country</span><span class="o">.</span><span class="n">findAll</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">country_data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
        <span class="n">country_name</span> <span class="o">=</span> <span class="n">unicodedata</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="s2">&quot;NFKD&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="n">country_name</span> <span class="o">=</span> <span class="n">country_name</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="n">gdp_pp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">country_data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">))</span>

        <span class="n">countries_data</span><span class="p">[</span><span class="n">country_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_pp</span>

    <span class="k">return</span> <span class="n">countries_data</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdp_countries</span> <span class="o">=</span> <span class="n">scrape_gdp_pp</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdp_countries</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[17]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>{&#39;Qatar&#39;: 124927,
 &#39;Macau&#39;: 114430,
 &#39;Luxembourg&#39;: 109192,
 &#39;Singapore&#39;: 90531,
 &#39;Brunei&#39;: 76743,
 &#39;Ireland&#39;: 72632,
 &#39;Norway&#39;: 70590,
 &#39;Kuwait&#39;: 69669,
 &#39;United Arab Emirates&#39;: 68245,
 &#39;Switzerland&#39;: 61360,
 &#39;Hong Kong&#39;: 61016,
 &#39;San Marino&#39;: 60359,
 &#39;United States&#39;: 59495,
 &#39;Saudi Arabia&#39;: 55263,
 &#39;Netherlands&#39;: 53582,
 &#39;Iceland&#39;: 52150,
 &#39;Bahrain&#39;: 51846,
 &#39;Sweden&#39;: 51264,
 &#39;Germany&#39;: 50206,
 &#39;Australia&#39;: 49882,
 &#39;Taiwan&#39;: 49827,
 &#39;Denmark&#39;: 49613,
 &#39;Austria&#39;: 49247,
 &#39;Canada&#39;: 48141,
 &#39;Belgium&#39;: 46301,
 &#39;Oman&#39;: 45464,
 &#39;Finland&#39;: 44050,
 &#39;United Kingdom&#39;: 43620,
 &#39;France&#39;: 43550,
 &#39;Japan&#39;: 42659,
 &#39;Malta&#39;: 42532,
 &#39;South Korea&#39;: 39387,
 &#39;New Zealand&#39;: 38502,
 &#39;Spain&#39;: 38171,
 &#39;Italy&#39;: 37970,
 &#39;Puerto Rico&#39;: 37895,
 &#39;Cyprus&#39;: 36557,
 &#39;Israel&#39;: 36250,
 &#39;Czech Republic&#39;: 35223,
 &#39;Equatorial Guinea&#39;: 34865,
 &#39;Slovenia&#39;: 34063,
 &#39;Slovakia&#39;: 32895,
 &#39;Lithuania&#39;: 31935,
 &#39;Estonia&#39;: 31473,
 &#39;Trinidad and Tobago&#39;: 31154,
 &#39;Portugal&#39;: 30258,
 &#39;Poland&#39;: 29251,
 &#39;Hungary&#39;: 28910,
 &#39;Malaysia&#39;: 28871,
 &#39;Seychelles&#39;: 28712,
 &#39;Russia&#39;: 27890,
 &#39;Greece&#39;: 27776,
 &#39;Latvia&#39;: 27291,
 &#39;Saint Kitts and Nevis&#39;: 26849,
 &#39;Antigua and Barbuda&#39;: 26198,
 &#39;Turkey&#39;: 26453,
 &#39;Kazakhstan&#39;: 26071,
 &#39;Bahamas, The&#39;: 25080,
 &#39;Chile&#39;: 24588,
 &#39;Panama&#39;: 24262,
 &#39;Croatia&#39;: 24095,
 &#39;Romania&#39;: 23991,
 &#39;Uruguay&#39;: 22445,
 &#39;Mauritius&#39;: 21628,
 &#39;Bulgaria&#39;: 21578,
 &#39;Argentina&#39;: 20677,
 &#39;Iran&#39;: 20030,
 &#39;Mexico&#39;: 19480,
 &#39;Lebanon&#39;: 19486,
 &#39;Gabon&#39;: 19266,
 &#39;Maldives&#39;: 19178,
 &#39;Turkmenistan&#39;: 18680,
 &#39;Belarus&#39;: 18616,
 &#39;Botswana&#39;: 18146,
 &#39;Thailand&#39;: 17786,
 &#39;Barbados&#39;: 17508,
 &#39;Montenegro&#39;: 17439,
 &#39;Azerbaijan&#39;: 17433,
 &#39;Costa Rica&#39;: 17149,
 &#39;Iraq&#39;: 17004,
 &#39;Dominican Republic&#39;: 16965,
 &#39;World[n 1]&#39;: 16779,
 &#39;China&#39;: 16624,
 &#39;Palau&#39;: 16472,
 &#39;Brazil&#39;: 15500,
 &#39;Macedonia&#39;: 15203,
 &#39;Serbia&#39;: 15164,
 &#39;Algeria&#39;: 15150,
 &#39;Grenada&#39;: 14779,
 &#39;Colombia&#39;: 14455,
 &#39;Suriname&#39;: 13876,
 &#39;Saint Lucia&#39;: 13579,
 &#39;South Africa&#39;: 13403,
 &#39;Peru&#39;: 13342,
 &#39;Sri Lanka&#39;: 13001,
 &#39;Egypt&#39;: 12994,
 &#39;Mongolia&#39;: 12551,
 &#39;Jordan&#39;: 12487,
 &#39;Albania&#39;: 12472,
 &#39;Venezuela&#39;: 12388,
 &#39;Indonesia&#39;: 12378,
 &#39;Dominica&#39;: 12035,
 &#39;Kosovo&#39;: 12003,
 &#39;Nauru&#39;: 11995,
 &#39;Tunisia&#39;: 11987,
 &#39;Saint Vincent and the Grenadines&#39;: 11623,
 &#39;Namibia&#39;: 11528,
 &#39;Bosnia and Herzegovina&#39;: 11404,
 &#39;Ecuador&#39;: 11234,
 &#39;Georgia&#39;: 10644,
 &#39;Swaziland&#39;: 9882,
 &#39;Fiji&#39;: 9857,
 &#39;Libya&#39;: 9792,
 &#39;Paraguay&#39;: 9785,
 &#39;Jamaica&#39;: 9212,
 &#39;Armenia&#39;: 9098,
 &#39;El Salvador&#39;: 8934,
 &#39;Bhutan&#39;: 8720,
 &#39;Ukraine&#39;: 8656,
 &#39;Morocco&#39;: 8612,
 &#39;Belize&#39;: 8341,
 &#39;Guyana&#39;: 8266,
 &#39;Philippines&#39;: 8229,
 &#39;Guatemala&#39;: 8173,
 &#39;Bolivia&#39;: 7543,
 &#39;Laos&#39;: 7367,
 &#39;India&#39;: 7174,
 &#39;Uzbekistan&#39;: 6990,
 &#39;Cape Verde&#39;: 6942,
 &#39;Vietnam&#39;: 6876,
 &#39;Angola&#39;: 6813,
 &#39;Congo, Rep.&#39;: 6707,
 &#39;Myanmar&#39;: 6285,
 &#39;Nigeria&#39;: 5927,
 &#39;Nicaragua&#39;: 5823,
 &#39;Samoa&#39;: 5737,
 &#39;Moldova&#39;: 5657,
 &#39;Tonga&#39;: 5605,
 &#39;Honduras&#39;: 5499,
 &#39;Pakistan&#39;: 5354,
 &#39;Timor-Leste&#39;: 5008,
 &#39;Ghana&#39;: 4605,
 &#39;Sudan&#39;: 4580,
 &#39;Bangladesh&#39;: 4561,
 &#39;Mauritania&#39;: 4474,
 &#39;Cambodia&#39;: 4010,
 &#39;Zambia&#39;: 3997,
 &#39;Lesotho&#39;: 3869,
 &quot;Côte d&#39;Ivoire&quot;: 3857,
 &#39;Tuvalu&#39;: 3804,
 &#39;Papua New Guinea&#39;: 3803,
 &#39;Kyrgyzstan&#39;: 3652,
 &#39;Djibouti&#39;: 3567,
 &#39;Kenya&#39;: 3496,
 &#39;Marshall Islands&#39;: 3436,
 &#39;Micronesia&#39;: 3392,
 &#39;Cameroon&#39;: 3359,
 &#39;Tanzania&#39;: 3283,
 &#39;São Tomé and Príncipe&#39;: 3208,
 &#39;Tajikistan&#39;: 3131,
 &#39;Vanuatu&#39;: 2780,
 &#39;Nepal&#39;: 2690,
 &#39;Senegal&#39;: 2678,
 &#39;Chad&#39;: 2433,
 &#39;Uganda&#39;: 2352,
 &#39;Yemen&#39;: 2300,
 &#39;Zimbabwe&#39;: 2277,
 &#39;Benin&#39;: 2219,
 &#39;Mali&#39;: 2169,
 &#39;Solomon Islands&#39;: 2145,
 &#39;Ethiopia&#39;: 2113,
 &#39;Rwanda&#39;: 2081,
 &#39;Guinea&#39;: 2039,
 &#39;Kiribati&#39;: 1958,
 &#39;Afghanistan&#39;: 1889,
 &#39;Burkina Faso&#39;: 1884,
 &#39;Haiti&#39;: 1810,
 &#39;Guinea-Bissau&#39;: 1806,
 &#39;Sierra Leone&#39;: 1791,
 &#39;Gambia, The&#39;: 1686,
 &#39;South Sudan&#39;: 1503,
 &#39;Togo&#39;: 1612,
 &#39;Comoros&#39;: 1560,
 &#39;Madagascar&#39;: 1554,
 &#39;Eritrea&#39;: 1434,
 &#39;Mozambique&#39;: 1266,
 &#39;Malawi&#39;: 1172,
 &#39;Niger&#39;: 1153,
 &#39;Liberia&#39;: 867,
 &#39;Burundi&#39;: 808,
 &#39;Congo, Dem. Rep.&#39;: 785,
 &#39;Central African Republic&#39;: 681}
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;Ivory Coast&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;Côte d&#39;Ivoire&quot;</span><span class="p">)</span>
<span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;England&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;United Kingdom&quot;</span><span class="p">)</span>
<span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;Korea Republic&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;South Korea&quot;</span><span class="p">)</span>
<span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;USA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;United States&quot;</span><span class="p">)</span>
<span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;Northern Ireland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;Ireland&#39;</span><span class="p">]</span>
<span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;Wales&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;England&#39;</span><span class="p">]</span>
<span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;Scotland&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">gdp_countries</span><span class="p">[</span><span class="s1">&#39;England&#39;</span><span class="p">]</span>


</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">countryset</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">gdp_countries</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">countries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">countryset</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">continents</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[20]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>[&#39;Africa&#39;,
 &#39;Antarctica&#39;,
 &#39;Asia&#39;,
 &#39;Europe&#39;,
 &#39;America&#39;,
 &#39;North America&#39;,
 &#39;Central America and the Antilles&#39;,
 &#39;South America&#39;,
 &#39;Oceania&#39;,
 &#39;Australia&#39;,
 &#39;Australasian&#39;]
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">country</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="n">gdp_countries</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">country</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">country_to_continent</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">country</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Macau
Hong Kong
Bahamas, The
World[n 1]
Congo, Rep.
Timor-Leste
Micronesia
São Tomé and Príncipe
Guinea-Bissau
Gambia, The
Congo, Dem. Rep.
</pre></div></div>
</div>
<p>Now we finally have two datasets of teams spelled in the same way.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># find closest date that we have data</span>
<span class="k">def</span> <span class="nf">get_latest_date</span><span class="p">(</span><span class="n">match_date</span><span class="p">,</span> <span class="n">dates</span><span class="p">):</span>
    <span class="n">match_date</span> <span class="o">=</span> <span class="n">match_date</span><span class="o">.</span><span class="n">to_datetime64</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">dates</span><span class="p">[</span><span class="n">match_date</span> <span class="o">&gt;</span>  <span class="n">dates</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

<span class="c1"># results[&#39;closest_date&#39;] = results.apply(lambda i: min(dates, key=lambda d: abs(d-i.date)), axis=1)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;closest_rating_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_latest_date</span><span class="p">,</span> <span class="n">dates</span> <span class="o">=</span> <span class="n">dates</span><span class="p">)</span>
<span class="n">results</span><span class="p">[</span><span class="s1">&#39;closest_ranking_date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">get_latest_date</span><span class="p">,</span> <span class="n">dates</span> <span class="o">=</span> <span class="n">fifa_rankings</span><span class="o">.</span><span class="n">rank_date</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>home_team</th>
      <th>away_team</th>
      <th>home_score</th>
      <th>away_score</th>
      <th>tournament</th>
      <th>city</th>
      <th>country</th>
      <th>neutral</th>
      <th>home_win</th>
      <th>closest_rating_date</th>
      <th>closest_ranking_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>39601</th>
      <td>2018-06-10 00:00:00+00:00</td>
      <td>Austria</td>
      <td>Brazil</td>
      <td>0</td>
      <td>3</td>
      <td>Friendly</td>
      <td>Vienna</td>
      <td>Austria</td>
      <td>False</td>
      <td>0</td>
      <td>2018-06-07</td>
      <td>2018-06-07</td>
    </tr>
    <tr>
      <th>39602</th>
      <td>2018-06-11 00:00:00+00:00</td>
      <td>Korea Republic</td>
      <td>Senegal</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Grödig</td>
      <td>Austria</td>
      <td>True</td>
      <td>0</td>
      <td>2018-06-07</td>
      <td>2018-06-07</td>
    </tr>
    <tr>
      <th>39603</th>
      <td>2018-06-11 00:00:00+00:00</td>
      <td>Belgium</td>
      <td>Costa Rica</td>
      <td>4</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Brussels</td>
      <td>Belgium</td>
      <td>False</td>
      <td>1</td>
      <td>2018-06-07</td>
      <td>2018-06-07</td>
    </tr>
    <tr>
      <th>39604</th>
      <td>2018-06-12 00:00:00+00:00</td>
      <td>Japan</td>
      <td>Paraguay</td>
      <td>4</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Innsbruck</td>
      <td>Austria</td>
      <td>True</td>
      <td>1</td>
      <td>2018-06-11</td>
      <td>2018-06-07</td>
    </tr>
    <tr>
      <th>39605</th>
      <td>2018-06-12 00:00:00+00:00</td>
      <td>Poland</td>
      <td>Lithuania</td>
      <td>4</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Warsaw</td>
      <td>Poland</td>
      <td>False</td>
      <td>1</td>
      <td>2018-06-11</td>
      <td>2018-06-07</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now that we have the closest matching data for both of our datasets, we
can merge on team and date. We will first do this for the ratings
dataset.</p>
<p>Note that for both the ratings and rankings tables we have merge twice
in order to account for both home and away teams.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Reset index to keep track of original index</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="n">results_ratings1</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;closest_rating_date&#39;</span><span class="p">,</span> <span class="s1">&#39;home_team&#39;</span><span class="p">],</span>
                                <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;team&#39;</span><span class="p">])</span>

<span class="n">results_ratings2</span> <span class="o">=</span> <span class="n">results_ratings1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ratings</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                       <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;closest_rating_date&#39;</span><span class="p">,</span> <span class="s1">&#39;away_team&#39;</span><span class="p">],</span>
                                       <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span> <span class="s1">&#39;team&#39;</span><span class="p">])</span>

<span class="n">results_ratings2</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>date_x</th>
      <th>home_team</th>
      <th>away_team</th>
      <th>home_score</th>
      <th>away_score</th>
      <th>tournament</th>
      <th>city</th>
      <th>country</th>
      <th>neutral</th>
      <th>...</th>
      <th>cc_passing_y</th>
      <th>cc_crossing_y</th>
      <th>cc_shooting_y</th>
      <th>d_pressure_y</th>
      <th>d_aggresion_y</th>
      <th>d_width_y</th>
      <th>wage_euros_thousands_y</th>
      <th>value_euros_millions_y</th>
      <th>growth_y</th>
      <th>goalkeeeper_overall_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>31786</td>
      <td>2010-02-24 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Bolivia</td>
      <td>5</td>
      <td>0</td>
      <td>Friendly</td>
      <td>San Francisco</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>53.0</td>
      <td>72.0</td>
      <td>64.0</td>
      <td>47.0</td>
      <td>33.0</td>
      <td>64.0</td>
      <td>0.869565</td>
      <td>0.275</td>
      <td>4.391304</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31823</td>
      <td>2010-03-03 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>New Zealand</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Pasadena</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31878</td>
      <td>2010-05-24 00:00:00+00:00</td>
      <td>Australia</td>
      <td>New Zealand</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Melbourne</td>
      <td>Australia</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32000</td>
      <td>2010-06-20 00:00:00+00:00</td>
      <td>Italy</td>
      <td>New Zealand</td>
      <td>1</td>
      <td>1</td>
      <td>FIFA World Cup</td>
      <td>Nelspruit</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31949</td>
      <td>2010-06-04 00:00:00+00:00</td>
      <td>Slovenia</td>
      <td>New Zealand</td>
      <td>3</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Maribor</td>
      <td>Slovenia</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 57 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># # Keeping track of index of matches for inner join</span>
<span class="c1"># gdp_col = []</span>
<span class="c1"># for col1,col2,idx in zip(results_ratings2[&#39;home_team&#39;].items(),results_ratings2[&#39;away_team&#39;].items(),results_ratings2[&#39;index&#39;].items()):</span>
<span class="c1">#     team1 = col1[1]</span>
<span class="c1">#     team2 = col2[1]</span>
<span class="c1">#     if country_to_continent[team1] != country_to_continent[team2]:</span>
<span class="c1">#         gdp_col.append({&#39;idx&#39;:idx[1],&#39;gdp_diff&#39;:0})</span>
<span class="c1">#     elif gdp_countries[team1] &gt; gdp_countries[team2]:</span>
<span class="c1">#         gdp_col.append({&#39;idx&#39;:idx[1],&#39;gdp_diff&#39;:1})</span>
<span class="c1">#     else:</span>
<span class="c1">#         gdp_col.append({&#39;idx&#39;:idx[1],&#39;gdp_diff&#39;:-1})</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Keeping track of index of matches for inner join</span>
<span class="n">gdp_col</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">col1</span><span class="p">,</span><span class="n">col2</span><span class="p">,</span><span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results_ratings2</span><span class="p">[</span><span class="s1">&#39;home_team&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">results_ratings2</span><span class="p">[</span><span class="s1">&#39;away_team&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">results_ratings2</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">team1</span> <span class="o">=</span> <span class="n">col1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">team2</span> <span class="o">=</span> <span class="n">col2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="n">team1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="n">team2</span><span class="p">]:</span>
        <span class="n">gdp_col</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;idx&#39;</span><span class="p">:</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;gdp_diff&#39;</span><span class="p">:</span><span class="mi">0</span><span class="p">})</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gdp_col</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;idx&#39;</span><span class="p">:</span><span class="n">idx</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="s1">&#39;gdp_diff&#39;</span><span class="p">:</span><span class="nb">float</span><span class="p">(</span><span class="n">gdp_countries</span><span class="p">[</span><span class="n">team1</span><span class="p">])</span><span class="o">/</span><span class="n">gdp_countries</span><span class="p">[</span><span class="n">team2</span><span class="p">]})</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">df_gdp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">gdp_col</span><span class="p">)</span>
<span class="c1"># df_gdp[&#39;gdp_diff&#39;] = df_gdp[&#39;gdp_diff&#39;].astype(&#39;category&#39;)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_ratings2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>date_x</th>
      <th>home_team</th>
      <th>away_team</th>
      <th>home_score</th>
      <th>away_score</th>
      <th>tournament</th>
      <th>city</th>
      <th>country</th>
      <th>neutral</th>
      <th>...</th>
      <th>cc_passing_y</th>
      <th>cc_crossing_y</th>
      <th>cc_shooting_y</th>
      <th>d_pressure_y</th>
      <th>d_aggresion_y</th>
      <th>d_width_y</th>
      <th>wage_euros_thousands_y</th>
      <th>value_euros_millions_y</th>
      <th>growth_y</th>
      <th>goalkeeeper_overall_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>31786</td>
      <td>2010-02-24 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Bolivia</td>
      <td>5</td>
      <td>0</td>
      <td>Friendly</td>
      <td>San Francisco</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>53.0</td>
      <td>72.0</td>
      <td>64.0</td>
      <td>47.0</td>
      <td>33.0</td>
      <td>64.0</td>
      <td>0.869565</td>
      <td>0.275000</td>
      <td>4.391304</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31823</td>
      <td>2010-03-03 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>New Zealand</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Pasadena</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31878</td>
      <td>2010-05-24 00:00:00+00:00</td>
      <td>Australia</td>
      <td>New Zealand</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Melbourne</td>
      <td>Australia</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>32000</td>
      <td>2010-06-20 00:00:00+00:00</td>
      <td>Italy</td>
      <td>New Zealand</td>
      <td>1</td>
      <td>1</td>
      <td>FIFA World Cup</td>
      <td>Nelspruit</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31949</td>
      <td>2010-06-04 00:00:00+00:00</td>
      <td>Slovenia</td>
      <td>New Zealand</td>
      <td>3</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Maribor</td>
      <td>Slovenia</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>32017</td>
      <td>2010-06-24 00:00:00+00:00</td>
      <td>Paraguay</td>
      <td>New Zealand</td>
      <td>0</td>
      <td>0</td>
      <td>FIFA World Cup</td>
      <td>Polokwane</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>8.266667</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>31849</td>
      <td>2010-03-24 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Iceland</td>
      <td>0</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Charlotte</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>67.0</td>
      <td>49.0</td>
      <td>33.0</td>
      <td>47.0</td>
      <td>47.0</td>
      <td>33.0</td>
      <td>14.000000</td>
      <td>2.938043</td>
      <td>2.565217</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>31859</td>
      <td>2010-05-07 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Ecuador</td>
      <td>0</td>
      <td>0</td>
      <td>Friendly</td>
      <td>East Rutherford</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>65.0</td>
      <td>45.0</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.900000</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>31865</td>
      <td>2010-05-16 00:00:00+00:00</td>
      <td>Korea Republic</td>
      <td>Ecuador</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Seoul</td>
      <td>Korea Republic</td>
      <td>False</td>
      <td>...</td>
      <td>65.0</td>
      <td>45.0</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>7.900000</td>
      <td>65.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>31860</td>
      <td>2010-05-10 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Senegal</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Chicago</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>59.0</td>
      <td>53.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>59.0</td>
      <td>48.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.575000</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>31810</td>
      <td>2010-03-03 00:00:00+00:00</td>
      <td>Greece</td>
      <td>Senegal</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Vólos</td>
      <td>Greece</td>
      <td>False</td>
      <td>...</td>
      <td>59.0</td>
      <td>53.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>59.0</td>
      <td>48.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.575000</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>31899</td>
      <td>2010-05-27 00:00:00+00:00</td>
      <td>Denmark</td>
      <td>Senegal</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Aalborg</td>
      <td>Denmark</td>
      <td>False</td>
      <td>...</td>
      <td>59.0</td>
      <td>53.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>59.0</td>
      <td>48.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.575000</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>31866</td>
      <td>2010-05-16 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Chile</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Mexico City</td>
      <td>Mexico</td>
      <td>False</td>
      <td>...</td>
      <td>36.0</td>
      <td>56.0</td>
      <td>56.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>46.0</td>
      <td>34.173913</td>
      <td>7.393478</td>
      <td>3.173913</td>
      <td>71.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>32028</td>
      <td>2010-06-28 00:00:00+00:00</td>
      <td>Brazil</td>
      <td>Chile</td>
      <td>3</td>
      <td>0</td>
      <td>FIFA World Cup</td>
      <td>Johannesburg</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>36.0</td>
      <td>56.0</td>
      <td>56.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>46.0</td>
      <td>34.173913</td>
      <td>7.393478</td>
      <td>3.173913</td>
      <td>71.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>32008</td>
      <td>2010-06-22 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Uruguay</td>
      <td>0</td>
      <td>1</td>
      <td>FIFA World Cup</td>
      <td>Rustenburg</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>30.0</td>
      <td>45.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.733333</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>31984</td>
      <td>2010-06-16 00:00:00+00:00</td>
      <td>South Africa</td>
      <td>Uruguay</td>
      <td>0</td>
      <td>3</td>
      <td>FIFA World Cup</td>
      <td>Pretoria</td>
      <td>South Africa</td>
      <td>False</td>
      <td>...</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>30.0</td>
      <td>45.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.733333</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>31835</td>
      <td>2010-03-03 00:00:00+00:00</td>
      <td>Switzerland</td>
      <td>Uruguay</td>
      <td>1</td>
      <td>3</td>
      <td>Friendly</td>
      <td>St. Gallen</td>
      <td>Switzerland</td>
      <td>False</td>
      <td>...</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>30.0</td>
      <td>45.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.733333</td>
      <td>76.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>32076</td>
      <td>2010-08-11 00:00:00+00:00</td>
      <td>Mexico</td>
      <td>Spain</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Mexico City</td>
      <td>Mexico</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.133333</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>31807</td>
      <td>2010-03-03 00:00:00+00:00</td>
      <td>France</td>
      <td>Spain</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Saint-Denis</td>
      <td>France</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.133333</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>32039</td>
      <td>2010-07-07 00:00:00+00:00</td>
      <td>Germany</td>
      <td>Spain</td>
      <td>0</td>
      <td>1</td>
      <td>FIFA World Cup</td>
      <td>Durban</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.133333</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>32043</td>
      <td>2010-07-11 00:00:00+00:00</td>
      <td>Netherlands</td>
      <td>Spain</td>
      <td>0</td>
      <td>1</td>
      <td>FIFA World Cup</td>
      <td>Johannesburg</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.133333</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>32019</td>
      <td>2010-06-25 00:00:00+00:00</td>
      <td>Chile</td>
      <td>Spain</td>
      <td>1</td>
      <td>2</td>
      <td>FIFA World Cup</td>
      <td>Pretoria</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.133333</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>22</th>
      <td>32037</td>
      <td>2010-07-03 00:00:00+00:00</td>
      <td>Paraguay</td>
      <td>Spain</td>
      <td>0</td>
      <td>1</td>
      <td>FIFA World Cup</td>
      <td>Johannesburg</td>
      <td>South Africa</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>60.0</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.133333</td>
      <td>90.0</td>
    </tr>
    <tr>
      <th>23</th>
      <td>31890</td>
      <td>2010-05-25 00:00:00+00:00</td>
      <td>USA</td>
      <td>Czech Republic</td>
      <td>2</td>
      <td>4</td>
      <td>Friendly</td>
      <td>East Hartford</td>
      <td>USA</td>
      <td>False</td>
      <td>...</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>55.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.133333</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>24</th>
      <td>31831</td>
      <td>2010-03-03 00:00:00+00:00</td>
      <td>Scotland</td>
      <td>Czech Republic</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Glasgow</td>
      <td>Scotland</td>
      <td>False</td>
      <td>...</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>55.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.133333</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>25</th>
      <td>31875</td>
      <td>2010-05-22 00:00:00+00:00</td>
      <td>Turkey</td>
      <td>Czech Republic</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Harrison</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>45.0</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>55.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.133333</td>
      <td>85.0</td>
    </tr>
    <tr>
      <th>26</th>
      <td>31913</td>
      <td>2010-05-29 00:00:00+00:00</td>
      <td>USA</td>
      <td>Turkey</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Philadelphia</td>
      <td>USA</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>55.0</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.266667</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>27</th>
      <td>31896</td>
      <td>2010-05-26 00:00:00+00:00</td>
      <td>Northern Ireland</td>
      <td>Turkey</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>New Britain</td>
      <td>USA</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>55.0</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>6.266667</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>28</th>
      <td>32048</td>
      <td>2010-08-10 00:00:00+00:00</td>
      <td>USA</td>
      <td>Brazil</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>East Rutherford</td>
      <td>USA</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.133333</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>29</th>
      <td>31795</td>
      <td>2010-03-02 00:00:00+00:00</td>
      <td>Ireland</td>
      <td>Brazil</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>London</td>
      <td>England</td>
      <td>True</td>
      <td>...</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>35.0</td>
      <td>60.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>5.133333</td>
      <td>89.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1841</th>
      <td>39506</td>
      <td>2018-06-02 00:00:00+00:00</td>
      <td>Austria</td>
      <td>Germany</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Klagenfurt</td>
      <td>Austria</td>
      <td>False</td>
      <td>...</td>
      <td>20.0</td>
      <td>40.0</td>
      <td>26.0</td>
      <td>66.0</td>
      <td>60.0</td>
      <td>60.0</td>
      <td>119.478261</td>
      <td>33.739130</td>
      <td>2.173913</td>
      <td>92.0</td>
    </tr>
    <tr>
      <th>1842</th>
      <td>39508</td>
      <td>2018-06-02 00:00:00+00:00</td>
      <td>Iceland</td>
      <td>Norway</td>
      <td>2</td>
      <td>3</td>
      <td>Friendly</td>
      <td>Reykjavík</td>
      <td>Iceland</td>
      <td>False</td>
      <td>...</td>
      <td>79.0</td>
      <td>55.0</td>
      <td>61.0</td>
      <td>46.0</td>
      <td>49.0</td>
      <td>51.0</td>
      <td>21.869565</td>
      <td>5.539130</td>
      <td>3.608696</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>1843</th>
      <td>39522</td>
      <td>2018-06-03 00:00:00+00:00</td>
      <td>Saudi Arabia</td>
      <td>Peru</td>
      <td>0</td>
      <td>3</td>
      <td>Friendly</td>
      <td>St. Gallen</td>
      <td>Switzerland</td>
      <td>True</td>
      <td>...</td>
      <td>46.0</td>
      <td>80.0</td>
      <td>56.0</td>
      <td>66.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>10.217391</td>
      <td>2.866304</td>
      <td>3.043478</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1844</th>
      <td>39523</td>
      <td>2018-06-03 00:00:00+00:00</td>
      <td>Spain</td>
      <td>Switzerland</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Vila-real</td>
      <td>Spain</td>
      <td>False</td>
      <td>...</td>
      <td>59.0</td>
      <td>55.0</td>
      <td>60.0</td>
      <td>46.0</td>
      <td>59.0</td>
      <td>60.0</td>
      <td>44.826087</td>
      <td>10.347826</td>
      <td>2.217391</td>
      <td>82.0</td>
    </tr>
    <tr>
      <th>1845</th>
      <td>39524</td>
      <td>2018-06-03 00:00:00+00:00</td>
      <td>Croatia</td>
      <td>Brazil</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Liverpool</td>
      <td>England</td>
      <td>True</td>
      <td>...</td>
      <td>39.0</td>
      <td>33.0</td>
      <td>67.0</td>
      <td>76.0</td>
      <td>73.0</td>
      <td>63.0</td>
      <td>123.608696</td>
      <td>32.500000</td>
      <td>1.826087</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1846</th>
      <td>39525</td>
      <td>2018-06-03 00:00:00+00:00</td>
      <td>Costa Rica</td>
      <td>Northern Ireland</td>
      <td>3</td>
      <td>0</td>
      <td>Friendly</td>
      <td>San José</td>
      <td>Costa Rica</td>
      <td>False</td>
      <td>...</td>
      <td>39.0</td>
      <td>35.0</td>
      <td>65.0</td>
      <td>46.0</td>
      <td>39.0</td>
      <td>65.0</td>
      <td>19.739130</td>
      <td>2.051739</td>
      <td>2.739130</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>1847</th>
      <td>39538</td>
      <td>2018-06-04 00:00:00+00:00</td>
      <td>Italy</td>
      <td>Netherlands</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Turin</td>
      <td>Italy</td>
      <td>False</td>
      <td>...</td>
      <td>42.0</td>
      <td>48.0</td>
      <td>63.0</td>
      <td>46.0</td>
      <td>42.0</td>
      <td>63.0</td>
      <td>57.782609</td>
      <td>16.239130</td>
      <td>2.913043</td>
      <td>81.0</td>
    </tr>
    <tr>
      <th>1848</th>
      <td>39539</td>
      <td>2018-06-04 00:00:00+00:00</td>
      <td>Serbia</td>
      <td>Chile</td>
      <td>0</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Graz</td>
      <td>Austria</td>
      <td>True</td>
      <td>...</td>
      <td>35.0</td>
      <td>45.0</td>
      <td>45.0</td>
      <td>68.0</td>
      <td>55.0</td>
      <td>35.0</td>
      <td>48.217391</td>
      <td>9.860870</td>
      <td>3.173913</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>1849</th>
      <td>39543</td>
      <td>2018-06-05 00:00:00+00:00</td>
      <td>Russia</td>
      <td>Turkey</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Moscow</td>
      <td>Russia</td>
      <td>False</td>
      <td>...</td>
      <td>32.0</td>
      <td>62.0</td>
      <td>52.0</td>
      <td>66.0</td>
      <td>62.0</td>
      <td>52.0</td>
      <td>35.913043</td>
      <td>8.665217</td>
      <td>4.173913</td>
      <td>79.0</td>
    </tr>
    <tr>
      <th>1850</th>
      <td>39544</td>
      <td>2018-06-05 00:00:00+00:00</td>
      <td>Romania</td>
      <td>Finland</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Ploiești</td>
      <td>Romania</td>
      <td>False</td>
      <td>...</td>
      <td>52.0</td>
      <td>46.0</td>
      <td>68.0</td>
      <td>25.0</td>
      <td>30.0</td>
      <td>29.0</td>
      <td>7.130435</td>
      <td>2.252826</td>
      <td>3.608696</td>
      <td>83.0</td>
    </tr>
    <tr>
      <th>1851</th>
      <td>39559</td>
      <td>2018-06-06 00:00:00+00:00</td>
      <td>Norway</td>
      <td>Panama</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Oslo</td>
      <td>Norway</td>
      <td>False</td>
      <td>...</td>
      <td>37.0</td>
      <td>31.0</td>
      <td>47.0</td>
      <td>74.0</td>
      <td>71.0</td>
      <td>61.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>3.100000</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>1852</th>
      <td>39560</td>
      <td>2018-06-06 00:00:00+00:00</td>
      <td>Czech Republic</td>
      <td>Nigeria</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Schwechat</td>
      <td>Austria</td>
      <td>True</td>
      <td>...</td>
      <td>79.0</td>
      <td>55.0</td>
      <td>74.0</td>
      <td>58.0</td>
      <td>75.0</td>
      <td>65.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>4.300000</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>1853</th>
      <td>39561</td>
      <td>2018-06-06 00:00:00+00:00</td>
      <td>Belgium</td>
      <td>Egypt</td>
      <td>3</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Brussels</td>
      <td>Belgium</td>
      <td>False</td>
      <td>...</td>
      <td>58.0</td>
      <td>64.0</td>
      <td>31.0</td>
      <td>44.0</td>
      <td>58.0</td>
      <td>31.0</td>
      <td>24.347826</td>
      <td>5.229130</td>
      <td>1.869565</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>1854</th>
      <td>39565</td>
      <td>2018-06-07 00:00:00+00:00</td>
      <td>England</td>
      <td>Costa Rica</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Leeds</td>
      <td>England</td>
      <td>False</td>
      <td>...</td>
      <td>50.0</td>
      <td>76.0</td>
      <td>39.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.200000</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>1855</th>
      <td>39568</td>
      <td>2018-06-07 00:00:00+00:00</td>
      <td>Korea Republic</td>
      <td>Bolivia</td>
      <td>0</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Innsbruck</td>
      <td>Austria</td>
      <td>True</td>
      <td>...</td>
      <td>46.0</td>
      <td>72.0</td>
      <td>70.0</td>
      <td>44.0</td>
      <td>46.0</td>
      <td>70.0</td>
      <td>0.521739</td>
      <td>0.141304</td>
      <td>2.130435</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>1856</th>
      <td>39571</td>
      <td>2018-06-07 00:00:00+00:00</td>
      <td>India</td>
      <td>New Zealand</td>
      <td>1</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Mumbai</td>
      <td>India</td>
      <td>False</td>
      <td>...</td>
      <td>76.0</td>
      <td>40.0</td>
      <td>69.0</td>
      <td>74.0</td>
      <td>80.0</td>
      <td>50.0</td>
      <td>4.739130</td>
      <td>1.339130</td>
      <td>5.086957</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>1857</th>
      <td>39579</td>
      <td>2018-06-08 00:00:00+00:00</td>
      <td>Germany</td>
      <td>Saudi Arabia</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Leverkusen</td>
      <td>Germany</td>
      <td>False</td>
      <td>...</td>
      <td>72.0</td>
      <td>48.0</td>
      <td>73.0</td>
      <td>44.0</td>
      <td>42.0</td>
      <td>63.0</td>
      <td>26.217391</td>
      <td>3.100870</td>
      <td>1.043478</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>1858</th>
      <td>39580</td>
      <td>2018-06-08 00:00:00+00:00</td>
      <td>Croatia</td>
      <td>Senegal</td>
      <td>2</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Osijek</td>
      <td>Croatia</td>
      <td>False</td>
      <td>...</td>
      <td>59.0</td>
      <td>53.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>59.0</td>
      <td>48.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.575000</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>1859</th>
      <td>39602</td>
      <td>2018-06-11 00:00:00+00:00</td>
      <td>Korea Republic</td>
      <td>Senegal</td>
      <td>0</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Grödig</td>
      <td>Austria</td>
      <td>True</td>
      <td>...</td>
      <td>59.0</td>
      <td>53.0</td>
      <td>48.0</td>
      <td>48.0</td>
      <td>59.0</td>
      <td>48.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.575000</td>
      <td>69.0</td>
    </tr>
    <tr>
      <th>1860</th>
      <td>39581</td>
      <td>2018-06-08 00:00:00+00:00</td>
      <td>Switzerland</td>
      <td>Japan</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Lugano</td>
      <td>Switzerland</td>
      <td>False</td>
      <td>...</td>
      <td>61.0</td>
      <td>65.0</td>
      <td>80.0</td>
      <td>66.0</td>
      <td>55.0</td>
      <td>35.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>2.100000</td>
      <td>72.0</td>
    </tr>
    <tr>
      <th>1861</th>
      <td>39583</td>
      <td>2018-06-08 00:00:00+00:00</td>
      <td>Poland</td>
      <td>Chile</td>
      <td>2</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Poznań</td>
      <td>Poland</td>
      <td>False</td>
      <td>...</td>
      <td>35.0</td>
      <td>45.0</td>
      <td>45.0</td>
      <td>68.0</td>
      <td>55.0</td>
      <td>35.0</td>
      <td>48.217391</td>
      <td>9.860870</td>
      <td>3.173913</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>1862</th>
      <td>39585</td>
      <td>2018-06-09 00:00:00+00:00</td>
      <td>Serbia</td>
      <td>Bolivia</td>
      <td>5</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Graz</td>
      <td>Austria</td>
      <td>True</td>
      <td>...</td>
      <td>46.0</td>
      <td>72.0</td>
      <td>70.0</td>
      <td>44.0</td>
      <td>46.0</td>
      <td>70.0</td>
      <td>0.521739</td>
      <td>0.141304</td>
      <td>2.130435</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>1863</th>
      <td>39586</td>
      <td>2018-06-09 00:00:00+00:00</td>
      <td>Denmark</td>
      <td>Mexico</td>
      <td>2</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Brøndby</td>
      <td>Denmark</td>
      <td>False</td>
      <td>...</td>
      <td>56.0</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>68.0</td>
      <td>60.0</td>
      <td>40.0</td>
      <td>30.130435</td>
      <td>8.730435</td>
      <td>1.869565</td>
      <td>77.0</td>
    </tr>
    <tr>
      <th>1864</th>
      <td>39587</td>
      <td>2018-06-09 00:00:00+00:00</td>
      <td>Sweden</td>
      <td>Peru</td>
      <td>0</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Gothenburg</td>
      <td>Sweden</td>
      <td>False</td>
      <td>...</td>
      <td>46.0</td>
      <td>80.0</td>
      <td>56.0</td>
      <td>66.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>10.217391</td>
      <td>2.866304</td>
      <td>3.043478</td>
      <td>74.0</td>
    </tr>
    <tr>
      <th>1865</th>
      <td>39588</td>
      <td>2018-06-09 00:00:00+00:00</td>
      <td>Hungary</td>
      <td>Australia</td>
      <td>1</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Budapest</td>
      <td>Hungary</td>
      <td>False</td>
      <td>...</td>
      <td>36.0</td>
      <td>46.0</td>
      <td>46.0</td>
      <td>58.0</td>
      <td>76.0</td>
      <td>36.0</td>
      <td>18.304348</td>
      <td>3.495652</td>
      <td>2.478261</td>
      <td>78.0</td>
    </tr>
    <tr>
      <th>1866</th>
      <td>39592</td>
      <td>2018-06-09 00:00:00+00:00</td>
      <td>Tunisia</td>
      <td>Spain</td>
      <td>0</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Krasnodar</td>
      <td>Russia</td>
      <td>True</td>
      <td>...</td>
      <td>27.0</td>
      <td>32.0</td>
      <td>20.0</td>
      <td>75.0</td>
      <td>62.0</td>
      <td>52.0</td>
      <td>168.695652</td>
      <td>39.239130</td>
      <td>1.826087</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>1867</th>
      <td>39593</td>
      <td>2018-06-09 00:00:00+00:00</td>
      <td>France</td>
      <td>USA</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Lyon</td>
      <td>France</td>
      <td>False</td>
      <td>...</td>
      <td>70.0</td>
      <td>34.0</td>
      <td>58.0</td>
      <td>48.0</td>
      <td>70.0</td>
      <td>58.0</td>
      <td>19.217391</td>
      <td>5.190217</td>
      <td>4.565217</td>
      <td>73.0</td>
    </tr>
    <tr>
      <th>1868</th>
      <td>39601</td>
      <td>2018-06-10 00:00:00+00:00</td>
      <td>Austria</td>
      <td>Brazil</td>
      <td>0</td>
      <td>3</td>
      <td>Friendly</td>
      <td>Vienna</td>
      <td>Austria</td>
      <td>False</td>
      <td>...</td>
      <td>39.0</td>
      <td>33.0</td>
      <td>67.0</td>
      <td>76.0</td>
      <td>73.0</td>
      <td>63.0</td>
      <td>123.608696</td>
      <td>32.500000</td>
      <td>1.826087</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1869</th>
      <td>39603</td>
      <td>2018-06-11 00:00:00+00:00</td>
      <td>Belgium</td>
      <td>Costa Rica</td>
      <td>4</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Brussels</td>
      <td>Belgium</td>
      <td>False</td>
      <td>...</td>
      <td>50.0</td>
      <td>76.0</td>
      <td>39.0</td>
      <td>43.0</td>
      <td>50.0</td>
      <td>39.0</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.200000</td>
      <td>86.0</td>
    </tr>
    <tr>
      <th>1870</th>
      <td>39604</td>
      <td>2018-06-12 00:00:00+00:00</td>
      <td>Japan</td>
      <td>Paraguay</td>
      <td>4</td>
      <td>2</td>
      <td>Friendly</td>
      <td>Innsbruck</td>
      <td>Austria</td>
      <td>True</td>
      <td>...</td>
      <td>36.0</td>
      <td>62.0</td>
      <td>57.0</td>
      <td>59.0</td>
      <td>54.0</td>
      <td>52.0</td>
      <td>15.173913</td>
      <td>3.614130</td>
      <td>2.173913</td>
      <td>66.0</td>
    </tr>
  </tbody>
</table>
<p>1871 rows × 57 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_ratings2</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[29]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(1871, 57)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># results_ratings2.dtypes</span>

</pre></div>
</div>
</div>
<p>We find that we have 1871 observations that can still be used after
matching team ratings with the results dataframe with an inner merge. We
now clean up the merged dataframe slightly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># drop useless columns</span>
<span class="n">results_ratings3</span> <span class="o">=</span> <span class="n">results_ratings2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="s1">&#39;home_team&#39;</span><span class="p">,</span> <span class="s1">&#39;away_team&#39;</span><span class="p">,</span> <span class="s1">&#39;tournament&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;closest_rating_date&#39;</span><span class="p">,</span> <span class="s1">&#39;closest_ranking_date&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;team_x&#39;</span><span class="p">,</span> <span class="s1">&#39;date_y&#39;</span><span class="p">,</span> <span class="s1">&#39;team_y&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;home_score&#39;</span><span class="p">,</span> <span class="s1">&#39;away_score&#39;</span><span class="p">,</span> <span class="s1">&#39;date_x&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># reorder columns</span>
<span class="n">results_ratings3</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results_ratings3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[31]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>attack_x</th>
      <th>attack_y</th>
      <th>bup_dribbling_x</th>
      <th>bup_dribbling_y</th>
      <th>bup_passing_x</th>
      <th>bup_passing_y</th>
      <th>bup_speed_x</th>
      <th>bup_speed_y</th>
      <th>cc_crossing_x</th>
      <th>cc_crossing_y</th>
      <th>...</th>
      <th>overall_x</th>
      <th>overall_y</th>
      <th>prestige_x</th>
      <th>prestige_y</th>
      <th>start_age_x</th>
      <th>start_age_y</th>
      <th>value_euros_millions_x</th>
      <th>value_euros_millions_y</th>
      <th>wage_euros_thousands_x</th>
      <th>wage_euros_thousands_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>73.0</td>
      <td>67.0</td>
      <td>0.0</td>
      <td>52.0</td>
      <td>45.0</td>
      <td>52.0</td>
      <td>65.0</td>
      <td>50.0</td>
      <td>55.0</td>
      <td>72.0</td>
      <td>...</td>
      <td>77.0</td>
      <td>67.0</td>
      <td>15.0</td>
      <td>1.0</td>
      <td>27.09</td>
      <td>25.18</td>
      <td>0.0</td>
      <td>0.275</td>
      <td>0.0</td>
      <td>0.869565</td>
    </tr>
    <tr>
      <th>1</th>
      <td>73.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>45.0</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>55.0</td>
      <td>70.0</td>
      <td>...</td>
      <td>77.0</td>
      <td>62.0</td>
      <td>15.0</td>
      <td>6.0</td>
      <td>27.09</td>
      <td>29.18</td>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>71.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>...</td>
      <td>75.0</td>
      <td>62.0</td>
      <td>11.0</td>
      <td>6.0</td>
      <td>30.36</td>
      <td>29.18</td>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>83.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>30.0</td>
      <td>70.0</td>
      <td>67.0</td>
      <td>70.0</td>
      <td>60.0</td>
      <td>70.0</td>
      <td>...</td>
      <td>83.0</td>
      <td>62.0</td>
      <td>19.0</td>
      <td>6.0</td>
      <td>28.91</td>
      <td>29.18</td>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>70.0</td>
      <td>60.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>70.0</td>
      <td>65.0</td>
      <td>70.0</td>
      <td>...</td>
      <td>70.0</td>
      <td>62.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>25.64</td>
      <td>29.18</td>
      <td>0.0</td>
      <td>0.000</td>
      <td>0.0</td>
      <td>0.000000</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<p>Our final training data is basically a difference in the various team
ratings. Now let’s clean up the dataframe for our training.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings_base</span> <span class="o">=</span> <span class="n">results_ratings3</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;home_win&#39;</span><span class="p">]]</span>
<span class="n">ratings_base</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_win</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># results_ratings3</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diff_ratings</span> <span class="o">=</span> <span class="n">results_ratings3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;home_win&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#Diff every column with column beforehand.</span>
<span class="n">diff_ratings</span> <span class="o">=</span> <span class="n">diff_ratings</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="n">diff_ratings</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Since we diff every column with column beforehand, we only want every alternate column since those are the true diff</span>
<span class="n">diff_ratings</span> <span class="o">=</span> <span class="n">diff_ratings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="p">,</span> <span class="mi">2</span><span class="p">))]</span>

<span class="c1"># we want our statistics to be from perspective of home team</span>
<span class="n">diff_ratings</span> <span class="o">=</span> <span class="n">diff_ratings</span><span class="o">*-</span><span class="mi">1</span>


<span class="n">diff_ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>attack_y</th>
      <th>bup_dribbling_y</th>
      <th>bup_passing_y</th>
      <th>bup_speed_y</th>
      <th>cc_crossing_y</th>
      <th>cc_passing_y</th>
      <th>cc_shooting_y</th>
      <th>d_aggresion_y</th>
      <th>d_pressure_y</th>
      <th>d_width_y</th>
      <th>defence_y</th>
      <th>full_age_y</th>
      <th>goalkeeeper_overall_y</th>
      <th>growth_y</th>
      <th>midfield_y</th>
      <th>overall_y</th>
      <th>prestige_y</th>
      <th>start_age_y</th>
      <th>value_euros_millions_y</th>
      <th>wage_euros_thousands_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.0</td>
      <td>-52.0</td>
      <td>-7.0</td>
      <td>15.0</td>
      <td>-17.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>18.0</td>
      <td>-4.0</td>
      <td>9.0</td>
      <td>1.46</td>
      <td>13.0</td>
      <td>2.208696</td>
      <td>6.0</td>
      <td>10.0</td>
      <td>14.0</td>
      <td>1.91</td>
      <td>-0.275</td>
      <td>-0.869565</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13.0</td>
      <td>-0.0</td>
      <td>-25.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-10.0</td>
      <td>-5.0</td>
      <td>25.0</td>
      <td>16.0</td>
      <td>0.23</td>
      <td>19.0</td>
      <td>-1.666667</td>
      <td>17.0</td>
      <td>15.0</td>
      <td>9.0</td>
      <td>-2.09</td>
      <td>-0.000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>11.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>15.0</td>
      <td>10.0</td>
      <td>1.53</td>
      <td>19.0</td>
      <td>-1.466667</td>
      <td>14.0</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>1.18</td>
      <td>-0.000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>23.0</td>
      <td>-0.0</td>
      <td>-40.0</td>
      <td>-3.0</td>
      <td>-10.0</td>
      <td>-15.0</td>
      <td>-30.0</td>
      <td>-40.0</td>
      <td>-40.0</td>
      <td>15.0</td>
      <td>22.0</td>
      <td>1.20</td>
      <td>28.0</td>
      <td>-3.433333</td>
      <td>24.0</td>
      <td>21.0</td>
      <td>13.0</td>
      <td>-0.27</td>
      <td>-0.000</td>
      <td>-0.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>15.0</td>
      <td>9.0</td>
      <td>-0.30</td>
      <td>18.0</td>
      <td>0.300000</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>-1.0</td>
      <td>-3.54</td>
      <td>-0.000</td>
      <td>-0.000000</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_diff&#39;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">diff_ratings</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="n">diff_ratings</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>

<span class="c1">#Also want difference in attack of one team and defense of the other</span>
<span class="n">diff_ratings</span><span class="p">[</span><span class="s1">&#39;attack_home_defence_away_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_ratings3</span><span class="p">[</span><span class="s1">&#39;attack_x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_ratings3</span><span class="p">[</span><span class="s1">&#39;defence_y&#39;</span><span class="p">]</span>
<span class="n">diff_ratings</span><span class="p">[</span><span class="s1">&#39;attack_away_defence_home_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_ratings3</span><span class="p">[</span><span class="s1">&#39;attack_y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_ratings3</span><span class="p">[</span><span class="s1">&#39;defence_x&#39;</span><span class="p">]</span>

<span class="c1"># compile datframe</span>
<span class="n">train</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ratings_base</span><span class="p">,</span> <span class="n">diff_ratings</span><span class="p">,</span> <span class="n">results_ratings2</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_win</th>
      <th>attack_diff</th>
      <th>bup_dribbling_diff</th>
      <th>bup_passing_diff</th>
      <th>bup_speed_diff</th>
      <th>cc_crossing_diff</th>
      <th>cc_passing_diff</th>
      <th>cc_shooting_diff</th>
      <th>d_aggresion_diff</th>
      <th>d_pressure_diff</th>
      <th>...</th>
      <th>growth_diff</th>
      <th>midfield_diff</th>
      <th>overall_diff</th>
      <th>prestige_diff</th>
      <th>start_age_diff</th>
      <th>value_euros_millions_diff</th>
      <th>wage_euros_thousands_diff</th>
      <th>attack_home_defence_away_diff</th>
      <th>attack_away_defence_home_diff</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.0</td>
      <td>-52.0</td>
      <td>-7.0</td>
      <td>15.0</td>
      <td>-17.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>18.0</td>
      <td>...</td>
      <td>2.208696</td>
      <td>6.0</td>
      <td>10.0</td>
      <td>14.0</td>
      <td>1.91</td>
      <td>-0.275</td>
      <td>-0.869565</td>
      <td>8.0</td>
      <td>-7.0</td>
      <td>31786</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13.0</td>
      <td>-0.0</td>
      <td>-25.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-10.0</td>
      <td>-5.0</td>
      <td>...</td>
      <td>-1.666667</td>
      <td>17.0</td>
      <td>15.0</td>
      <td>9.0</td>
      <td>-2.09</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>15.0</td>
      <td>-14.0</td>
      <td>31823</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>11.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>...</td>
      <td>-1.466667</td>
      <td>14.0</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>1.18</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>13.0</td>
      <td>-8.0</td>
      <td>31878</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>23.0</td>
      <td>-0.0</td>
      <td>-40.0</td>
      <td>-3.0</td>
      <td>-10.0</td>
      <td>-15.0</td>
      <td>-30.0</td>
      <td>-40.0</td>
      <td>-40.0</td>
      <td>...</td>
      <td>-3.433333</td>
      <td>24.0</td>
      <td>21.0</td>
      <td>13.0</td>
      <td>-0.27</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>25.0</td>
      <td>-20.0</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>...</td>
      <td>0.300000</td>
      <td>10.0</td>
      <td>8.0</td>
      <td>-1.0</td>
      <td>-3.54</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>12.0</td>
      <td>-7.0</td>
      <td>31949</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 24 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df_gdp</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span>
                                <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;idx&#39;</span><span class="p">])</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_win</th>
      <th>attack_diff</th>
      <th>bup_dribbling_diff</th>
      <th>bup_passing_diff</th>
      <th>bup_speed_diff</th>
      <th>cc_crossing_diff</th>
      <th>cc_passing_diff</th>
      <th>cc_shooting_diff</th>
      <th>d_aggresion_diff</th>
      <th>d_pressure_diff</th>
      <th>...</th>
      <th>overall_diff</th>
      <th>prestige_diff</th>
      <th>start_age_diff</th>
      <th>value_euros_millions_diff</th>
      <th>wage_euros_thousands_diff</th>
      <th>attack_home_defence_away_diff</th>
      <th>attack_away_defence_home_diff</th>
      <th>index</th>
      <th>gdp_diff</th>
      <th>idx</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.0</td>
      <td>-52.0</td>
      <td>-7.0</td>
      <td>15.0</td>
      <td>-17.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>18.0</td>
      <td>...</td>
      <td>10.0</td>
      <td>14.0</td>
      <td>1.91</td>
      <td>-0.275</td>
      <td>-0.869565</td>
      <td>8.0</td>
      <td>-7.0</td>
      <td>31786</td>
      <td>0.000000</td>
      <td>31786</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13.0</td>
      <td>-0.0</td>
      <td>-25.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-10.0</td>
      <td>-5.0</td>
      <td>...</td>
      <td>15.0</td>
      <td>9.0</td>
      <td>-2.09</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>15.0</td>
      <td>-14.0</td>
      <td>31823</td>
      <td>0.000000</td>
      <td>31823</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>11.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>...</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>1.18</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>13.0</td>
      <td>-8.0</td>
      <td>31878</td>
      <td>1.295569</td>
      <td>31878</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>23.0</td>
      <td>-0.0</td>
      <td>-40.0</td>
      <td>-3.0</td>
      <td>-10.0</td>
      <td>-15.0</td>
      <td>-30.0</td>
      <td>-40.0</td>
      <td>-40.0</td>
      <td>...</td>
      <td>21.0</td>
      <td>13.0</td>
      <td>-0.27</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>25.0</td>
      <td>-20.0</td>
      <td>32000</td>
      <td>0.000000</td>
      <td>32000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>...</td>
      <td>8.0</td>
      <td>-1.0</td>
      <td>-3.54</td>
      <td>-0.000</td>
      <td>-0.000000</td>
      <td>12.0</td>
      <td>-7.0</td>
      <td>31949</td>
      <td>0.000000</td>
      <td>31949</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># train.dtypes</span>
</pre></div>
</div>
</div>
<p>Now we do the same for rankings.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>index</th>
      <th>date</th>
      <th>home_team</th>
      <th>away_team</th>
      <th>home_score</th>
      <th>away_score</th>
      <th>tournament</th>
      <th>city</th>
      <th>country</th>
      <th>neutral</th>
      <th>home_win</th>
      <th>closest_rating_date</th>
      <th>closest_ranking_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>31700</td>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Iran</td>
      <td>Korea DPR</td>
      <td>1</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Doha</td>
      <td>Qatar</td>
      <td>True</td>
      <td>1</td>
      <td>NaT</td>
      <td>2009-12-16</td>
    </tr>
    <tr>
      <th>1</th>
      <td>31701</td>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Qatar</td>
      <td>Mali</td>
      <td>0</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Doha</td>
      <td>Qatar</td>
      <td>False</td>
      <td>2</td>
      <td>NaT</td>
      <td>2009-12-16</td>
    </tr>
    <tr>
      <th>2</th>
      <td>31702</td>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Syria</td>
      <td>Zimbabwe</td>
      <td>6</td>
      <td>0</td>
      <td>Friendly</td>
      <td>Kuala Lumpur</td>
      <td>Malaysia</td>
      <td>True</td>
      <td>1</td>
      <td>NaT</td>
      <td>2009-12-16</td>
    </tr>
    <tr>
      <th>3</th>
      <td>31703</td>
      <td>2010-01-02 00:00:00+00:00</td>
      <td>Yemen</td>
      <td>Tajikistan</td>
      <td>0</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Sana'a</td>
      <td>Yemen</td>
      <td>False</td>
      <td>0</td>
      <td>NaT</td>
      <td>2009-12-16</td>
    </tr>
    <tr>
      <th>4</th>
      <td>31704</td>
      <td>2010-01-03 00:00:00+00:00</td>
      <td>Angola</td>
      <td>Gambia</td>
      <td>1</td>
      <td>1</td>
      <td>Friendly</td>
      <td>Vila Real de Santo António</td>
      <td>Portugal</td>
      <td>True</td>
      <td>2</td>
      <td>NaT</td>
      <td>2009-12-16</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Now merge rankings</span>
<span class="n">results_rankings1</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">fifa_rankings</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;closest_ranking_date&#39;</span><span class="p">,</span> <span class="s1">&#39;home_team&#39;</span><span class="p">],</span>
                                <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rank_date&#39;</span><span class="p">,</span> <span class="s1">&#39;country_full&#39;</span><span class="p">])</span>

<span class="n">results_rankings2</span> <span class="o">=</span> <span class="n">results_rankings1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">fifa_rankings</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span>
                                <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;closest_ranking_date&#39;</span><span class="p">,</span> <span class="s1">&#39;away_team&#39;</span><span class="p">],</span>
                                <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;rank_date&#39;</span><span class="p">,</span> <span class="s1">&#39;country_full&#39;</span><span class="p">])</span>

</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># drop useless columns</span>
<span class="n">results_rankings3</span> <span class="o">=</span> <span class="n">results_rankings2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;home_team&#39;</span><span class="p">,</span> <span class="s1">&#39;away_team&#39;</span><span class="p">,</span> <span class="s1">&#39;tournament&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="s1">&#39;country&#39;</span><span class="p">,</span> <span class="s1">&#39;neutral&#39;</span><span class="p">,</span> <span class="s1">&#39;closest_rating_date&#39;</span><span class="p">,</span> <span class="s1">&#39;closest_ranking_date&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;country_full_x&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_date_y&#39;</span><span class="p">,</span> <span class="s1">&#39;country_full_y&#39;</span><span class="p">,</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;home_score&#39;</span><span class="p">,</span> <span class="s1">&#39;away_score&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_date_x&#39;</span><span class="p">,</span> <span class="s1">&#39;confederation_x&#39;</span><span class="p">,</span>
                       <span class="s1">&#39;confederation_y&#39;</span><span class="p">,</span> <span class="s1">&#39;country_abrv_x&#39;</span><span class="p">,</span> <span class="s1">&#39;country_abrv_y&#39;</span><span class="p">,</span> <span class="s1">&#39;home_win&#39;</span><span class="p">,</span> <span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># reorder columns</span>
<span class="n">results_rankings3</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results_rankings3</span><span class="p">[[</span><span class="s1">&#39;rank_x&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_y&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>rank_x</th>
      <th>rank_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>64</td>
      <td>86</td>
    </tr>
    <tr>
      <th>1</th>
      <td>86</td>
      <td>47</td>
    </tr>
    <tr>
      <th>2</th>
      <td>95</td>
      <td>47</td>
    </tr>
    <tr>
      <th>3</th>
      <td>24</td>
      <td>47</td>
    </tr>
    <tr>
      <th>4</th>
      <td>91</td>
      <td>109</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Diff every column with column beforehand.</span>
<span class="n">diff_rankings</span> <span class="o">=</span> <span class="n">results_rankings3</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ncol</span> <span class="o">=</span> <span class="n">diff_rankings</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># Since we diff every column with column beforehand, we only want every alternate column since those are the true diff</span>
<span class="n">diff_rankings</span> <span class="o">=</span> <span class="n">diff_rankings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="p">,</span> <span class="mi">2</span><span class="p">))]</span>

<span class="c1"># we want our statistics to be from perspective of home team</span>
<span class="n">diff_rankings</span> <span class="o">=</span> <span class="n">diff_rankings</span><span class="o">*-</span><span class="mi">1</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_diff&quot;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">diff_rankings</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="n">diff_rankings</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
<span class="n">diff_rankings</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_rankings2</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">]</span>

<span class="n">diff_rankings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cur_year_avg_weighted_diff</th>
      <th>cur_year_avg_diff</th>
      <th>last_year_avg_weighted_diff</th>
      <th>last_year_avg_diff</th>
      <th>previous_points_diff</th>
      <th>rank_change_diff</th>
      <th>rank_diff</th>
      <th>three_year_ago_avg_diff</th>
      <th>three_year_ago_weighted_diff</th>
      <th>total_points_diff</th>
      <th>two_year_ago_avg_diff</th>
      <th>two_year_ago_weighted_diff</th>
      <th>index</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>119.0</td>
      <td>1.0</td>
      <td>-22.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>31700</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-288.0</td>
      <td>1.0</td>
      <td>39.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>31701</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-325.0</td>
      <td>-1.0</td>
      <td>48.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>31723</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>158.0</td>
      <td>5.0</td>
      <td>-23.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>31705</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>83.0</td>
      <td>1.0</td>
      <td>-18.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>31702</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">diff_rankings</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">right_on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;inner&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;index&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span> <span class="o">=</span> <span class="n">train</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;idx&#39;</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_win</th>
      <th>attack_diff</th>
      <th>bup_dribbling_diff</th>
      <th>bup_passing_diff</th>
      <th>bup_speed_diff</th>
      <th>cc_crossing_diff</th>
      <th>cc_passing_diff</th>
      <th>cc_shooting_diff</th>
      <th>d_aggresion_diff</th>
      <th>d_pressure_diff</th>
      <th>...</th>
      <th>last_year_avg_weighted_diff</th>
      <th>last_year_avg_diff</th>
      <th>previous_points_diff</th>
      <th>rank_change_diff</th>
      <th>rank_diff</th>
      <th>three_year_ago_avg_diff</th>
      <th>three_year_ago_weighted_diff</th>
      <th>total_points_diff</th>
      <th>two_year_ago_avg_diff</th>
      <th>two_year_ago_weighted_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>6.0</td>
      <td>-52.0</td>
      <td>-7.0</td>
      <td>15.0</td>
      <td>-17.0</td>
      <td>12.0</td>
      <td>1.0</td>
      <td>27.0</td>
      <td>18.0</td>
      <td>...</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>358.0</td>
      <td>-1.0</td>
      <td>-38.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>13.0</td>
      <td>-0.0</td>
      <td>-25.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-5.0</td>
      <td>-5.0</td>
      <td>-10.0</td>
      <td>-5.0</td>
      <td>...</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>531.0</td>
      <td>-3.0</td>
      <td>-62.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>11.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>...</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>489.0</td>
      <td>-2.0</td>
      <td>-58.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>23.0</td>
      <td>-0.0</td>
      <td>-40.0</td>
      <td>-3.0</td>
      <td>-10.0</td>
      <td>-15.0</td>
      <td>-30.0</td>
      <td>-40.0</td>
      <td>-40.0</td>
      <td>...</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>771.0</td>
      <td>-0.0</td>
      <td>-73.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>10.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-5.0</td>
      <td>-15.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-20.0</td>
      <td>...</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>447.0</td>
      <td>-2.0</td>
      <td>-53.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 36 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># train[&#39;gdp_diff&#39;]</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[46]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>home_win                           int64
attack_diff                      float64
bup_dribbling_diff               float64
bup_passing_diff                 float64
bup_speed_diff                   float64
cc_crossing_diff                 float64
cc_passing_diff                  float64
cc_shooting_diff                 float64
d_aggresion_diff                 float64
d_pressure_diff                  float64
d_width_diff                     float64
defence_diff                     float64
full_age_diff                    float64
goalkeeeper_overall_diff         float64
growth_diff                      float64
midfield_diff                    float64
overall_diff                     float64
prestige_diff                    float64
start_age_diff                   float64
value_euros_millions_diff        float64
wage_euros_thousands_diff        float64
attack_home_defence_away_diff    float64
attack_away_defence_home_diff    float64
gdp_diff                         float64
cur_year_avg_weighted_diff       float64
cur_year_avg_diff                float64
last_year_avg_weighted_diff      float64
last_year_avg_diff               float64
previous_points_diff             float64
rank_change_diff                 float64
rank_diff                        float64
three_year_ago_avg_diff          float64
three_year_ago_weighted_diff     float64
total_points_diff                float64
two_year_ago_avg_diff            float64
two_year_ago_weighted_diff       float64
dtype: object
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># save to csv</span>
<span class="n">train</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;data/train_team.csv&#39;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>We now create our test set with actual world cup data.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings_wc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/team_stats_final.csv&#39;</span><span class="p">)</span>
<span class="n">ratings_wc</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">ratings_wc</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">utc</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># restrict dates</span>
<span class="n">latest_date</span> <span class="o">=</span> <span class="s1">&#39;2018-06-14&#39;</span>
<span class="n">wc_start</span> <span class="o">=</span> <span class="s1">&#39;2018-06-16&#39;</span> <span class="c1"># first WC rating</span>
<span class="n">wc_end</span> <span class="o">=</span> <span class="s1">&#39;2018-07-15&#39;</span>
<span class="c1"># restrict dates</span>
<span class="n">ratings_wc</span> <span class="o">=</span> <span class="n">ratings_wc</span><span class="p">[(</span><span class="n">ratings_wc</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">wc_start</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">ratings_wc</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">wc_end</span><span class="p">)]</span>

<span class="n">ratings_wc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[48]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>team</th>
      <th>date</th>
      <th>attack</th>
      <th>defence</th>
      <th>full_age</th>
      <th>midfield</th>
      <th>overall</th>
      <th>prestige</th>
      <th>start_age</th>
      <th>bup_speed</th>
      <th>...</th>
      <th>cc_passing</th>
      <th>cc_crossing</th>
      <th>cc_shooting</th>
      <th>d_pressure</th>
      <th>d_aggresion</th>
      <th>d_width</th>
      <th>wage_euros_thousands</th>
      <th>value_euros_millions</th>
      <th>growth</th>
      <th>goalkeeeper_overall</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Brazil</td>
      <td>2018-07-15 00:00:00+00:00</td>
      <td>87.0</td>
      <td>84.0</td>
      <td>27.43</td>
      <td>86.0</td>
      <td>86.0</td>
      <td>10.0</td>
      <td>27.55</td>
      <td>51.0</td>
      <td>...</td>
      <td>39.0</td>
      <td>33.0</td>
      <td>67.0</td>
      <td>76.0</td>
      <td>73.0</td>
      <td>63.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.62500</td>
      <td>84.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>England</td>
      <td>2018-07-15 00:00:00+00:00</td>
      <td>83.0</td>
      <td>80.0</td>
      <td>25.88</td>
      <td>81.0</td>
      <td>81.0</td>
      <td>8.0</td>
      <td>24.64</td>
      <td>36.0</td>
      <td>...</td>
      <td>31.0</td>
      <td>41.0</td>
      <td>41.0</td>
      <td>43.0</td>
      <td>55.0</td>
      <td>49.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>2.57500</td>
      <td>80.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Italy</td>
      <td>2018-07-15 00:00:00+00:00</td>
      <td>81.0</td>
      <td>82.0</td>
      <td>25.96</td>
      <td>81.0</td>
      <td>82.0</td>
      <td>9.0</td>
      <td>27.36</td>
      <td>73.0</td>
      <td>...</td>
      <td>64.0</td>
      <td>80.0</td>
      <td>78.0</td>
      <td>29.0</td>
      <td>26.0</td>
      <td>32.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.26087</td>
      <td>88.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Spain</td>
      <td>2018-07-15 00:00:00+00:00</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>27.18</td>
      <td>86.0</td>
      <td>85.0</td>
      <td>9.0</td>
      <td>27.27</td>
      <td>32.0</td>
      <td>...</td>
      <td>27.0</td>
      <td>32.0</td>
      <td>20.0</td>
      <td>75.0</td>
      <td>62.0</td>
      <td>52.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.77500</td>
      <td>91.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>France</td>
      <td>2018-07-15 00:00:00+00:00</td>
      <td>86.0</td>
      <td>81.0</td>
      <td>25.05</td>
      <td>84.0</td>
      <td>85.0</td>
      <td>9.0</td>
      <td>24.82</td>
      <td>35.0</td>
      <td>...</td>
      <td>24.0</td>
      <td>53.0</td>
      <td>35.0</td>
      <td>47.0</td>
      <td>47.0</td>
      <td>67.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>3.45000</td>
      <td>87.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings_teams_wc</span> <span class="o">=</span> <span class="n">ratings_wc</span><span class="o">.</span><span class="n">team</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#https://gitlab.com/djh_or/2018-world-cup-stats/blob/master/world_cup_2018_stats.csv</span>
<span class="n">results_wc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/world_cup_2018_stats.csv&quot;</span><span class="p">)</span>
<span class="n">results_wc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Game</th>
      <th>Group</th>
      <th>Team</th>
      <th>Opponent</th>
      <th>Home/Away</th>
      <th>Score</th>
      <th>WDL</th>
      <th>Pens?</th>
      <th>Goals For</th>
      <th>Goals Against</th>
      <th>...</th>
      <th>Passes Completed</th>
      <th>Distance Covered km</th>
      <th>Balls recovered</th>
      <th>Tackles</th>
      <th>Blocks</th>
      <th>Clearances</th>
      <th>Yellow cards</th>
      <th>Red Cards</th>
      <th>Second Yellow Card leading to Red Card</th>
      <th>Fouls Committed</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>A</td>
      <td>Russia</td>
      <td>Saudi Arabia</td>
      <td>home</td>
      <td>5-0</td>
      <td>W</td>
      <td>NaN</td>
      <td>5</td>
      <td>0</td>
      <td>...</td>
      <td>240</td>
      <td>118</td>
      <td>53</td>
      <td>9</td>
      <td>3</td>
      <td>19</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>22</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>A</td>
      <td>Saudi Arabia</td>
      <td>Russia</td>
      <td>away</td>
      <td>5-0</td>
      <td>L</td>
      <td>NaN</td>
      <td>0</td>
      <td>5</td>
      <td>...</td>
      <td>442</td>
      <td>105</td>
      <td>48</td>
      <td>16</td>
      <td>3</td>
      <td>31</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>A</td>
      <td>Egypt</td>
      <td>Uruguay</td>
      <td>home</td>
      <td>0-1</td>
      <td>L</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>308</td>
      <td>112</td>
      <td>57</td>
      <td>12</td>
      <td>4</td>
      <td>32</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>A</td>
      <td>Uruguay</td>
      <td>Egypt</td>
      <td>away</td>
      <td>0-1</td>
      <td>W</td>
      <td>NaN</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>508</td>
      <td>111</td>
      <td>54</td>
      <td>8</td>
      <td>2</td>
      <td>22</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3</td>
      <td>B</td>
      <td>Morocco</td>
      <td>IR Iran</td>
      <td>home</td>
      <td>0-1</td>
      <td>L</td>
      <td>NaN</td>
      <td>0</td>
      <td>1</td>
      <td>...</td>
      <td>371</td>
      <td>101</td>
      <td>38</td>
      <td>9</td>
      <td>1</td>
      <td>16</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>22</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 32 columns</p>
</div></div>
</div>
<p>Before we proceed, let’s ensure that our country names match up
similarly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># check that we found the corresponding team from team ratings in results</span>
<span class="c1"># but now we reverse it such that we try to find a rating and ranking for each wc team</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">Team</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ratings_teams_wc</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot Find in Ratings </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">Team</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fifa_rankings</span><span class="o">.</span><span class="n">country_full</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span> <span class="o">==</span> <span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Cannot Find in Rankings </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">t</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cannot Find in Ratings IR Iran
Cannot Find in Rankings IR Iran
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">results_wc</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;IR Iran&#39;</span><span class="p">,</span> <span class="s1">&#39;Iran&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># # Repeat the same GDP calculation for Test set</span>

<span class="c1"># gdp_col_test = []</span>
<span class="c1"># for col1,col2 in zip(results_wc[&#39;Team&#39;].items(),results_wc[&#39;Opponent&#39;].items()):</span>
<span class="c1">#     team1 = col1[1]</span>
<span class="c1">#     team2 = col2[1]</span>
<span class="c1">#     if country_to_continent[team1] != country_to_continent[team2]:</span>
<span class="c1">#         gdp_col_test.append(0)</span>
<span class="c1">#     elif gdp_countries[team1] &gt; gdp_countries[team2]:</span>
<span class="c1">#         gdp_col_test.append(1)</span>
<span class="c1">#     else:</span>
<span class="c1">#         gdp_col_test.append(-1)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># Repeat the same GDP calculation for Test set</span>

<span class="n">gdp_col_test</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">col1</span><span class="p">,</span><span class="n">col2</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">results_wc</span><span class="p">[</span><span class="s1">&#39;Team&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span><span class="n">results_wc</span><span class="p">[</span><span class="s1">&#39;Opponent&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
    <span class="n">team1</span> <span class="o">=</span> <span class="n">col1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">team2</span> <span class="o">=</span> <span class="n">col2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="n">team1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">country_to_continent</span><span class="p">[</span><span class="n">team2</span><span class="p">]:</span>
        <span class="n">gdp_col_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">gdp_col_test</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">gdp_countries</span><span class="p">[</span><span class="n">team1</span><span class="p">])</span><span class="o">/</span><span class="n">gdp_countries</span><span class="p">[</span><span class="n">team2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">gdp_col_test</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[55]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>128
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">tournament_round</span> <span class="o">=</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">Group</span>
<span class="n">results_wc</span> <span class="o">=</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="s1">&#39;Opponent&#39;</span><span class="p">,</span> <span class="s1">&#39;WDL&#39;</span><span class="p">]]</span>
<span class="n">results_wc</span><span class="p">[</span><span class="s1">&#39;home_win&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="s1">&#39;L&#39;</span> <span class="k">else</span> <span class="mi">1</span> <span class="k">if</span> <span class="n">score</span> <span class="o">==</span> <span class="s1">&#39;W&#39;</span> <span class="k">else</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">WDL</span><span class="p">]</span>
<span class="n">results_wc</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;WDL&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results_wc</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>


</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[56]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Team</th>
      <th>Opponent</th>
      <th>home_win</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>123</th>
      <td>England</td>
      <td>Croatia</td>
      <td>0</td>
    </tr>
    <tr>
      <th>124</th>
      <td>Belgium</td>
      <td>England</td>
      <td>1</td>
    </tr>
    <tr>
      <th>125</th>
      <td>England</td>
      <td>Belgium</td>
      <td>0</td>
    </tr>
    <tr>
      <th>126</th>
      <td>France</td>
      <td>Croatia</td>
      <td>1</td>
    </tr>
    <tr>
      <th>127</th>
      <td>Croatia</td>
      <td>France</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>Now we can match the ratings and rankings data to our test dataset as
well. We note that there might be some value in using the updated FIFA
ratings and rankings at each time of the match. However, for simplicity,
let’s just assume that teams have the same rating and rankings
throughout the tournament. We will take the rating and rankings at the
start of the tournament.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">rankings_wc</span> <span class="o">=</span> <span class="n">fifa_rankings</span><span class="p">[</span><span class="n">fifa_rankings</span><span class="o">.</span><span class="n">rank_date</span> <span class="o">==</span> \
                            <span class="n">get_latest_date</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">wc_start</span><span class="p">),</span> <span class="n">fifa_rankings</span><span class="o">.</span><span class="n">rank_date</span><span class="p">)]</span>
<span class="n">results_rankings_wc1</span> <span class="o">=</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rankings_wc</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="n">right_on</span> <span class="o">=</span> <span class="s1">&#39;country_full&#39;</span><span class="p">)</span>
<span class="n">results_rankings_wc2</span> <span class="o">=</span> <span class="n">results_rankings_wc1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">rankings_wc</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="s1">&#39;Opponent&#39;</span><span class="p">,</span>
                                                  <span class="n">right_on</span> <span class="o">=</span> <span class="s1">&#39;country_full&#39;</span><span class="p">)</span>
<span class="n">results_rankings_wc2</span><span class="o">.</span><span class="n">columns</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[57]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;Team&#39;, &#39;Opponent&#39;, &#39;home_win&#39;, &#39;rank_x&#39;, &#39;country_full_x&#39;,
       &#39;country_abrv_x&#39;, &#39;total_points_x&#39;, &#39;previous_points_x&#39;,
       &#39;rank_change_x&#39;, &#39;cur_year_avg_x&#39;, &#39;cur_year_avg_weighted_x&#39;,
       &#39;last_year_avg_x&#39;, &#39;last_year_avg_weighted_x&#39;, &#39;two_year_ago_avg_x&#39;,
       &#39;two_year_ago_weighted_x&#39;, &#39;three_year_ago_avg_x&#39;,
       &#39;three_year_ago_weighted_x&#39;, &#39;confederation_x&#39;, &#39;rank_date_x&#39;, &#39;rank_y&#39;,
       &#39;country_full_y&#39;, &#39;country_abrv_y&#39;, &#39;total_points_y&#39;,
       &#39;previous_points_y&#39;, &#39;rank_change_y&#39;, &#39;cur_year_avg_y&#39;,
       &#39;cur_year_avg_weighted_y&#39;, &#39;last_year_avg_y&#39;,
       &#39;last_year_avg_weighted_y&#39;, &#39;two_year_ago_avg_y&#39;,
       &#39;two_year_ago_weighted_y&#39;, &#39;three_year_ago_avg_y&#39;,
       &#39;three_year_ago_weighted_y&#39;, &#39;confederation_y&#39;, &#39;rank_date_y&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># drop useless columns</span>
<span class="n">results_rankings_wc3</span> <span class="o">=</span> <span class="n">results_rankings_wc2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="s1">&#39;Opponent&#39;</span><span class="p">,</span><span class="s1">&#39;country_full_x&#39;</span><span class="p">,</span> <span class="s1">&#39;rank_date_y&#39;</span><span class="p">,</span> <span class="s1">&#39;country_full_y&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;rank_date_x&#39;</span><span class="p">,</span> <span class="s1">&#39;confederation_x&#39;</span><span class="p">,</span> <span class="s1">&#39;confederation_y&#39;</span><span class="p">,</span> <span class="s1">&#39;country_abrv_x&#39;</span><span class="p">,</span> <span class="s1">&#39;country_abrv_y&#39;</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># reorder columns</span>
<span class="n">results_rankings_wc3</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results_rankings_wc3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cur_year_avg_weighted_x</th>
      <th>cur_year_avg_weighted_y</th>
      <th>cur_year_avg_x</th>
      <th>cur_year_avg_y</th>
      <th>home_win</th>
      <th>last_year_avg_weighted_x</th>
      <th>last_year_avg_weighted_y</th>
      <th>last_year_avg_x</th>
      <th>last_year_avg_y</th>
      <th>previous_points_x</th>
      <th>...</th>
      <th>three_year_ago_avg_x</th>
      <th>three_year_ago_avg_y</th>
      <th>three_year_ago_weighted_x</th>
      <th>three_year_ago_weighted_y</th>
      <th>total_points_x</th>
      <th>total_points_y</th>
      <th>two_year_ago_avg_x</th>
      <th>two_year_ago_avg_y</th>
      <th>two_year_ago_weighted_x</th>
      <th>two_year_ago_weighted_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>166.07</td>
      <td>143.89</td>
      <td>166.07</td>
      <td>143.89</td>
      <td>1</td>
      <td>108.09</td>
      <td>180.10</td>
      <td>216.18</td>
      <td>360.20</td>
      <td>493</td>
      <td>...</td>
      <td>368.50</td>
      <td>135.09</td>
      <td>73.70</td>
      <td>27.02</td>
      <td>456.53</td>
      <td>465.28</td>
      <td>362.25</td>
      <td>380.91</td>
      <td>108.68</td>
      <td>114.27</td>
    </tr>
    <tr>
      <th>1</th>
      <td>143.89</td>
      <td>166.07</td>
      <td>143.89</td>
      <td>166.07</td>
      <td>0</td>
      <td>180.10</td>
      <td>108.09</td>
      <td>360.20</td>
      <td>216.18</td>
      <td>462</td>
      <td>...</td>
      <td>135.09</td>
      <td>368.50</td>
      <td>27.02</td>
      <td>73.70</td>
      <td>465.28</td>
      <td>456.53</td>
      <td>380.91</td>
      <td>362.25</td>
      <td>114.27</td>
      <td>108.68</td>
    </tr>
    <tr>
      <th>2</th>
      <td>208.27</td>
      <td>486.28</td>
      <td>208.27</td>
      <td>486.28</td>
      <td>0</td>
      <td>291.04</td>
      <td>243.84</td>
      <td>582.07</td>
      <td>487.69</td>
      <td>636</td>
      <td>...</td>
      <td>253.18</td>
      <td>599.26</td>
      <td>50.64</td>
      <td>119.85</td>
      <td>649.43</td>
      <td>1018.41</td>
      <td>331.62</td>
      <td>561.47</td>
      <td>99.48</td>
      <td>168.44</td>
    </tr>
    <tr>
      <th>3</th>
      <td>486.28</td>
      <td>208.27</td>
      <td>486.28</td>
      <td>208.27</td>
      <td>1</td>
      <td>243.84</td>
      <td>291.04</td>
      <td>487.69</td>
      <td>582.07</td>
      <td>976</td>
      <td>...</td>
      <td>599.26</td>
      <td>253.18</td>
      <td>119.85</td>
      <td>50.64</td>
      <td>1018.41</td>
      <td>649.43</td>
      <td>561.47</td>
      <td>331.62</td>
      <td>168.44</td>
      <td>99.48</td>
    </tr>
    <tr>
      <th>4</th>
      <td>369.10</td>
      <td>290.29</td>
      <td>369.10</td>
      <td>290.29</td>
      <td>0</td>
      <td>172.65</td>
      <td>246.02</td>
      <td>345.29</td>
      <td>492.04</td>
      <td>681</td>
      <td>...</td>
      <td>170.43</td>
      <td>398.22</td>
      <td>34.09</td>
      <td>79.64</td>
      <td>685.86</td>
      <td>708.35</td>
      <td>366.78</td>
      <td>308.01</td>
      <td>110.03</td>
      <td>92.40</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diff_rankings_wc</span> <span class="o">=</span> <span class="n">results_rankings_wc3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;home_win&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">diff_rankings_wc</span> <span class="o">=</span> <span class="n">diff_rankings_wc</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ncol_wc</span> <span class="o">=</span> <span class="n">diff_rankings_wc</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># we only want every alternate column</span>
<span class="n">diff_rankings_wc</span> <span class="o">=</span> <span class="n">diff_rankings_wc</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol_wc</span><span class="p">,</span> <span class="mi">2</span><span class="p">))]</span>

<span class="c1"># we want our statistics to be from perspective of home teams</span>
<span class="n">diff_rankings_wc</span> <span class="o">=</span> <span class="n">diff_rankings_wc</span><span class="o">*-</span><span class="mi">1</span>

<span class="n">diff_rankings_wc</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_diff&#39;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">diff_rankings_wc</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
<span class="n">diff_rankings_wc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[59]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cur_year_avg_weighted_diff</th>
      <th>cur_year_avg_diff</th>
      <th>last_year_avg_weighted_diff</th>
      <th>last_year_avg_diff</th>
      <th>previous_points_diff</th>
      <th>rank_change_diff</th>
      <th>rank_diff</th>
      <th>three_year_ago_avg_diff</th>
      <th>three_year_ago_weighted_diff</th>
      <th>total_points_diff</th>
      <th>two_year_ago_avg_diff</th>
      <th>two_year_ago_weighted_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>22.18</td>
      <td>22.18</td>
      <td>-72.01</td>
      <td>-144.02</td>
      <td>31.0</td>
      <td>-4.0</td>
      <td>3.0</td>
      <td>233.41</td>
      <td>46.68</td>
      <td>-8.75</td>
      <td>-18.66</td>
      <td>-5.59</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-22.18</td>
      <td>-22.18</td>
      <td>72.01</td>
      <td>144.02</td>
      <td>-31.0</td>
      <td>4.0</td>
      <td>-3.0</td>
      <td>-233.41</td>
      <td>-46.68</td>
      <td>8.75</td>
      <td>18.66</td>
      <td>5.59</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-278.01</td>
      <td>-278.01</td>
      <td>47.20</td>
      <td>94.38</td>
      <td>-340.0</td>
      <td>-2.0</td>
      <td>31.0</td>
      <td>-346.08</td>
      <td>-69.21</td>
      <td>-368.98</td>
      <td>-229.85</td>
      <td>-68.96</td>
    </tr>
    <tr>
      <th>3</th>
      <td>278.01</td>
      <td>278.01</td>
      <td>-47.20</td>
      <td>-94.38</td>
      <td>340.0</td>
      <td>2.0</td>
      <td>-31.0</td>
      <td>346.08</td>
      <td>69.21</td>
      <td>368.98</td>
      <td>229.85</td>
      <td>68.96</td>
    </tr>
    <tr>
      <th>4</th>
      <td>78.81</td>
      <td>78.81</td>
      <td>-73.37</td>
      <td>-146.75</td>
      <td>-46.0</td>
      <td>2.0</td>
      <td>4.0</td>
      <td>-227.79</td>
      <td>-45.55</td>
      <td>-22.49</td>
      <td>58.77</td>
      <td>17.63</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings_wc_start</span> <span class="o">=</span> <span class="n">ratings_wc</span><span class="p">[</span><span class="n">ratings_wc</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">wc_start</span><span class="p">]</span>

<span class="c1"># merge ratings with results table</span>
<span class="n">results_ratings_wc1</span> <span class="o">=</span> <span class="n">results_wc</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ratings_wc_start</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                     <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">)</span>
<span class="n">results_ratings_wc2</span> <span class="o">=</span> <span class="n">results_ratings_wc1</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">ratings_wc_start</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span>
                                             <span class="n">left_on</span><span class="o">=</span><span class="s1">&#39;Opponent&#39;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># drop useless columns</span>
<span class="n">results_ratings_wc3</span> <span class="o">=</span> <span class="n">results_ratings_wc2</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Team&#39;</span><span class="p">,</span> <span class="s1">&#39;Opponent&#39;</span><span class="p">,</span> <span class="s1">&#39;team_x&#39;</span><span class="p">,</span> <span class="s1">&#39;team_y&#39;</span><span class="p">,</span> <span class="s1">&#39;date_y&#39;</span><span class="p">,</span> <span class="s1">&#39;date_x&#39;</span><span class="p">],</span>
                         <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># reorder columns</span>
<span class="n">results_ratings_wc3</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">results_ratings_wc3</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[61]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>attack_x</th>
      <th>attack_y</th>
      <th>bup_dribbling_x</th>
      <th>bup_dribbling_y</th>
      <th>bup_passing_x</th>
      <th>bup_passing_y</th>
      <th>bup_speed_x</th>
      <th>bup_speed_y</th>
      <th>cc_crossing_x</th>
      <th>cc_crossing_y</th>
      <th>...</th>
      <th>overall_x</th>
      <th>overall_y</th>
      <th>prestige_x</th>
      <th>prestige_y</th>
      <th>start_age_x</th>
      <th>start_age_y</th>
      <th>value_euros_millions_x</th>
      <th>value_euros_millions_y</th>
      <th>wage_euros_thousands_x</th>
      <th>wage_euros_thousands_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>80.0</td>
      <td>71.0</td>
      <td>77.0</td>
      <td>68.0</td>
      <td>49.0</td>
      <td>66.0</td>
      <td>50.0</td>
      <td>69.0</td>
      <td>37.0</td>
      <td>48.0</td>
      <td>...</td>
      <td>79.0</td>
      <td>72.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>27.82</td>
      <td>28.00</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>71.0</td>
      <td>80.0</td>
      <td>68.0</td>
      <td>77.0</td>
      <td>66.0</td>
      <td>49.0</td>
      <td>69.0</td>
      <td>50.0</td>
      <td>48.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>72.0</td>
      <td>79.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>28.00</td>
      <td>27.82</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>72.0</td>
      <td>86.0</td>
      <td>34.0</td>
      <td>42.0</td>
      <td>49.0</td>
      <td>36.0</td>
      <td>52.0</td>
      <td>38.0</td>
      <td>64.0</td>
      <td>43.0</td>
      <td>...</td>
      <td>76.0</td>
      <td>80.0</td>
      <td>5.0</td>
      <td>7.0</td>
      <td>27.64</td>
      <td>26.09</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>86.0</td>
      <td>72.0</td>
      <td>42.0</td>
      <td>34.0</td>
      <td>36.0</td>
      <td>49.0</td>
      <td>38.0</td>
      <td>52.0</td>
      <td>43.0</td>
      <td>64.0</td>
      <td>...</td>
      <td>80.0</td>
      <td>76.0</td>
      <td>7.0</td>
      <td>5.0</td>
      <td>26.09</td>
      <td>27.64</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>72.0</td>
      <td>79.0</td>
      <td>52.0</td>
      <td>67.0</td>
      <td>38.0</td>
      <td>69.0</td>
      <td>38.0</td>
      <td>69.0</td>
      <td>58.0</td>
      <td>37.0</td>
      <td>...</td>
      <td>76.0</td>
      <td>74.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>26.55</td>
      <td>26.27</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 41 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ratings_base_wc</span> <span class="o">=</span> <span class="n">results_ratings_wc3</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;home_win&#39;</span><span class="p">]]</span>
<span class="n">ratings_base_wc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>home_win</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">diff_ratings_wc</span> <span class="o">=</span> <span class="n">results_ratings_wc3</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;home_win&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">diff_ratings_wc</span> <span class="o">=</span> <span class="n">diff_ratings_wc</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ncol_wc</span> <span class="o">=</span> <span class="n">diff_ratings_wc</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># we only want every alternate column</span>
<span class="n">diff_ratings_wc</span> <span class="o">=</span> <span class="n">diff_ratings_wc</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="nb">list</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol_wc</span><span class="p">,</span> <span class="mi">2</span><span class="p">))]</span>

<span class="c1"># we want our statistics to be from perspective of home teams</span>
<span class="n">diff_ratings_wc</span> <span class="o">=</span> <span class="n">diff_ratings_wc</span><span class="o">*-</span><span class="mi">1</span>
<span class="n">diff_ratings_wc</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">column</span><span class="p">[:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;_diff&#39;</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">diff_ratings_wc</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>

<span class="c1">#Also want difference in attack of one team and defense of the other</span>
<span class="n">diff_ratings_wc</span><span class="p">[</span><span class="s1">&#39;attack_home_defence_away_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_ratings_wc3</span><span class="p">[</span><span class="s1">&#39;attack_x&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_ratings_wc3</span><span class="p">[</span><span class="s1">&#39;defence_y&#39;</span><span class="p">]</span>
<span class="n">diff_ratings_wc</span><span class="p">[</span><span class="s1">&#39;attack_away_defence_home_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">results_ratings_wc3</span><span class="p">[</span><span class="s1">&#39;attack_y&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">results_ratings_wc3</span><span class="p">[</span><span class="s1">&#39;defence_x&#39;</span><span class="p">]</span>

<span class="n">diff_ratings_wc</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>attack_diff</th>
      <th>bup_dribbling_diff</th>
      <th>bup_passing_diff</th>
      <th>bup_speed_diff</th>
      <th>cc_crossing_diff</th>
      <th>cc_passing_diff</th>
      <th>cc_shooting_diff</th>
      <th>d_aggresion_diff</th>
      <th>d_pressure_diff</th>
      <th>d_width_diff</th>
      <th>...</th>
      <th>goalkeeeper_overall_diff</th>
      <th>growth_diff</th>
      <th>midfield_diff</th>
      <th>overall_diff</th>
      <th>prestige_diff</th>
      <th>start_age_diff</th>
      <th>value_euros_millions_diff</th>
      <th>wage_euros_thousands_diff</th>
      <th>attack_home_defence_away_diff</th>
      <th>attack_away_defence_home_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9.0</td>
      <td>9.0</td>
      <td>-17.0</td>
      <td>-19.0</td>
      <td>-11.0</td>
      <td>-9.0</td>
      <td>-27.0</td>
      <td>1.0</td>
      <td>-0.0</td>
      <td>-17.0</td>
      <td>...</td>
      <td>11.0</td>
      <td>-0.000</td>
      <td>6.0</td>
      <td>7.0</td>
      <td>2.0</td>
      <td>-0.18</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>9.0</td>
      <td>-6.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-9.0</td>
      <td>-9.0</td>
      <td>17.0</td>
      <td>19.0</td>
      <td>11.0</td>
      <td>9.0</td>
      <td>27.0</td>
      <td>-1.0</td>
      <td>-0.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>-11.0</td>
      <td>-0.000</td>
      <td>-6.0</td>
      <td>-7.0</td>
      <td>-2.0</td>
      <td>0.18</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-6.0</td>
      <td>9.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-14.0</td>
      <td>-8.0</td>
      <td>13.0</td>
      <td>14.0</td>
      <td>21.0</td>
      <td>25.0</td>
      <td>-12.0</td>
      <td>-9.0</td>
      <td>-0.0</td>
      <td>-30.0</td>
      <td>...</td>
      <td>-15.0</td>
      <td>-0.425</td>
      <td>-0.0</td>
      <td>-4.0</td>
      <td>-2.0</td>
      <td>1.55</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>-7.0</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>14.0</td>
      <td>8.0</td>
      <td>-13.0</td>
      <td>-14.0</td>
      <td>-21.0</td>
      <td>-25.0</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>-0.0</td>
      <td>30.0</td>
      <td>...</td>
      <td>15.0</td>
      <td>0.425</td>
      <td>-0.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>-1.55</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>12.0</td>
      <td>-7.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-7.0</td>
      <td>-15.0</td>
      <td>-31.0</td>
      <td>-31.0</td>
      <td>21.0</td>
      <td>-9.0</td>
      <td>-9.0</td>
      <td>9.0</td>
      <td>17.0</td>
      <td>46.0</td>
      <td>...</td>
      <td>-3.0</td>
      <td>-0.175</td>
      <td>6.0</td>
      <td>2.0</td>
      <td>-0.0</td>
      <td>0.28</td>
      <td>-0.0</td>
      <td>-0.0</td>
      <td>2.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 22 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">ratings_base_wc</span><span class="p">,</span> <span class="n">diff_ratings_wc</span><span class="p">,</span> <span class="n">diff_rankings_wc</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[65]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(35, 36)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># test[&#39;gdp_diff&#39;] = pd.Series(gdp_col_test).astype(&#39;category&#39;)</span>
<span class="n">test</span><span class="p">[</span><span class="s1">&#39;gdp_diff&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">gdp_col_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">test</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1"># gdp_series_test</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">train</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[68]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;attack_away_defence_home_diff&#39;, &#39;attack_diff&#39;,
       &#39;attack_home_defence_away_diff&#39;, &#39;bup_dribbling_diff&#39;,
       &#39;bup_passing_diff&#39;, &#39;bup_speed_diff&#39;, &#39;cc_crossing_diff&#39;,
       &#39;cc_passing_diff&#39;, &#39;cc_shooting_diff&#39;, &#39;cur_year_avg_diff&#39;,
       &#39;cur_year_avg_weighted_diff&#39;, &#39;d_aggresion_diff&#39;, &#39;d_pressure_diff&#39;,
       &#39;d_width_diff&#39;, &#39;defence_diff&#39;, &#39;full_age_diff&#39;, &#39;gdp_diff&#39;,
       &#39;goalkeeeper_overall_diff&#39;, &#39;growth_diff&#39;, &#39;home_win&#39;,
       &#39;last_year_avg_diff&#39;, &#39;last_year_avg_weighted_diff&#39;, &#39;midfield_diff&#39;,
       &#39;overall_diff&#39;, &#39;prestige_diff&#39;, &#39;previous_points_diff&#39;,
       &#39;rank_change_diff&#39;, &#39;rank_diff&#39;, &#39;start_age_diff&#39;,
       &#39;three_year_ago_avg_diff&#39;, &#39;three_year_ago_weighted_diff&#39;,
       &#39;total_points_diff&#39;, &#39;two_year_ago_avg_diff&#39;,
       &#39;two_year_ago_weighted_diff&#39;, &#39;value_euros_millions_diff&#39;,
       &#39;wage_euros_thousands_diff&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">test</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[69]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Index([&#39;attack_away_defence_home_diff&#39;, &#39;attack_diff&#39;,
       &#39;attack_home_defence_away_diff&#39;, &#39;bup_dribbling_diff&#39;,
       &#39;bup_passing_diff&#39;, &#39;bup_speed_diff&#39;, &#39;cc_crossing_diff&#39;,
       &#39;cc_passing_diff&#39;, &#39;cc_shooting_diff&#39;, &#39;cur_year_avg_diff&#39;,
       &#39;cur_year_avg_weighted_diff&#39;, &#39;d_aggresion_diff&#39;, &#39;d_pressure_diff&#39;,
       &#39;d_width_diff&#39;, &#39;defence_diff&#39;, &#39;full_age_diff&#39;, &#39;gdp_diff&#39;,
       &#39;goalkeeeper_overall_diff&#39;, &#39;growth_diff&#39;, &#39;home_win&#39;,
       &#39;last_year_avg_diff&#39;, &#39;last_year_avg_weighted_diff&#39;, &#39;midfield_diff&#39;,
       &#39;overall_diff&#39;, &#39;prestige_diff&#39;, &#39;previous_points_diff&#39;,
       &#39;rank_change_diff&#39;, &#39;rank_diff&#39;, &#39;start_age_diff&#39;,
       &#39;three_year_ago_avg_diff&#39;, &#39;three_year_ago_weighted_diff&#39;,
       &#39;total_points_diff&#39;, &#39;two_year_ago_avg_diff&#39;,
       &#39;two_year_ago_weighted_diff&#39;, &#39;value_euros_millions_diff&#39;,
       &#39;wage_euros_thousands_diff&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>

<span></span><span class="c1"># compile datframe</span>
<span class="c1"># test = pd.concat([ratings_base_wc, diff_ratings_wc, diff_rankings_wc], axis=1)</span>
<span class="c1">#Assert columns of train and test are in same order</span>
<span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="k">assert</span> <span class="nb">list</span><span class="p">(</span><span class="n">test</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="c1"># test.head()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">test</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">tournament_round</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#get rid of even rows since same match as odd rows.</span>
<span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">index</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># save to csv</span>
<span class="n">test</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/test_team.csv&quot;</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Brian Lin, Shane Ong, Pat Sukhum, Matteo Zhang.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>