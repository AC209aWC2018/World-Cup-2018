<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Scrape World Cup Squads &#8212; World Cup  documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          World Cup</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/problem_statement.html">Overview and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/related_works.html">Literature Review and Related Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/data_description.html">Description of Data</a></li>
</ul>
<p class="caption"><span class="caption-text">EDA:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/eda_writeup.html">Exploratory Data Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Models:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/baseline_writeup.html">Baseline Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/beyond_baseline_writeup.html">Beyond Baseline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/neural_network_writeup.html">Bonus: Neural Network on Small Training Set</a></li>
</ul>
<p class="caption"><span class="caption-text">Summary and Conclusion:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../doc/results_writeup.html">Results Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc/summary.html">Project Summary and Future Work</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Scrape World Cup Squads</a><ul>
<li><a class="reference internal" href="#Map-Test-Data-to-Sofifa-Dataset">Map Test Data to Sofifa Dataset</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/scrap/scrape_wcsquads.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput,
div.nbinput div.prompt,
div.nbinput div.input_area,
div.nbinput div[class*=highlight],
div.nbinput div[class*=highlight] pre,
div.nboutput,
div.nbinput div.prompt,
div.nbinput div.output_area,
div.nboutput div[class*=highlight],
div.nboutput div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput,
div.nboutput {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput,
    div.nboutput {
        flex-direction: column;
    }
}

/* input container */
div.nbinput {
    padding-top: 5px;
}

/* last container */
div.nblast {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput div.prompt pre {
    color: #303F9F;
}

/* output prompt */
div.nboutput div.prompt pre {
    color: #D84315;
}

/* all prompts */
div.nbinput div.prompt,
div.nboutput div.prompt {
    min-width: 9ex;
    padding-top: 0.4em;
    padding-right: 0.4em;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput div.prompt,
    div.nboutput div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput div.prompt pre,
div.nboutput div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput div.input_area,
div.nboutput div.output_area {
    padding: 0.4em;
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput div.input_area,
    div.nboutput div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput div.input_area {
    border: 1px solid #cfcfcf;
    border-radius: 2px;
    background: #f7f7f7;
}

/* override MathJax center alignment in output cells */
div.nboutput div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.pngmath center alignment in output cells */
div.nboutput div.math p {
    text-align: left;
}

/* standard error */
div.nboutput div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }
</style>
<div class="section" id="Scrape-World-Cup-Squads">
<h1>Scrape World Cup Squads<a class="headerlink" href="#Scrape-World-Cup-Squads" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">bs4</span> <span class="k">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">map_countries</span> <span class="k">import</span> <span class="n">map_country</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">scrape_wikpedia_wc_players</span><span class="p">(</span><span class="n">year</span><span class="p">):</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://en.wikipedia.org/wiki/</span><span class="si">{}</span><span class="s2">_FIFA_World_Cup_squads&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">my_page</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">my_page</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
        <span class="n">soup</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">my_page</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;lxml&quot;</span><span class="p">)</span>
        <span class="n">tables</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;table&#39;</span><span class="p">,{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span><span class="s1">&#39;sortable wikitable plainrowheaders&#39;</span><span class="p">})</span>
        <span class="n">countries</span> <span class="o">=</span> <span class="n">soup</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;li&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;toclevel-2&#39;</span><span class="p">})[:</span><span class="mi">32</span><span class="p">]</span>
        <span class="n">players_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Pos&#39;</span><span class="p">,</span> <span class="s1">&#39;Birthday&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Caps&#39;</span><span class="p">,</span> <span class="s1">&#39;Club&#39;</span><span class="p">,</span> <span class="s1">&#39;Club Country&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">table</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tables</span><span class="p">):</span>
            <span class="c1">#first result would be column names</span>
            <span class="n">country</span> <span class="o">=</span> <span class="n">countries</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;span&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;class&#39;</span><span class="p">:</span> <span class="s1">&#39;toctext&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">text</span>
            <span class="n">players</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;tr&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="k">for</span> <span class="n">player</span> <span class="ow">in</span> <span class="n">players</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;th&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">td_tags</span> <span class="o">=</span> <span class="n">player</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;td&#39;</span><span class="p">)</span>
                <span class="n">position</span> <span class="o">=</span> <span class="n">td_tags</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
                <span class="n">birthday</span> <span class="o">=</span> <span class="n">td_tags</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">12</span><span class="p">]</span>
                <span class="n">age</span> <span class="o">=</span> <span class="n">td_tags</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">caps</span> <span class="o">=</span> <span class="n">td_tags</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="c1">#Only 2018 has goals, so do not keep it.</span>
<span class="c1">#                 goals = td_tags[4].text.replace(&#39;\n&#39;, &quot;&quot;)</span>
                <span class="c1">#Last element is club. Some are free agents.</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">club</span> <span class="o">=</span> <span class="n">td_tags</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
                    <span class="n">club_country</span> <span class="o">=</span> <span class="n">td_tags</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">)[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span>
                <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                    <span class="n">club</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="n">club_country</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="n">row</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">([[</span><span class="n">name</span><span class="p">,</span> <span class="n">country</span><span class="p">,</span> <span class="n">position</span><span class="p">,</span> <span class="n">birthday</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">caps</span><span class="p">,</span> <span class="n">club</span><span class="p">,</span> <span class="n">club_country</span><span class="p">]],</span>\
                                   <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Player&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">,</span> <span class="s1">&#39;Pos&#39;</span><span class="p">,</span> <span class="s1">&#39;Birthday&#39;</span><span class="p">,</span> <span class="s1">&#39;Age&#39;</span><span class="p">,</span> <span class="s1">&#39;Caps&#39;</span><span class="p">,</span> <span class="s1">&#39;Club&#39;</span><span class="p">,</span> <span class="s1">&#39;Club Country&#39;</span><span class="p">])</span>
                <span class="n">players_df</span> <span class="o">=</span> <span class="n">players_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="n">players_df</span> <span class="o">=</span> <span class="n">players_df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">players_df</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">year</span>
        <span class="k">return</span> <span class="n">players_df</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">years</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2010</span><span class="p">,</span> <span class="mi">2014</span><span class="p">,</span> <span class="mi">2018</span><span class="p">]</span>
<span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">years</span><span class="p">:</span>
    <span class="n">wc_players</span> <span class="o">=</span> <span class="n">scrape_wikpedia_wc_players</span><span class="p">(</span><span class="n">year</span><span class="p">)</span>
    <span class="n">wc_players</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wc_players</span><span class="p">[</span><span class="s1">&#39;Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_country</span><span class="p">)</span>
    <span class="n">wc_players</span><span class="p">[</span><span class="s1">&#39;Club Country&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wc_players</span><span class="p">[</span><span class="s1">&#39;Club Country&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_country</span><span class="p">)</span>
    <span class="n">wc_players</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned/wc_players_</span><span class="si">{}</span><span class="s2">.csv&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">year</span><span class="p">),</span> <span class="n">index</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Map-Test-Data-to-Sofifa-Dataset">
<h2>Map Test Data to Sofifa Dataset<a class="headerlink" href="#Map-Test-Data-to-Sofifa-Dataset" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_2018</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/cleaned/wc_players_2018.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [106]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_2018</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[106]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Player</th>
      <th>Country</th>
      <th>Pos</th>
      <th>Birthday</th>
      <th>Age</th>
      <th>Caps</th>
      <th>Club</th>
      <th>Club Country</th>
      <th>year</th>
      <th>name_converted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Essam El-Hadary</td>
      <td>egypt</td>
      <td>GK</td>
      <td>1973-01-15</td>
      <td>45</td>
      <td>158</td>
      <td>Al-Taawoun</td>
      <td>saudi arabia</td>
      <td>2018</td>
      <td>EElHadary</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ali Gabr</td>
      <td>egypt</td>
      <td>DF</td>
      <td>1989-01-01</td>
      <td>29</td>
      <td>21</td>
      <td>West Bromwich Albion</td>
      <td>england</td>
      <td>2018</td>
      <td>AGabr</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ahmed Elmohamady</td>
      <td>egypt</td>
      <td>DF</td>
      <td>1987-09-09</td>
      <td>30</td>
      <td>78</td>
      <td>Aston Villa</td>
      <td>england</td>
      <td>2018</td>
      <td>AElmohamady</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Omar Gaber</td>
      <td>egypt</td>
      <td>MF</td>
      <td>1992-01-30</td>
      <td>26</td>
      <td>24</td>
      <td>Los Angeles FC</td>
      <td>usa</td>
      <td>2018</td>
      <td>OGaber</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sam Morsy</td>
      <td>egypt</td>
      <td>MF</td>
      <td>1991-09-10</td>
      <td>26</td>
      <td>5</td>
      <td>Wigan Athletic</td>
      <td>england</td>
      <td>2018</td>
      <td>SMorsy</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [94]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sofifa_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;data/sofifa/CompleteDataset.csv&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">([</span><span class="s1">&#39;Unnamed: 0&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">sofifa_df</span><span class="p">[</span><span class="s1">&#39;Nationality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sofifa_df</span><span class="p">[</span><span class="s1">&#39;Nationality&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">map_country</span><span class="p">)</span>

</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="stderr output_area docutils container">
<div class="highlight"><pre>
/Users/blin/anaconda3/lib/python3.6/site-packages/IPython/core/interactiveshell.py:3020: DtypeWarning: Columns (23,35) have mixed types. Specify dtype option on import or set low_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [107]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sofifa_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[107]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>Value</th>
      <th>...</th>
      <th>RCB</th>
      <th>RCM</th>
      <th>RDM</th>
      <th>RF</th>
      <th>RM</th>
      <th>RS</th>
      <th>RW</th>
      <th>RWB</th>
      <th>ST</th>
      <th>name_converted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Cristiano Ronaldo</td>
      <td>32</td>
      <td>https://cdn.sofifa.org/48/18/players/20801.png</td>
      <td>portugal</td>
      <td>https://cdn.sofifa.org/flags/38.png</td>
      <td>94</td>
      <td>94</td>
      <td>Real Madrid CF</td>
      <td>https://cdn.sofifa.org/24/18/teams/243.png</td>
      <td>€95.5M</td>
      <td>...</td>
      <td>53.0</td>
      <td>82.0</td>
      <td>62.0</td>
      <td>91.0</td>
      <td>89.0</td>
      <td>92.0</td>
      <td>91.0</td>
      <td>66.0</td>
      <td>92.0</td>
      <td>CRonaldo</td>
    </tr>
    <tr>
      <th>1</th>
      <td>L. Messi</td>
      <td>30</td>
      <td>https://cdn.sofifa.org/48/18/players/158023.png</td>
      <td>argentina</td>
      <td>https://cdn.sofifa.org/flags/52.png</td>
      <td>93</td>
      <td>93</td>
      <td>FC Barcelona</td>
      <td>https://cdn.sofifa.org/24/18/teams/241.png</td>
      <td>€105M</td>
      <td>...</td>
      <td>45.0</td>
      <td>84.0</td>
      <td>59.0</td>
      <td>92.0</td>
      <td>90.0</td>
      <td>88.0</td>
      <td>91.0</td>
      <td>62.0</td>
      <td>88.0</td>
      <td>LMessi</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Neymar</td>
      <td>25</td>
      <td>https://cdn.sofifa.org/48/18/players/190871.png</td>
      <td>brazil</td>
      <td>https://cdn.sofifa.org/flags/54.png</td>
      <td>92</td>
      <td>94</td>
      <td>Paris Saint-Germain</td>
      <td>https://cdn.sofifa.org/24/18/teams/73.png</td>
      <td>€123M</td>
      <td>...</td>
      <td>46.0</td>
      <td>79.0</td>
      <td>59.0</td>
      <td>88.0</td>
      <td>87.0</td>
      <td>84.0</td>
      <td>89.0</td>
      <td>64.0</td>
      <td>84.0</td>
      <td>Neymar</td>
    </tr>
    <tr>
      <th>3</th>
      <td>L. Suárez</td>
      <td>30</td>
      <td>https://cdn.sofifa.org/48/18/players/176580.png</td>
      <td>uruguay</td>
      <td>https://cdn.sofifa.org/flags/60.png</td>
      <td>92</td>
      <td>92</td>
      <td>FC Barcelona</td>
      <td>https://cdn.sofifa.org/24/18/teams/241.png</td>
      <td>€97M</td>
      <td>...</td>
      <td>58.0</td>
      <td>80.0</td>
      <td>65.0</td>
      <td>88.0</td>
      <td>85.0</td>
      <td>88.0</td>
      <td>87.0</td>
      <td>68.0</td>
      <td>88.0</td>
      <td>LSuárez</td>
    </tr>
    <tr>
      <th>4</th>
      <td>M. Neuer</td>
      <td>31</td>
      <td>https://cdn.sofifa.org/48/18/players/167495.png</td>
      <td>germany</td>
      <td>https://cdn.sofifa.org/flags/21.png</td>
      <td>92</td>
      <td>92</td>
      <td>FC Bayern Munich</td>
      <td>https://cdn.sofifa.org/24/18/teams/21.png</td>
      <td>€61M</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>MNeuer</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 75 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [114]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sofifa_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">26</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[114]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>array([&#39;14&#39;, &#39;15&#39;, &#39;33&#39;, &#39;91&#39;, &#39;8&#39;, &#39;86&#39;, &#39;7&#39;, &#39;5&#39;, &#39;10&#39;, &#39;12&#39;, &#39;11&#39;, &#39;4&#39;,
       &#39;90&#39;, &#39;87&#39;, &#39;13&#39;, &#39;9&#39;, &#39;2&#39;, &#39;6&#39;, &#39;82&#39;, &#39;1&#39;, &#39;16&#39;, &#39;83&#39;, &#39;80&#39;, &#39;85&#39;,
       &#39;81&#39;, &#39;78&#39;, &#39;79&#39;, &#39;3&#39;, &#39;84&#39;, &#39;77&#39;, &#39;76&#39;, &#39;74&#39;, &#39;32&#39;, &#39;75&#39;, &#39;70&#39;,
       &#39;17&#39;, &#39;19&#39;, &#39;73&#39;, &#39;72&#39;, &#39;69&#39;, &#39;71&#39;, &#39;65&#39;, &#39;18&#39;, &#39;71-2&#39;, &#39;69+1&#39;,
       &#39;20&#39;, &#39;66&#39;, &#39;68&#39;, &#39;67&#39;, &#39;24&#39;, &#39;21&#39;, &#39;64&#39;, &#39;66-2&#39;, &#39;69+2&#39;, &#39;63&#39;,
       &#39;60&#39;, &#39;62&#39;, &#39;55&#39;, &#39;64+1&#39;, &#39;61&#39;, &#39;57&#39;, &#39;59&#39;, &#39;65+4&#39;, &#39;23&#39;, &#39;60+3&#39;,
       &#39;66-1&#39;, &#39;65+1&#39;, &#39;58&#39;, &#39;30&#39;, &#39;63-1&#39;, &#39;70+2&#39;, &#39;62-1&#39;, &#39;56&#39;, &#39;51&#39;,
       &#39;53&#39;, &#39;64+2&#39;, &#39;62+4&#39;, &#39;49&#39;, &#39;54&#39;, &#39;61-1&#39;, &#39;27&#39;, &#39;47&#39;, &#39;52&#39;, &#39;60+1&#39;,
       &#39;58+2&#39;, &#39;50&#39;, &#39;58+4&#39;, &#39;48&#39;, &#39;59+2&#39;, &#39;46&#39;, &#39;45&#39;, &#39;44&#39;, &#39;51+3&#39;,
       &#39;45-1&#39;, &#39;42&#39;, &#39;40&#39;, &#39;43&#39;, &#39;41&#39;, &#39;38&#39;], dtype=object)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [97]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">sofifa_df</span><span class="p">[</span><span class="n">sofifa_df</span><span class="o">.</span><span class="n">Name</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Hadary&#39;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[97]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Name</th>
      <th>Age</th>
      <th>Photo</th>
      <th>Nationality</th>
      <th>Flag</th>
      <th>Overall</th>
      <th>Potential</th>
      <th>Club</th>
      <th>Club Logo</th>
      <th>Value</th>
      <th>...</th>
      <th>RB</th>
      <th>RCB</th>
      <th>RCM</th>
      <th>RDM</th>
      <th>RF</th>
      <th>RM</th>
      <th>RS</th>
      <th>RW</th>
      <th>RWB</th>
      <th>ST</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>5314</th>
      <td>E. El Hadary</td>
      <td>44</td>
      <td>https://cdn.sofifa.org/48/18/players/188033.png</td>
      <td>egypt</td>
      <td>https://cdn.sofifa.org/flags/111.png</td>
      <td>70</td>
      <td>70</td>
      <td>Al Taawoun</td>
      <td>https://cdn.sofifa.org/24/18/teams/112393.png</td>
      <td>€120K</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>1 rows × 74 columns</p>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [98]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">def</span> <span class="nf">to_common_name</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="c1">#Sofifa dataset does not include &quot;-&quot; in people&#39;s last name and instead has a space</span>
    <span class="c1"># (i.e. Essam El-Hadary), so sub it with space</span>
    <span class="n">common_name</span> <span class="o">=</span> <span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">common_name</span> <span class="o">=</span> <span class="n">common_name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">common_name</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1">#First initial of first name + + last name</span>
        <span class="n">common_name</span> <span class="o">=</span> <span class="n">common_name</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">common_name</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">return</span> <span class="n">common_name</span>

    <span class="c1">#case where there is only last name / nickname. Then just return original wc squad name since it seems</span>
    <span class="c1">#the sofifa name and original wc squad name correspond in this case.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [99]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">to_sofifa_name</span><span class="p">(</span><span class="s1">&#39;Essam El-Hadary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[99]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;EElHadary&#39;
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [100]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">to_sofifa_name</span><span class="p">(</span><span class="s1">&#39;E. El Hadary&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[100]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>&#39;EElHadary&#39;
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [101]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_names_converted</span> <span class="o">=</span> <span class="n">wc_players_2018</span><span class="p">[</span><span class="s1">&#39;Player&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">to_sofifa_name</span><span class="p">)</span>
<span class="n">wc_players_2018</span><span class="p">[</span><span class="s1">&#39;name_converted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">wc_names_converted</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [102]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Sofifa also inconsistent with its own convention sometimes (i.e. Cristiano Ronaldo instead of C. Ronaldo)</span>
<span class="c1">#So just run the algorithm on sofifa as well.</span>
<span class="n">sofifa_names_converted</span> <span class="o">=</span> <span class="n">sofifa_df</span><span class="p">[</span><span class="s1">&#39;Name&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">to_sofifa_name</span><span class="p">)</span>
<span class="n">sofifa_df</span><span class="p">[</span><span class="s1">&#39;name_converted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sofifa_names_converted</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [130]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_sofifa_merged</span> <span class="o">=</span> <span class="n">wc_players_2018</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">sofifa_df</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">left_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name_converted&#39;</span><span class="p">,</span> <span class="s1">&#39;Country&#39;</span><span class="p">,],</span>
                        <span class="n">right_on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name_converted&#39;</span><span class="p">,</span> <span class="s1">&#39;Nationality&#39;</span><span class="p">])</span>
<span class="n">wc_players_sofifa_merged</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[130]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Player</th>
      <th>Country</th>
      <th>Pos</th>
      <th>Birthday</th>
      <th>Age_x</th>
      <th>Caps</th>
      <th>Club_x</th>
      <th>Club Country</th>
      <th>year</th>
      <th>name_converted</th>
      <th>...</th>
      <th>RB</th>
      <th>RCB</th>
      <th>RCM</th>
      <th>RDM</th>
      <th>RF</th>
      <th>RM</th>
      <th>RS</th>
      <th>RW</th>
      <th>RWB</th>
      <th>ST</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Essam El-Hadary</td>
      <td>egypt</td>
      <td>GK</td>
      <td>1973-01-15</td>
      <td>45</td>
      <td>158</td>
      <td>Al-Taawoun</td>
      <td>saudi arabia</td>
      <td>2018</td>
      <td>EElHadary</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Ali Gabr</td>
      <td>egypt</td>
      <td>DF</td>
      <td>1989-01-01</td>
      <td>29</td>
      <td>21</td>
      <td>West Bromwich Albion</td>
      <td>england</td>
      <td>2018</td>
      <td>AGabr</td>
      <td>...</td>
      <td>61.0</td>
      <td>66.0</td>
      <td>50.0</td>
      <td>61.0</td>
      <td>42.0</td>
      <td>46.0</td>
      <td>45.0</td>
      <td>43.0</td>
      <td>58.0</td>
      <td>45.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Ahmed Elmohamady</td>
      <td>egypt</td>
      <td>DF</td>
      <td>1987-09-09</td>
      <td>30</td>
      <td>78</td>
      <td>Aston Villa</td>
      <td>england</td>
      <td>2018</td>
      <td>AElmohamady</td>
      <td>...</td>
      <td>71.0</td>
      <td>68.0</td>
      <td>72.0</td>
      <td>70.0</td>
      <td>71.0</td>
      <td>73.0</td>
      <td>70.0</td>
      <td>72.0</td>
      <td>72.0</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Omar Gaber</td>
      <td>egypt</td>
      <td>MF</td>
      <td>1992-01-30</td>
      <td>26</td>
      <td>24</td>
      <td>Los Angeles FC</td>
      <td>usa</td>
      <td>2018</td>
      <td>OGaber</td>
      <td>...</td>
      <td>68.0</td>
      <td>67.0</td>
      <td>65.0</td>
      <td>68.0</td>
      <td>62.0</td>
      <td>65.0</td>
      <td>62.0</td>
      <td>63.0</td>
      <td>68.0</td>
      <td>62.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Sam Morsy</td>
      <td>egypt</td>
      <td>MF</td>
      <td>1991-09-10</td>
      <td>26</td>
      <td>5</td>
      <td>Wigan Athletic</td>
      <td>england</td>
      <td>2018</td>
      <td>SMorsy</td>
      <td>...</td>
      <td>63.0</td>
      <td>65.0</td>
      <td>67.0</td>
      <td>67.0</td>
      <td>64.0</td>
      <td>65.0</td>
      <td>61.0</td>
      <td>64.0</td>
      <td>64.0</td>
      <td>61.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 84 columns</p>
</div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [131]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_2018</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[131]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(736, 10)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [132]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_sofifa_merged</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[132]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>(788, 84)
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [139]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_sofifa_merged</span><span class="o">.</span><span class="n">Player</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[139]:
</pre></div>
</div>
<div class="output_area highlight-none notranslate"><div class="highlight"><pre>
<span></span>Danilo                  5
Paulinho                4
Danny Rose              3
Marcelo                 3
Sebastian Larsson       3
Rodrigo                 3
Thomas Müller           3
Dejan Lovren            2
Saúl                    2
John Guidetti           2
Mansoor Al-Harbi        2
Anton Miranchuk         2
Juan Cuadrado           2
James Rodríguez         2
Jesse Lingard           2
Osama Hawsawi           2
Douglas Costa           2
Cristian Rodríguez      2
Timo Werner             2
Nicolai Jørgensen       2
Alfred Gomis            2
Milan Badelj            2
Ismaïla Sarr            2
Camilo Vargas           2
Phil Jones              2
Denis Cheryshev         2
Adrien Silva            2
Adama Mbengue           2
Lee Yong                2
Kosuke Nakamura         2
                       ..
Mohammed Al-Breik       1
Stephan Lichtsteiner    1
Ashley Young            1
Sebastian Rudy          1
Ruben Loftus-Cheek      1
Alberto Rodríguez       1
Naomichi Ueda           1
Edison Flores           1
Nico Elvedi             1
Frederik Rønnow         1
Alisson                 1
Syam Ben Youssef        1
William Troost-Ekong    1
Ramadan Sobhi           1
Jo Hyeon-woo            1
Paul Pogba              1
Majid Hosseini          1
Nilson Loyola           1
Érick Gutiérrez         1
Nick Pope               1
Mark Milligan           1
Lamine Gassama          1
Filipe Luís             1
Nahitan Nández          1
Grzegorz Krychowiak     1
Adolfo Machado          1
Adnan Januzaj           1
Amr Warda               1
Kim Seung-gyu           1
Christian Bolaños       1
Name: Player, Length: 735, dtype: int64
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [142]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wc_players_sofifa_merged</span><span class="p">[</span><span class="n">wc_players_sofifa_merged</span><span class="o">.</span><span class="n">Player</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;Rodrigo&#39;</span><span class="p">)][[</span><span class="s1">&#39;Club_x&#39;</span><span class="p">,</span> <span class="s1">&#39;Club_y&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>Out[142]:
</pre></div>
</div>
<div class="output_area docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Club_x</th>
      <th>Club_y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>81</th>
      <td>Juventus</td>
      <td>Juventus</td>
    </tr>
    <tr>
      <th>183</th>
      <td>Valencia</td>
      <td>Valencia CF</td>
    </tr>
    <tr>
      <th>184</th>
      <td>Valencia</td>
      <td>Valencia CF</td>
    </tr>
    <tr>
      <th>185</th>
      <td>Valencia</td>
      <td>Villarreal CF</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre>
<span></span>In [ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Brian Lin, Shane Ong, Pat Sukhum, Matteo Zhang.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>