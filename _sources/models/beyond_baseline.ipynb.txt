{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Modeling with Feature Engineered Features"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "from sklearn.metrics import accuracy_score\n",
    "from sklearn.linear_model import LogisticRegressionCV, LogisticRegression\n",
    "from sklearn.discriminant_analysis import LinearDiscriminantAnalysis\n",
    "from sklearn.discriminant_analysis import QuadraticDiscriminantAnalysis\n",
    "from sklearn.ensemble import RandomForestClassifier\n",
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.model_selection import RandomizedSearchCV, GridSearchCV\n",
    "from predict_test_data import predict_test_data\n",
    "from sklearn.preprocessing import StandardScaler\n",
    "from xgboost import XGBClassifier\n",
    "from sklearn.decomposition import PCA\n",
    "from sklearn.preprocessing import LabelBinarizer\n",
    "from sklearn.cross_decomposition import PLSRegression\n",
    "\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "import seaborn as sns\n",
    "sns.set()\n",
    "\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "train = pd.read_csv('../data/cleaned/train_final.csv')\n",
    "test = pd.read_csv('../data/cleaned/test_final.csv')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "To begin, let's just naively use all the features we have feature engineered."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "columns = ['overall_diff', 'attack_away_defence_home_diff', 'attack_diff',\n",
    "           'attack_home_defence_away_diff', 'defence_diff', 'midfield_diff',\n",
    "           'rank_diff', 'prestige_diff', 'growth_diff', 'full_age_diff',\n",
    "           'start_age_diff', 'value_euros_millions_diff',\n",
    "           'wage_euros_thousands_diff', 'goalkeeper_overall_diff',\n",
    "           'bup_dribbling_diff', 'bup_passing_diff', 'bup_speed_diff',\n",
    "           'cc_crossing_diff', 'cc_passing_diff', 'cc_shooting_diff',\n",
    "           'd_aggresion_diff', 'd_pressure_diff', 'd_width_diff', \n",
    "           'gdp_diff', 'is_home', 'raw_gdp_diff', 'wins_past_1_games_diff',\n",
    "           'wins_home_against_away_1_games', 'wins_past_2_games_diff',\n",
    "           'wins_home_against_away_2_games', 'wins_past_3_games_diff',\n",
    "           'wins_home_against_away_3_games', 'wins_past_4_games_diff',\n",
    "           'wins_home_against_away_4_games', 'wins_past_5_games_diff',\n",
    "           'wins_home_against_away_5_games', 'score_past_1_games_diff', \n",
    "           'score_conceded_past_1_games_diff']\n",
    "\n",
    "train = train[columns + ['home_win']]\n",
    "test = test[columns  + ['home_win']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Same seed as baseline to ensure same train and validation sets so that comparisons are valid.\n",
    "np.random.seed(14)\n",
    "X_train, X_valid = train_test_split(train, test_size = 0.2)\n",
    "y_train = X_train['home_win'].ravel()\n",
    "X_train = X_train.drop(['home_win'], axis = 1)\n",
    "y_valid= X_valid['home_win'].ravel()\n",
    "X_valid = X_valid.drop(['home_win'], axis = 1)\n",
    "y_test = test['home_win'].ravel()\n",
    "X_test = test.drop(['home_win'], axis = 1)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Fitting the Models"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Similar to before, we will fit different classification models on our data and select the one with the best validation accuracy. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "score = {}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Logistic Regression Train Score: 0.5108767303889256\n",
      "Logistic Regression Validation Score: 0.5263157894736842\n"
     ]
    }
   ],
   "source": [
    "lr_model = LogisticRegressionCV(solver = 'lbfgs', max_iter = 5000, cv = 5, multi_class='multinomial').fit(X_train, y_train)\n",
    "score[\"Logistic Regression\"] = {}\n",
    "score[\"Logistic Regression\"][\"model\"] = lr_model\n",
    "score[\"Logistic Regression\"][\"Train Score\"] = lr_model.score(X_train, y_train)\n",
    "score[\"Logistic Regression\"][\"Validation Score\"] = lr_model.score(X_valid, y_valid)\n",
    "\n",
    "print(\"Logistic Regression Train Score: {}\".format(score[\"Logistic Regression\"][\"Train Score\"]))\n",
    "print(\"Logistic Regression Validation Score: {}\".format(score[\"Logistic Regression\"][\"Validation Score\"]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Like before, we first check whether the variances across the three outcomes are equal, and they do seem quite equal.  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>overall_diff</th>\n",
       "      <th>attack_away_defence_home_diff</th>\n",
       "      <th>attack_diff</th>\n",
       "      <th>attack_home_defence_away_diff</th>\n",
       "      <th>defence_diff</th>\n",
       "      <th>midfield_diff</th>\n",
       "      <th>rank_diff</th>\n",
       "      <th>prestige_diff</th>\n",
       "      <th>growth_diff</th>\n",
       "      <th>full_age_diff</th>\n",
       "      <th>...</th>\n",
       "      <th>wins_past_2_games_diff</th>\n",
       "      <th>wins_home_against_away_2_games</th>\n",
       "      <th>wins_past_3_games_diff</th>\n",
       "      <th>wins_home_against_away_3_games</th>\n",
       "      <th>wins_past_4_games_diff</th>\n",
       "      <th>wins_home_against_away_4_games</th>\n",
       "      <th>wins_past_5_games_diff</th>\n",
       "      <th>wins_home_against_away_5_games</th>\n",
       "      <th>score_past_1_games_diff</th>\n",
       "      <th>score_conceded_past_1_games_diff</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>home_win</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>-1</th>\n",
       "      <td>31.393396</td>\n",
       "      <td>38.015113</td>\n",
       "      <td>40.858572</td>\n",
       "      <td>41.497639</td>\n",
       "      <td>37.554931</td>\n",
       "      <td>38.133908</td>\n",
       "      <td>916.793268</td>\n",
       "      <td>25.423806</td>\n",
       "      <td>2.770866</td>\n",
       "      <td>2.489490</td>\n",
       "      <td>...</td>\n",
       "      <td>0.245064</td>\n",
       "      <td>0.111833</td>\n",
       "      <td>0.160882</td>\n",
       "      <td>0.107476</td>\n",
       "      <td>0.128351</td>\n",
       "      <td>0.105429</td>\n",
       "      <td>0.104187</td>\n",
       "      <td>0.105104</td>\n",
       "      <td>3.458817</td>\n",
       "      <td>2.980564</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>36.158215</td>\n",
       "      <td>46.202150</td>\n",
       "      <td>47.654088</td>\n",
       "      <td>46.137393</td>\n",
       "      <td>43.559341</td>\n",
       "      <td>41.798216</td>\n",
       "      <td>960.540851</td>\n",
       "      <td>30.781631</td>\n",
       "      <td>2.593080</td>\n",
       "      <td>2.596855</td>\n",
       "      <td>...</td>\n",
       "      <td>0.226939</td>\n",
       "      <td>0.120386</td>\n",
       "      <td>0.159603</td>\n",
       "      <td>0.113178</td>\n",
       "      <td>0.118615</td>\n",
       "      <td>0.111858</td>\n",
       "      <td>0.097423</td>\n",
       "      <td>0.111192</td>\n",
       "      <td>3.370146</td>\n",
       "      <td>2.821887</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>37.105145</td>\n",
       "      <td>47.913430</td>\n",
       "      <td>49.295727</td>\n",
       "      <td>45.265228</td>\n",
       "      <td>43.509512</td>\n",
       "      <td>42.634416</td>\n",
       "      <td>936.866455</td>\n",
       "      <td>26.985673</td>\n",
       "      <td>2.953428</td>\n",
       "      <td>2.406626</td>\n",
       "      <td>...</td>\n",
       "      <td>0.209184</td>\n",
       "      <td>0.114938</td>\n",
       "      <td>0.149652</td>\n",
       "      <td>0.109862</td>\n",
       "      <td>0.124287</td>\n",
       "      <td>0.107973</td>\n",
       "      <td>0.104463</td>\n",
       "      <td>0.108109</td>\n",
       "      <td>2.869865</td>\n",
       "      <td>2.709063</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>3 rows × 38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          overall_diff  attack_away_defence_home_diff  attack_diff  \\\n",
       "home_win                                                             \n",
       "-1           31.393396                      38.015113    40.858572   \n",
       " 0           36.158215                      46.202150    47.654088   \n",
       " 1           37.105145                      47.913430    49.295727   \n",
       "\n",
       "          attack_home_defence_away_diff  defence_diff  midfield_diff  \\\n",
       "home_win                                                               \n",
       "-1                            41.497639     37.554931      38.133908   \n",
       " 0                            46.137393     43.559341      41.798216   \n",
       " 1                            45.265228     43.509512      42.634416   \n",
       "\n",
       "           rank_diff  prestige_diff  growth_diff  full_age_diff  \\\n",
       "home_win                                                          \n",
       "-1        916.793268      25.423806     2.770866       2.489490   \n",
       " 0        960.540851      30.781631     2.593080       2.596855   \n",
       " 1        936.866455      26.985673     2.953428       2.406626   \n",
       "\n",
       "                        ...                 wins_past_2_games_diff  \\\n",
       "home_win                ...                                          \n",
       "-1                      ...                               0.245064   \n",
       " 0                      ...                               0.226939   \n",
       " 1                      ...                               0.209184   \n",
       "\n",
       "          wins_home_against_away_2_games  wins_past_3_games_diff  \\\n",
       "home_win                                                           \n",
       "-1                              0.111833                0.160882   \n",
       " 0                              0.120386                0.159603   \n",
       " 1                              0.114938                0.149652   \n",
       "\n",
       "          wins_home_against_away_3_games  wins_past_4_games_diff  \\\n",
       "home_win                                                           \n",
       "-1                              0.107476                0.128351   \n",
       " 0                              0.113178                0.118615   \n",
       " 1                              0.109862                0.124287   \n",
       "\n",
       "          wins_home_against_away_4_games  wins_past_5_games_diff  \\\n",
       "home_win                                                           \n",
       "-1                              0.105429                0.104187   \n",
       " 0                              0.111858                0.097423   \n",
       " 1                              0.107973                0.104463   \n",
       "\n",
       "          wins_home_against_away_5_games  score_past_1_games_diff  \\\n",
       "home_win                                                            \n",
       "-1                              0.105104                 3.458817   \n",
       " 0                              0.111192                 3.370146   \n",
       " 1                              0.108109                 2.869865   \n",
       "\n",
       "          score_conceded_past_1_games_diff  \n",
       "home_win                                    \n",
       "-1                                2.980564  \n",
       " 0                                2.821887  \n",
       " 1                                2.709063  \n",
       "\n",
       "[3 rows x 38 columns]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "train.groupby('home_win').var()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "lda_model = LinearDiscriminantAnalysis().fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "LDA Train Score: 0.5240606460118655\n",
      "LDA Validation Score: 0.5473684210526316\n"
     ]
    }
   ],
   "source": [
    "score[\"LDA\"] = {}\n",
    "score[\"LDA\"][\"model\"] = lda_model\n",
    "score[\"LDA\"][\"Train Score\"] = lda_model.score(X_train, y_train)\n",
    "score[\"LDA\"][\"Validation Score\"] = lda_model.score(X_valid, y_valid)\n",
    "print(\"LDA Train Score: {}\".format(score[\"LDA\"][\"Train Score\"]))\n",
    "print(\"LDA Validation Score: {}\".format(score[\"LDA\"][\"Validation Score\"]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Likewise, we try out QDA as well."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [],
   "source": [
    "qda_model = QuadraticDiscriminantAnalysis().fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "QDA Train Score: 0.5135135135135135\n",
      "QDA Validation Score: 0.4052631578947368\n"
     ]
    }
   ],
   "source": [
    "score[\"QDA\"] = {}\n",
    "score[\"QDA\"]['model'] = qda_model\n",
    "score[\"QDA\"][\"Train Score\"] = qda_model.score(X_train, y_train)\n",
    "score[\"QDA\"][\"Validation Score\"] = qda_model.score(X_valid, y_valid)\n",
    "print(\"QDA Train Score: {}\".format(score[\"QDA\"][\"Train Score\"]))\n",
    "print(\"QDA Validation Score: {}\".format(score[\"QDA\"][\"Validation Score\"]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Wow, QDA is not doing a great job at all. \n",
    "\n",
    "We will also try out Random Forest."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "rf_params = {'bootstrap': [True, False],\n",
    "     'max_depth': [3, 5, 10, 20, 30, 40, None],\n",
    "'max_features': ['auto', 'sqrt'],\n",
    " 'min_samples_leaf': [1, 2, 4, 10, 20],\n",
    " 'min_samples_split': [2, 5, 10],\n",
    " 'n_estimators': [10, 50, 100, 200, 500]}\n",
    "\n",
    "rf_model = RandomizedSearchCV(estimator=RandomForestClassifier(), param_distributions=rf_params,\\\n",
    "                                   n_iter=50, scoring='accuracy', n_jobs=-1, cv=5, verbose=0).fit(X_train, y_train)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Random Forest Train Score: 0.5814106789716545\n",
      "Random Forest Validation Score 0.5421052631578948\n"
     ]
    }
   ],
   "source": [
    "score[\"Random Forest\"] = {}\n",
    "score[\"Random Forest\"]['model'] = rf_model\n",
    "score[\"Random Forest\"][\"Train Score\"] = rf_model.score(X_train, y_train)\n",
    "score[\"Random Forest\"][\"Validation Score\"] = rf_model.score(X_valid, y_valid)\n",
    "print(\"Random Forest Train Score: {}\".format(score[\"Random Forest\"][\"Train Score\"]))\n",
    "print(\"Random Forest Validation Score {}\".format(score[\"Random Forest\"][\"Validation Score\"]))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "Finally, XGBoost."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [],
   "source": [
    "xgb_params = {\n",
    "    'min_child_weight': [1, 5, 10],\n",
    "    'gamma': [0.5, 1, 1.5, 2, 5],\n",
    "    'subsample': [0.6, 0.8, 1.0],\n",
    "    'colsample_bytree': [0.6, 0.8, 1.0],\n",
    "    'max_depth': [3, 4, 5]\n",
    "    }\n",
    "xgb_model = RandomizedSearchCV(estimator=XGBClassifier(objective='multi:softmax', num_class = 3), param_distributions=xgb_params,\\\n",
    "                                   n_iter=50, scoring='accuracy', n_jobs=-1, cv=5, verbose=0).fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "XGBoost Train Score: 0.5814106789716545\n",
      "XGBoost Validation Score 0.5421052631578948\n"
     ]
    }
   ],
   "source": [
    "score[\"XGBoost\"] = {}\n",
    "score[\"XGBoost\"]['model'] = xgb_model\n",
    "score[\"XGBoost\"][\"Train Score\"] = xgb_model.score(X_train, y_train)\n",
    "score[\"XGBoost\"][\"Validation Score\"] = xgb_model.score(X_valid, y_valid)\n",
    "print(\"XGBoost Train Score: {}\".format(score[\"Random Forest\"][\"Train Score\"]))\n",
    "print(\"XGBoost Validation Score {}\".format(score[\"Random Forest\"][\"Validation Score\"]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Train Score</th>\n",
       "      <th>Validation Score</th>\n",
       "      <th>model</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>Logistic Regression</th>\n",
       "      <td>0.510877</td>\n",
       "      <td>0.526316</td>\n",
       "      <td>LogisticRegressionCV(Cs=10, class_weight=None,...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>LDA</th>\n",
       "      <td>0.524061</td>\n",
       "      <td>0.547368</td>\n",
       "      <td>LinearDiscriminantAnalysis(n_components=None, ...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>QDA</th>\n",
       "      <td>0.513514</td>\n",
       "      <td>0.405263</td>\n",
       "      <td>QuadraticDiscriminantAnalysis(priors=None, reg...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>Random Forest</th>\n",
       "      <td>0.581411</td>\n",
       "      <td>0.542105</td>\n",
       "      <td>RandomizedSearchCV(cv=5, error_score='raise-de...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>XGBoost</th>\n",
       "      <td>0.542518</td>\n",
       "      <td>0.55</td>\n",
       "      <td>RandomizedSearchCV(cv=5, error_score='raise-de...</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                    Train Score Validation Score  \\\n",
       "Logistic Regression    0.510877         0.526316   \n",
       "LDA                    0.524061         0.547368   \n",
       "QDA                    0.513514         0.405263   \n",
       "Random Forest          0.581411         0.542105   \n",
       "XGBoost                0.542518             0.55   \n",
       "\n",
       "                                                                 model  \n",
       "Logistic Regression  LogisticRegressionCV(Cs=10, class_weight=None,...  \n",
       "LDA                  LinearDiscriminantAnalysis(n_components=None, ...  \n",
       "QDA                  QuadraticDiscriminantAnalysis(priors=None, reg...  \n",
       "Random Forest        RandomizedSearchCV(cv=5, error_score='raise-de...  \n",
       "XGBoost              RandomizedSearchCV(cv=5, error_score='raise-de...  "
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_result = pd.DataFrame(score).T\n",
    "df_result"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "We choose the final model to be the one with the highest validation score, which is XGBoost in this case\n"
     ]
    }
   ],
   "source": [
    "model_name = df_result['Validation Score'].astype(float).argmax()\n",
    "print(\"We choose the final model to be the one with the highest validation score,\\\n",
    " which is {} in this case\".format(model_name))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "For the best Model, XGBoost, the test accuracy is 0.625\n"
     ]
    }
   ],
   "source": [
    "test_pred = predict_test_data(X_test, df_result.loc[model_name].model)\n",
    "test_score = accuracy_score(y_test, test_pred)\n",
    "print(\"For the best Model, {}, the test accuracy is {:.3f}\".format(model_name, test_score))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "It seems that our model with all the features is an improvement to the baseline model for the test set. However, the lower validation scores in general is a bit concerning. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Stacking"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "We saw that our models in general performed similarly in terms of train/validation. Why not try stacking the models together? We will stack the logistic regression, LDA, QDA, Random Forest, and XGBoost models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "def fit_stack_model(models, X_train, y_train): \n",
    "    predictions = []\n",
    "    for model in models:\n",
    "        predictions.append(model.predict(X_train))\n",
    "        \n",
    "    predictions = np.array(predictions).T\n",
    "    logit = LogisticRegression(C=1000).fit(predictions, y_train)\n",
    "    return logit\n",
    "    \n",
    "def stack_model_predict(models, stack_model, X, test = False):\n",
    "    predictions = []\n",
    "    for model in models:\n",
    "        predictions.append(model.predict(X))        \n",
    "    predictions = np.array(predictions).T\n",
    "    if not test:\n",
    "        return stack_model.predict(predictions)\n",
    "    else:\n",
    "        return stack_model.predict_proba(predictions)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Stacking Model Train Score: 0.5622940013183916\n",
      "Stacking Model Validation Score: 0.5394736842105263\n"
     ]
    }
   ],
   "source": [
    "models = df_result['model']\n",
    "stack_model = fit_stack_model(models, X_train, y_train)\n",
    "print(\"Stacking Model Train Score: {}\".format(accuracy_score(y_train, stack_model_predict(models, stack_model,\n",
    "                                                                                         X_train))))\n",
    "print(\"Stacking Model Validation Score: {}\".format(accuracy_score(y_valid, stack_model_predict(models, stack_model,\n",
    "                                                                                         X_valid))))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Stacking Model Test Score: 0.640625\n"
     ]
    }
   ],
   "source": [
    "stack_model_test_pred_prob = stack_model_predict(models, stack_model, X_test, True)\n",
    "stack_model_test_pred = [np.where(np.argsort(val) == 1)[0][0]-1 if (i >= 48) & (np.argmax(val) == 1)\n",
    "                       else np.argmax(val)-1 for i, val in enumerate(stack_model_test_pred_prob)]\n",
    "stack_model_test_acc = accuracy_score(y_test, stack_model_test_pred)\n",
    "print(\"Stacking Model Test Score: {}\".format(stack_model_test_acc))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "It seems that stacking in this case helps a bit, although we are not sure if the difference in test accuracies is due to luck. From the validation scores, we would have still chosen the model without stacking. \n",
    "\n",
    "We are a bit concerned about the fact that our features are collinear, which potentially affects our predictions. "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Principal Component Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [],
   "source": [
    "# scale data\n",
    "scaler = StandardScaler()\n",
    "scaler.fit(X_train)\n",
    "X_train_scaled = scaler.transform(X_train)\n",
    "X_valid_scaled = scaler.transform(X_valid)\n",
    "X_test_scaled = scaler.transform(X_test)\n",
    "\n",
    "# PCA on data\n",
    "pca = PCA().fit(X_train_scaled)\n",
    "X_train_pca = pca.transform(X_train_scaled)\n",
    "X_valid_pca = pca.transform(X_valid_scaled)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "pcr_train_score = []\n",
    "pcr_valid_score = []\n",
    "pcr_test_score = []\n",
    "\n",
    "for i in np.arange(1, X_train.shape[1]):\n",
    "    pca_cv = PCA(n_components=i).fit(X_train_scaled)\n",
    "    X_train_pca_cv = pca_cv.transform(X_train_scaled)\n",
    "    X_valid_pca_cv = pca_cv.transform(X_valid_scaled)\n",
    "    X_test_pca_cv = pca_cv.transform(X_test_scaled)\n",
    "    \n",
    "    pcr_cv_mod = LogisticRegressionCV(solver = 'lbfgs', \n",
    "                                      max_iter = 5000, \n",
    "                                      cv = 5, \n",
    "                                      multi_class='multinomial').fit(X_train_pca_cv, y_train)\n",
    "    \n",
    "    pcr_train_score.append(pcr_cv_mod.score(X_train_pca_cv, y_train))\n",
    "    pcr_valid_score.append(pcr_cv_mod.score(X_valid_pca_cv, y_valid))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAZAAAAEXCAYAAACDChKsAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDMuMC4yLCBodHRwOi8vbWF0cGxvdGxpYi5vcmcvOIA7rQAAIABJREFUeJzs3Xd8VfXdwPHPuSuDEMhiJJCEMH6EDQngQlFBWe7xOOuoj7tbnz6tbR2tHa7aR22tWmttRWvdTEUFlaWssPkxE0YChJBAQsZd5/nj3MQQMm6Se7P4vl8vX3LP/N6T5HzPbx7DNE2EEEKI5rK1dwBCCCE6J0kgQgghWkQSiBBCiBaRBCKEEKJFJIEIIYRoEUkgQgghWsTR3gGI0FFKOYG9QI7Wenp7x9NSSqlYYAHQE/il1vq9Fh7HBDYBPsAAvMDftNZ/Dqy/G+iptf69Uuoi4GXgEDAVmN/a8zcjzl8B67XWH9ZZng7sAjbWWmwAf9JavxrYJhJ4CJgVWGcH/gU8obU2ax3re8D/AWdqrVc2EktQx+vslFJ3AK7q3wXRMpJAupYrgRwgWymVqbXe2t4BtdAYoLfWelAIjnW+1voIgFIqEZirlIrSWj+ttX6x1nbXAS9rrX+jlDo3hOcPxgXAlgbWVWitx1R/UEqlAJuUUquxEssHwHasxFCplEoA5gExwC9rHedu4A3gh1jf9RRKKaMZx+vszsF6uBCtYMhAwq5DKbUEeAsYATi01ncHlt8O/ATrSfwIcIvWel99y4GBwPNa6xGBfSdXf1ZKPQKcCSQD6wP7/hXoDfQB8oBrtdaHlVJDAut6AX7gN8B+4E0gXWvtV0pFA7nAcK11YeB8CuuGlQLowPkuBh7GqnItBX6stf6mbjxa65vqXA8TSKpOIIFlZwHvBvZ5GEgMxP0zoAL4BhhZ5/xjgT8A3QLX6lGt9Vyl1K3AdwPLj2mtz1dKfRe4NxBrEXC/1nqbUuo14Hjg2P2BDcB3Atf8D0Bh4Hu9XyvWdGCT1jqmzvf6BngisM/rQIbW2ldr/eDANV5U62f4JpCFVaIZorXeRx1KqfOaOp5Sqh/wFyAdq4TyD631k4FYPwcWBc7jAH4F3AUMBVYD1wOpwBfAQmBi4Bj3a62/CpSgnwEuDFznr4Efaa1LlVK5wGuBdanA61rrXwbiuwT4BeACyoEHtNYrAr8f6UBfIA04ANwEnAH8Devn/Vvgs8DnyEA8r0jJJDjSBtJFKKWGYd3s/gP8A/iOUipBKTUa6wY1TWs9CvgIeKih5UGcKg0YG7hZXwes0FqfCWRg/fHeHNjuLeA/WuvhwAysP9SNwFFgWmCb64DPqpMHgNZaA3cAuwJP3mnAi8BVWuvRWDelDwPVXHXjCcZ6rGSXWOucTwa+/x+11lfUOX8k8HfgZq31OOAy4C9KqdTA7sOByYHkcR5WQpiktR6LdZOvSQhYN9ZpQCbWje0arfULWDfXB2snj4Yopc4EBmHdXLOBr2vf7APfZ0d18gi4F3hDa52PdZO/v4HDB3O8N4DFWuuRwNnATUqp6hLNAGCe1jobWAH8CStpDAcmYd24IZBEAtf3f4F/B5LHL7AS++jAfzbgyVqhxGitJwFnAQ8opQYEkttvgRmBa34n8J5Sqltgn0lY13kocAK4O3Cdq3/eLwAPAnO01llYv6vnKqXk3hgEqcLqOu4B5mqti4AipdQerD+mKuDj6idOrfWzAEqpHzewfHIT51mptfYG9vmTUmpS4FiDsUo+Xyul4rFuAK8EttuHVbJBKfUC8N9YbQx3Yf3xNuYCrCSzO3Csz5VSh7FuxifFE6TqIndFkNufifUE+4FVOKo5xqjAvzdorY8H/j0T6+a+vNa2cYHrAbBQa10FoJTaCFQvb0yUUion8G8HVknxxkAJ0k8TD4FKqT7A5Xx7vf4BvKiUekxrfaLO5o0eL3BTPhu4CEBrfSxQspoOrAQ8wJzA5ruA5dXXRimVj/V984FirfXswDEWKKV8WNdzOvCQ1toT2Oc5rCq1ah8G9jkQ+B2IxyrF9AU+q3XN/Vg/B4AltX4+66j/mr8PvK6UmgB8Cnxfa+1v6DqIb0kC6QICf9g3A1WBoj5ALNaT5hN8e9NEKRWF9dTubWC5iVWMr+aqc7qyWvv8AZgAvAosBpx821hNneMrrAb+N4DfKqXOx3qi/LKJr2evfZwAW+BcJ8UTpPHAHq11Wa0bTlPn36q1nli9QCmVjFV9dGOd89uBf2qtfxrYzob1RF0cWF87adW9zg05qQ2kjpXAD5VS9jpVTuOxboI3YyVrE5gT+L42rN+NW4C61TSNHg+rJFM35to/C3edhnZPA3HXTfg2rCqruj/r2seG+q+fHesB479qxdsfK1Fd0cA+JwlURw7G6jxxIfCwUipLa72/gfhFgBTTuoYbserbk7XW6VrrdKwqpRisnkRTlFJ9A9vehZVUFjewvBBIVUr1CjSq1tvgGnAx8KzW+p/AYaw/QHvgiW8N1k2q+g96GdBDa12O1avnVayqqaZ8BlyslMoIHOsCrDaEr4PY9ySBG/8fgKeasdtKYHCgYR2l1BhgB1YbSV0fA9fXuqZ3B+JvipeTb5RB0VqvALYBzwR6T6GU6g08B+xRStmxEsjd1b8XWutUrCqfHwR+vkEfT2tdinU97gus64HVjlO7uiwYSUqpaYFjXIKVaDZitYvco5RyBpLvfUEc+zPgIqXU0MDxZmC1L0U1sV/NNVdKzQb+S2v9FlaSPE6gxCwaJwmka7gHeKb2U6PWugSr2+YsrGqihUqp9Vh18HdrrTc2sHwLVuP3aqybxZ5GzvsY8JRSagNWnfJSvq06uAG4NnDsOcAdWuuDgXV/x2pcf72pLxaI516seu1NwO+BS7TWx5raN2CxUipHKbUmEOPrzWkgDbTPXAU8Gfgu/8RqD8mtZ9tPsBLUosA1uQG4Ujfd/fUj4HdKqVuCjauWq7CeqtcE4vsMq5PAw1g/extWqa+2P2K1A81o5vHAeli5MFAF9w3wHlbjdnNUAjcHjv8QcHngd/c3wEGsnoRbsW7wP2jsQIHfjzuBtwLH+zVwqda6qZLpAuBupdTPAvvcGNj/a6wqraZKxgLphSXaWOCp96dAmtb6nvaOR7SthnqWic5J2kBEW9sNFGD1ZhJCdGJSAhFCCNEi0gYihBCiRSSBCCGEaJGu1gYSgdXPvwCrX7kQQoim2bEGZK7CGnwclK6WQMYDX7V3EEII0UlNwuqOH5SulkAKAIqLT+D3n9o5ICEhhqKi5g5cbnudJU7oPLFKnKHVWeKEzhNre8ZpsxnExXWDwD00WF0tgfgA/H6z3gRSva4z6CxxQueJVeIMrc4SJ3SeWDtAnM2q+pdGdCGEEC0iCUQIIUSLSAIRQgjRIpJAhBBCtIgkECGEEC0iCUSI04xpysv2RGhIAhHiNOLetIgT//wBvuL89g5FdAGSQIQ4Tbi3LqFq+RuYlaW4c+a2dziiC5AEIsRpwLNjOVVf/QN7/1E4h1+Id+dK/McPt3dYopOTBCJEF+fZvYrKJS9jTx5K1NT7cY2ZBYYN9/oF7R2a6OQkgQjRhXn3rqfy8xex9RpI1MU/wHC4sHWLwznkHDz6K/zlJe0doujEJIEI0UV5D2yhYtFz2OL7ET39xxjOyJp1rjEzwPTh3rCwHSMUnV1YJ1NUSt0A/AJwAs9qrV+os/5h4HagOLDoZa31Cw0tD2esQnQlvoM7qPj4T9hiexM14wEMV/RJ622xvXAMPAPPlsVEjJmFERnTTpGKzixsCUQplQI8DmRhvaBkuVJqsdZ6S63NsoHrtNYr6uze0HIhRBN8hbmUL3gGo1tPomY+iC2ye73bucbMwrtzBe5Ni4jIvqKNoxRdQThLIFOAz7XWRwGUUu8AVwOP1domG/i5UioN+BJ4QGtd2cjysDFNE7PiOLboHuE8TZswfR7wVLXqqdL0VoHPixHRreXHqDoBhg3DFdXiY3QWpteN/+g+MBuZjtvmwJaYimGEr+bYd3Q/5fOfxIiIJnrm/2CL7tngtvb4FBzp43BvWoRr1LTT4uckQiucCSSZk19OUgBMqP6glIoB1gEPAjuB14BfKqV+V99y4KEwxor/0E7K5/yO6CsfxZ7QP5ynCrvKxS/j3beB6Jn/g71XRrP3958opnzO7zBsdqKv/g2Gzd7sY5h+P+UfPY6tRx+iLvp+s/fvTMyqE5TPfQJ/UV6T20ac8x1cwy4ITxx+P5WfvoBhdxI966fYYhKa3Mc1Zhbe3LW4tywmYsyMsMQluq5wJhAbUPtxzABq5lDQWpcBNb+xSqmngVe11g/Vt5xmJJCEhIafvJOS6i/O+7oNIg9wHcwhfuiwYE8VNg3F2RR34T5Kd38DNjuVC5+m702PEdE7Pej9fSeOkf/e05hlRZh+H9FHNhIzfFKzYy3bupyy4nyoKiMxMQbDMJr7VUKupde0Mf6qCgre/BP+4gMkzrgbR2xig9sWf/lvfBvmk3jOTAx7w396LY2zbOtyykoK6HXlT4gZODC4nZJGU7B+NO7Nn5Aw+XJszoigzxeO6xkunSXWzhJntXAmkP1Y79et1geomT9BKZUKTNFavxpYZACehpY358RFRWX1vtkrKak7hYWlDexlYO+rOL5lBb7hlzTndCHXeJyNq1j8NjhcRF/yMyo+eY78fz1C1CU/wx6X3OS+1pP07/GXHCZqxgNULfsXR754h/KkUQ1Wu9QXq2malH/xNgD+8uMcztuHrVtci75PqLTmmjbE9LqpWPAMvoM7iZx6H1X9sqhqZHvbqFlULfwjBSs+wanqT8otjbP6mtt69KE8fjgVzTnG8On49vyegmXzcQ2fEtQu4bie4dJZYm3POG02o9EH7wb3C0Ms1T4FLlRKJSmlooGrgNp9BiuAJ5RSA5RSBnAf8H4jy8POkT4Of3E+vpLOOU+Q/3gh3p0rcWaejz1pANEz/wcMg4p5TzQ56th0V1C+4Gn8xQVEXfQ9HMmZuMbMxF+8H1/e+mbF4du3AX/RPpxDz7XiOtJ01U5nY/o8VCx6Dl+BJvL8O3GmZzW5j73/KGwJqbhz5mH6QzuhYfU1d42ZiWFr3p+1va/C1nsQ7vULMP3ekMYlurawJRCt9QGsaqfFQA4wW2v9jVJqvlIqW2tdCNwFzAE0Vknj6YaWhyvO2hzp4wDw7lnbFqcLOff6+WDYcI2aBoCtZx+iZv4P+LyUz/0D/rKievczvVVUfPws/sJcIqfci6P/SAAcAydidE+iat0czMYah2sfyzSpWjcHIyaBiAnXAga+INoGOhPT76Pysxfx7dtIxLm34hx0RlD7GYaBa+ws/McO4s1dHbp4al1zx+Azm72/YRhEjL0Es6wI7w7p+CiCF9ZxIFrr2cDsOstm1Pr3u8C79exX7/Jws8UkYEvKwJu7hoixs9r69K3iLy/Bo7/COeSck6qL7PH9iJrxAOVz/0D5vCeIvuRnJ/XMMX0eKj55Dl/BdiIvuAtnIIkCGDY7rjEzqfrqNXz5W3GkNN025CvYhv/QTiLOvgkjMgajRy/8R/aG9su2I9Pvp3LJy9bvyFk34hp6XrP2d6RnY+vRB/e6uTgGjA9J29BJ19zWsj/p2qUjx+Czm12KEacn+S2pwzEgC3/hngaf1jsq94aFYPqsEcZ12JPSiZ7+Y8wTJVTMewqzsgwA0++l8tM/49u/ichzb6v3Sdo55GyM6J64180JLo51czGiYnEqq/rKnpDWZUogpmlStfQ1vDtX4ppwNa4RU5t9DMNms6oGi/bi27chJHHVveYtEa7SkejaJIHUUV2X7c3tPNVYZmUZni2LcQw8A1tsr3q3sfcZTNTFP8B//CDl85/ErCyzuvvmrSPi7Jtq2ivqMuxOXKOm48vfiu/Qzkbj8B3eje/AZpwjp2E4XADYElMxS49YY0I6MdM0qVoxG8+2L3GNvYSIMS0voToGn4kRk9CsqsGG1HfNWxxXrdJRa+MSp4ewVmF1RraefbDFpeDds6bZT5imuwLvntWNvvHNwMCeNgZbVGxrQ63h3rQIvFW4xsxsdDtHyjCipn6Pik/+j7J//xSqTuCacG2TPW+cmefhXjeHqnVziJ72o4bjyJkLrmhcw86vWWZPSAPAV7QXR3JmM75V2/FXHMe3d32jPzd/4R48W5fgHHkxruwrW3U+w+bANXo6Vcv+ha9A40ge2uJj1XfNWx6XVTqq/OJvuNe8j9HIOJLykr7Qc0iLzxXMNQ+V4wcicZeGdRxySLQ2TsOw4Ugf16rBv80lCaQejgFZuNfNwV9xvFk3+qpV7+LZ/GmT2znVuUSed3trQqxhuitwb1qEI30c9vh+TW7vSB1N5AV3U/n5X3GNuyyowWOGMxLnyKm4V7+Pr2gv9oTUU7bxHd2PN3ctrnGXnTSi2ZZoJRD/kTzooAmkatk/8e5e1eR2zmEXEHHGdSFpt3Cqc3Gv/Qh3ztwWJ5CGrnlrOAafibFuLu61HzW63UEg+tKHsPcZ3KLzBHvNQ6GxrtUdSSjijDQMnEPOCcGRgiMJpB6O9Czcaz/Cm7cu6EZSf/kxPNu+wDHoTCImXN3gdlUr3sSbtw7T72vRCO+63FsWg7vcesdDkJwZ43Gkjm5WlYdr+BTc6xfgXjeXqCn3nhpHzlxwRJxSarNFxWJE98TXQbvy+kry8e5ebZUsRl7U8IY2e6PTgjSX4XDhHDkN9zdv4zu8u0UzBrhz5tV7zVsVl81Bt6sfq2knq5ffR8WHv6YqZ26jJdKGBH3NQyQhIYaioka+TwfR6jgNW5uPt5IEUg9bQipG90Tr6S7IBOLZ9An4vUSMu6zRKSQcAyfi3bMa38Htra7SMb1uPBsXYk8Z3uwbUHPry42IbriGXYB7/QL8JQex9exTs85//DDeXV/jHHlxvfNv2RLT8Bd1zJ5Y7pz5YHfiGjMzpNWKwXANOx93zlzcOfOIuuh7zdrXuuYrG7zmrWE4IjBiGh+R3mPCLIq/eBPfkTzsgVJmsNr6mjtiu2OrCn6EfXvpLHHWJo3o9TAMA0d6Fr79mzHdFU1ub1adwL35MxwDxp90Y62Po/8osDvx7lnT6jg9+kvMiuO4xrbNyHnnyIvB7sC9ft5Jy90588Cw14w/qcuekIq/pADT626LMIPmLz2Cd8cKnJnntXnyADBcUbhGTMWbuwbf0QPN2repax5usdnTwRlpxdEM7X3NRWhJAmmAY0A2+L149zY9Ctu9+TPwVOIKYuyI4YzA0W8E3ty1rerpYvq9uNcvwNZ7EPa+qsXHaQ5bdA+cQ8/Fs315TTdn7/EiPNuX4lSTGqzisSWmgenHf3R/m8QZLPf6BWCAa9T0dovBNWIqOCKsKsAg+U8UN3nNw80e2Q3X8Avx7l6Fv+Rg0Pt1hGsuQkcSSAPsvQdiRMU22Z3X9FTi2fgJ9tTR9TYu18cxIBvzxFH8hXtaHJ93xwrMsiIixl7SphMVukZbje7V79Mu+fojMM2a5fWp6YnVgdpBrIGXX+Accja2mPh2i8OIjME57Hy8u75ucrqZau71C5q85m2hukRaFWQppKNccxE6kkAaUN0lzrt3faNVL56tSzCryohoRjWSI3U0GDa8uS2rxjL9ftw587AlpGLvP6pFx2gpW0wCjsFn4dn2Bb6jByhdtwjHoDOwxSY1uI/RPRFc0UFNd95WPBs/Ab8P1+jGuz63BdfIi8GwWVPRNMFfcRzPtiVNXvO2YIuKxTn0PLw7lgc18LYjXXMRGpJAGuEYkA3eKnwHNte73vR5cG9YiD05E3vvQUEf14iMwZ6ciWfPmhZVY3lzV+M/dhDX2FntMk16xJiZ4PNSMe8JTI+7yR5ghmFgT0jF10GmNDEry3Bv+RxHxkRsPXq3dzjYusXhVJPw6KV4jzd+I/ZsWgReT7N63YWTa7RVFdVU8uto11yEhvTCaoS971BwReHZsxZH2thT1nv0UszyElyT/7vZx3YMyKJq6ev4S/Kxx6UEvZ9pmrjXzcXWow+O9OxmnzcUbD374MgYj3f3N0SriUFNFW9LTMOz5fOQdV+u5i8vsbqEDpsc9DxQ37ZZdZwnYdfoGXi2fcHhj/4PX2zDvw8e/aU15ieIa94WbDEJOIecFRihf2mDb/TsiNdctJ6UQBph2B04UsfgzVuL6fedtM70+3Cvn48tKQN7EJMM1lWdkJrbG8uatntvi6btDiXXuMswevQhbtK1QW1vT0gFn6dZDa7BqFrxJlXL/0Xl4leCmiLd9FTi3vQJjrSx2OM7zpsnbbFJOEdMpapgF55tXzT4n2F34sq6rL3DPYlrzEzwe/Fs/Lje9R31movWkxJIExwDsvHuXGFNOVErUXh3fY1ZWkjEmde3qBrJ1i0OW+9B1qyu4y4Nap/WTtsdSvb4FGL+6/dEJHWHIF6CUzMivSgPe3zwJa7G+I8dxLv7G2zx/fDuWkmVw0XEubc2+s5xz9bF1hQuHXC25cgzryfp0js7xcuParP16INjwHjcWz63HmzqTKXRka+5aB0pgTTB0X8E2F0nNXibph93zlxscf1wpI1p8bGd6Vn4j+ThLy0MantfgcZ/aCeu0dNbPG13e7H17At2Z0h7Yrlz5oPNQdSMB3GNuxSP/pKq5bMbbFcyvW7c6xdiTxmGvVeQr3wVQXGNvQQ8lbjrTOUj17xrkwTSBMMRgaP/yMC4DauKxJu7Dn9xPq6xMxt92m2KY0Bg5t8gX2Dlzmn9tN3txbDZscX3C9mIdH9ZEZ4dy3AOPRdbdA9cWVfgHHkxns2f4l71Tr1JxLN9KWbFsQ7TAN2V2BP6Y08djXvjJ5iebycElGvetUkCCYJjQBbmiWL8hXusRuycuRixvXBkTGjVcW2xvbDF9w+qO6/v8G58+zeFZNru9mJPSMN3JC8kU4Vb7z/5dlyKYRhEnHEdzszzcefMO+X9JabPa7VZ9RqIvYNO6tjZRYy9BKpO4Nm6BKge7CrXvCuTBBIEa9yGHe+eNfgObMZfuAfX6Bkh6U3kGJCF7+AO/OXHGt0ulNN2txdbYiq4yzHLjrTqOP6K43i2foFj8FknzTtmGAYR59yMY/DZuFe/h3vDt426ZVuWYpYeIaKduj6fDuy9B2FPzsS9YSGm141359dyzbs4SSBBMCK6YU+xxm24183B6BaHc8jZITm2VY1l4s1b1+A2vqMHrIkdR0wN2bTd7aF60r3WjgfxbPwEfJ56p6I3DBuR592OI2M8VSvfxL1lMabpp2T5+9ji+2NPbXmblWiaa+wlmOUleLYvtdoJ5Zp3aZJAguRIz8I8fghfgcY1ahqG3RmS49ri+mHE9mq0GquhqdI7G1t8PzCMVo1Ir5m4MmO81TBfD8NmJ/L8u7CnjqZq6etULnkFz5H9Vg8heRIOK3tyJrakDKpWvIW/pECueRcnCSRIjvSxgIER2R3n0MkhO27NzL8HttT72teaabuHnR/yabvbmuGIwNazb6t6YlkD0iqafPuiYXcQNeU+7CmZeHcsxxHXp9VtVqJphmFYbSE+N0Zsb7nmXZwkkCDZonviGjOTiLNuwHCGds5+54As8PvqnfnXnTPfmrZ75MUhPWd7sSW0/N0gpqfq24krg3gHheFwEXXRD3Cqc0mcdme7Drw8ndjTRuMceh6RZ90g17yLk59uM0RMuBrnoNAP4LP1ysCI7nnKzL8nTdvdxm8aCxd7YqrVo63ieLP39WwLTFzZjC6hhjOCyPNuJzpjdLPPJ1rGMGxEnnub1flEdGmSQDqAmpl/923A9H77ZmSrq6q/3aftDiVbQvWI9OaVQkyfB/f6Bdj7Dm3xe7iFEKElCaSDsGb+dePdvwkAf2Upnq2LO8S03aFU/c6U5raDeLYvsyaulOkwhOgwwjofhlLqBuAXgBN4Vmv9Qp31DwO3A8WBRS/X3kYpNRN4Xms9IJxxdgT2vkMgops1Kn38ZKurqtfdZGNxZ2NExmDEJOBvRgIx/T7r/SdJA7CnDA9jdEKI5ghbAlFKpQCPA1lAFbBcKbVYa72l1mbZwHVa6xX17N8beAo4LfoAGjYHjrQxeHPX4Ssvxb35UxzpWc2a6r2zsCem4WtGFda3E1deJ11ChehAwlmFNQX4XGt9VGt9AngHuLrONtnAz5VSG5RSzyulImutewV4NIzxdTjO9Gxwl3P4gz+Cu8KaoK4LsiWkYR47dNKcSQ2xJq6chy0upd53sggh2k84q7CSgYJanwuAmk7hSqkYYB3wILATeA34JfCQUur7wFpgZUtOnJDQ8HiJpKTuLTlkm/D3nEje4kgq9qwnKmMMfYaNbO+QgtLca3oiQ3FojUmsr4jI5KGNb6u/pqz4AEmX/YDuvep/WVGwOvLPvjaJM/Q6S6ydJc5q4UwgNqD2rHkGUPPGH611GVDTvUgp9TTwqlLqTeAq4EKgX0tOXFRUht9/6oR9SUndO/y7Fuz9RuDdsxqGT+/wsULLrqnf2QuAop1bcUU2XEVnuiso/3w2RvckKpJGUdmK69EZfvYgcYZDZ4m1PeO02YxGH7wb3C8MsVTbD9Sea6IPkF/9QSmVqpS6vdZ6A/AA1wT2Ww3MB5KVUl+FMc4OxZV1GQlTb8PRV7V3KGFjdIvDiOze6JQmptdNxcd/wl+cT+TZN4b0NbhCiNAIZwnkU+ARpVQScAKrVHFnrfUVwBNKqcVALnAf8L7W+nfAwwBKqXRgidZ6Uhjj7FDs8f3poYZ1iiemljIMA1tCaoOTKpo+DxWLnsNXoIm84C4cMhmfEB1S2EogWusDwEPAYiAHmK21/kYpNV8pla21LgTuAuYAGqsE8nS44hEdiz0xDX/xfkyf96Tlpt9H5Wcv4tu3kYhzb8U56Ix2ilAI0ZSwjgPRWs8GZtdZNqPWv98F3m1k/1wgPUzhiXZkS0gFvw9/8YGaea1Mv5/KJS9b74k/60ZcQ89r5yiFEI2RkeiiXVQnjeopTUzTpGrpa3h3rsQ14epOP3W9EKcDSSCiXRg9eoMjouYVt1UrZuPZ9iWusZc0a7JEIUT7kQQi2oVh2LAl9MdftBf3qnfxbFqEc+TFuLKvbO/QhBBBCmsbiBCNsSek4dnyOb6D23FmTibiDJmqRIjOREodsH0hAAAgAElEQVQgot3Yk9IBE8fgs4g45zuSPIToZKQEItqNY+AEIu1OHBnjMQx5lhGis5EEItqN4YiQcR5CdGLy2CeEEKJFJIEIIYRoEUkgQgghWkQSiBBCiBaRBCKEEKJFJIEIIYRoEUkgQgghWkQSiBBCiBaRBCKEEKJFJIEIIYRoEUkgQgghWkQSiBBCiBaRBCKEEKJFJIEIIYRoEUkgQgghWkQSiBBCiBaRBCKEEKJFwvpGQqXUDcAvACfwrNb6hTrrHwZuB4oDi17WWr+glLoCeBSwA6uAO7XW7nDGKoQQonnClkCUUinA40AWUAUsV0ot1lpvqbVZNnCd1npFrf26Ac8D47TWh5RSbwG3Ai+FK1YhhBDNF84qrCnA51rro1rrE8A7wNV1tskGfq6U2qCUel4pFRnYNj2QPKKBXnxbQhFCCNFBNJlAlFIJLTx2MlBQ63MB0K/WcWOAdcCDwDigJ/BLAK21Ryk1HdgHJAKftDAGIYQQYRJMFdYWpdSnwF+01kubcWwbYNb6bAD+6g9a6zJgRvVnpdTTwKvAQ4H1C4AEpdRvgb8ANwR74oSEmAbXJSV1D/Yw7aqzxAmdJ1aJM7Q6S5zQeWLtLHFWCyaBpAPXAU8F2if+AvxTa13axH77gUm1PvcB8qs/KKVSgSla61cDiwzAo5SKB7K11tWljjeAfwcRZ42iojL8fvOU5UlJ3SksbCrs9tdZ4oTOE6vEGVqdJU7oPLG2Z5w2m9Hog3eD+zW1gda6Qmv9d631GcD3gAeAfKXUC01Ub30KXKiUSgq0ZVwFLKy1vgJ4Qik1QCllAPcB72Mlkn8FEgzANUBzSj5CCCHaQFCN6EqpaUqpd7FKAh8AZ2G1T3zY0D5a6wNY1VGLgRxgttb6G6XUfKVUtta6ELgLmANorMTxtNa6CLgTmKuUWg8o4Kct/YJCCCHCo8kqLKVUHlAE/Bm4SWtdEVi1USl1Z2P7aq1nA7PrLJtR69/vAu/Ws98HWIlKCCFEBxVMCeR64Fyt9SuAXynVq3qF1jojbJEJIYTo0IJJIP2wutsCpAGblVKXhC8kIYQQnUEwCeQh4HwArfV2rDEbj4YzKCGEEB1fMAnErrXeX/1Ba70vyP2EEEJ0YcGMAzmslLoL+BvWwMBbgENhjUoIIUSHF0xJ4i6sbrWVgf/uBO4NZ1BCCCE6viZLIFrrHUCWUioO8AYxAl0IIcRpIJhxIInAzUAMYCil7MAgrfWN4Q5OCCFExxVMG8jbWNOODAcWAVOBr8IZlBBCiI4vmDaQNK31TGA+1ouezgaGhjUqIYQQHV4wCeRg4P87gBGBOa6c4QtJCCFEZxBsN94HgRXAo0qp40B0eMMSQgjR0QXbjbcq8DKp1cBjyOy4Qghx2gumBPKU1vo7AFrrnyLJQwghBMGVQMYEXvgkhBBC1AimBJKPNQPvSqCseqHW+vthi0oIIUSHF0wCWRH4TwghhKgRzFQmMnW7EEKIUwQzlclGrFl4T6K1HhWWiIQQQnQKwVRh3V/r3y7gOmB3eMIRQgjRWQRThfVF7c9KqU+B5cDj4QpKdA1bco+yNa+40W2iIx1cPD4Vm006+onOxTRN8o+cYGteMcdOuBvdNtJl55yRfekRE9FG0bWNYEogdSUAyaEORHQtu/KP8ce31+M3TWxG/cnBNMFvmiQndGP0oMQ2jlCI5jtyrIKtucVszSs+KXHYDIMGfs0B8PlN5izLZUp2f6ZNTCUmqmvMBtXcNhADSAX+Gs6gROdWVuHhLx9sIq57BL+6dXyDfywer58fPvcVa7cXSgIR7eJYWRW78483uk2lx8f2fSVszS3mcEkFALHRTjLT48lMi2NYWhyJPaMaPcah4nI+XLqHBSvzWLzuANMmpjI1ux+RrpY8w3cczW0DMYFCrfXWMMUjOjm/afLSnM0cP+HmZzdlNfqk5XTYGDUwkXU7jnCL35RqLNGmDhWX8/t/rW2y+gmsKqihqXFcmNWPzPQ4UhK7YTRW5Kijd1w0d14ynBkT03j/q928/+VuPl29j1lnpjN5bDJOh701X6XdBJNAdgE/11rfq5RSwB+UUndpreW96OIU85bnsmn3UW6+aAgD+sY2uX3WkCS+3nKIHftLUKlxbRChEFZV1FNvrsPnN/nJdWOIiWz4QcduN+ibEI3dFszEHY3r1yuG7101il0HjvHel7t587MdfLxqL5eePYDzJ6RxrKyqxcc2bAax0a5Wx9gcwSSQ14CPAv/OA5YAfwdmNLWjUuoG4BdY078/q7V+oc76h4HbgeqW1pe11i8opS4DHsWqMtsD3Ka1brw1VrS7LblH+WDpHs4Y1pvJY1OC2mdERjwOu4012wslgYg2UVJWxVNv5VBR5ePB68eS1qd7m8cwMKUHD14/li25R3n3i928tmAbry3Y1urj3jErk7NG9A1BhMEJJoEkaq3/D0BrXQk8q5S6pamdlFIpWD21soAqYLlSarHWekutzbKB67TWK2rtFwv8BRivtT6glHoMeAT4QZDfSbSD4tIqXvpoM33io/nONBV08T7S5WDEgHjWbS/k+gsHN6taQIjmKi1389RbORwrc/PAdWPaJXnUNizQjrJ5z1EqfSalrSiB2AzavC0xmATiUEola63zAZRSvbFKBk2ZAnyutT4a2O8d4Gqs6eCrZQM/V0qlAV8CD2CVVu4LvLgKYAMg71/vwLw+Py9+uIlKj48HbxjX7IbBcUOSyNl5hLxDpaT3abraS4iWKK/08PS/cygsqeBH14xmYEqP9g4JAMMwGJGRQFJSdwoLS9s7nGYJ5i/9GSBHKbUQqxF9CvBgEPslAwW1PhcAE6o/KKVigHWBY+3Eqir7pdb6IeD9wDZRwP8CzwVxvhoJCTENrktKat8njmB1ljgBFq7az479x/jJjVmMyezT7P0vPCOC1xZuY+u+Y4wfGVzVV0t0lmsqcYZeTGwUT7y5jvwjJ3jotolkZ/Zu75Dq1ZmuKQQ3kPBVpdRq4ELACzyhtd4cxLFtnDwFigH4ax23jFrtKEqpp4FXgYcCn3tgJZL1Wut/BHG+GkVFZfj9p8y+0mkyfGeJE2DXoTLeW7KTyWNTGN6/R4vjVv17sjTnANPH9w9xhJbOck1Plzg37DrC+p1FZCTHMiw9nrju4RtgF9szml+9uIzt+45xz+XDSUuM7pDXuD1/9jab0eiDd0OCGQeSAtxdpxfW3Vrrg03suh+YVOtzH6yp4auPmwpM0Vq/GlhkAJ7Aur7Ax8DnwI+C/TKibR0uqeDZN9eS1qc71184qFXHGjckiTcWbaeg6AR9E7qFKELR0fj9Jh8s3cPc5bnYbQaL11k11X3io8lMt8ZUqNS4kA208/r8/P4fq9B7S7hj1jCyVK+QHFdYgqnC+gen9sJ6laZ7YX0KPKKUSgJOAFcBd9ZaXwE8oZRaDOQC9wHvK6XswBzgba31b4L7GqKtebx+/vz+RjAM7r18RKv7sVcnkLXbC5l5piSQrqiswsNLH21m056jTBrVlxunDuHg0XK25hWzJbeY5RsPsnjtAWu0cp/uDEuLIzM9jsH9ehLhbN7vl99vsvdwKXOW5bJuxxG+M01x5ojmV6+KxoWtF1agB9VDwGKsSRhf0Vp/o5SaD/xKa71aKXUXVrJwAUuBp4FLgXFYjfdXBw63Wmt9R3O/nAifr7ccYu+hMn52y3iSmhiFG4y47hEM6BvLGl3IzDPTWx+g6FDyDpbywvsbKSmr4pZpivPGWG1dqb27k9q7OxdPSMXr87M7/7g1TUjuUT5ZtY8FX+/FYTcYmNwjUEKJJ71vdxz2k8dkmKZZk4y25hazbW8xJyq9GMAdl43grEwpeYRDOHthobWeDcyus2xGrX+/C7xbZ7f3Ce5Vu6IdLd2QT++4KM4c2ZcjR8qa3iEIWSqJd5bsouhYJQk9IkNyTNH+lm0s4PWPNTFRTv73xiwykuvvaeew2xjSvydD+vfksnMGUOX2sX2/NYXIlryjfPjVHj74ag8RLjuqf0+GpcXRLcpZMy9VcanVBTYhNoKxg5PITI8jMy2OwQMSO2SbR1fQ3F5YYDWmB9MLS3RRB4+Ws33/Ma46LyOk4zbGDbESyNodhUzNDk9jumg7Hq+ftz7bweJ1B8hMi+Ouy4Y3a6R0hMvOyIwERmYkAFYV2La8YrYESigbdhUBEBPlZGhgTqrM9Dh69YyS8URtJNheWGuAC7B6Ye3EGtQ3u9EdRZe1bGMBhkHIR7z2iY8mJbEb67ZLAunoPF4/Hq+vwfXHyty8+NFmducfZ/rEVK48L6PVU4HERDnJHtqL7KFWddTR45WUV3pJTurW4IzPIryCHfG1F4gAfgzEAP8XtohEh+b3myzbWMDIjISwdL0cOySJeStyOV7ubvN5fUTTqksVS3IOYJ7aU/4kES47914+ouaGH2rxsZHEy7jTdtVoAgl02/0hcDNWT6koIF1rfSz8oYmOaNOeo5SUublxanjm28kaksTc5bnk7DjCuaPltTMdydHjlfz5g03szj/ORRPT6B7ZcM8om2EwdkgSfeKj2zBC0dYaTCBKqXlYU438G5gc6DW1R5LH6W3phnxiopxhm3MntXcMCbGRrN1eKAmkA9maV8yLH27C7fVz7+UjmD5poDRMi0ZLIOOANcAmrHYPOHlkuTjNlJa7WbfjCBeM63dKN8pQMQyDLJXE52v3U1HlJSqic79wp7MzTZOPv9nHO0t20Ts+ivuuGElyoozTEZbG7gL9seanuh4oUEr9B6sKS5ymVm4+hM9vMmlUeKeLHjckCa/PZOPuorCeRzSuosrLXz7czNuLdzJ2SCK/+E62JA9xkgYTiNbaq7V+W2t9PtaU7AVApFJqh1Lq7jaLUHQIpmny1YZ80vt0p1+v5s+Z0xyDUnoQG+1kjS4M63lEwwqKTvCb11ezRh/mmskDuffyEVIaFKcIqh5Ca71Fa/19IAV4kpOnJBGdjGma6L3FuD0Nd8OsK+9QKfsLT4S99AHWxG5jBiexYXdRo11FwXo50IZdRXh9/ka3C7f8IyfYvq+kXWMIlZwdR/j1P1ZTWu7hJ/81hulnpMm4ClGvZj1SaK3LgZcC/4lOavOeozzz9nomZPbirkuHB3VzWLqhAKfDxsRhbTMNdpZK4sv1+WzOLWZMPQ32ZRUeFqzM47M1+3F7/fTqGcVlkwYwMbN3m75b/XBJBR9+tYeVmw9iAtMmpnJVCMY8tJfi0ipe/HATfRO7cf8VI2VGANEoKZOehj5dsx+bYfDN1sMM7teTC7P6Nbq9x+tj5eZDZA1JIrqRd0eHUmZaHFERdtZuLzwpgVRUeVm0eh8ff7OXyiofZwzvw8iMeBZ8vZeX52xh/so8rpyUwZjBiWF9ai4urWLu8ly+XJ+PzWZw8cRUKqu8LPx6L3kHS5s96jpUKt1eDMNo9uSD1T74ajc+v8m9l4+Q5CGaJAnkNHO4uJyNu4qYdVY6eYdKeeuzHQzoG9vg/EQAa7cfobzKy9ltUH1VzWG3MXpgIjk7juDz+/H5TBavO8C8FXmUVXgYNySJyycNoF+S1R4zYVhvVm87zPtf7ua59zaSkRzLVedmkJkeH9K4yio8zA+UfPx+k3NHJzPrrPSaQZUDkmP558fbefTvq7jvipGNXtdQ25p7lBc/2kxij0h+fnNWs0tBBwrLWLqxgKnZ/UMyQabo+iSBnGY+X3sAm81g8tgUnA4bj/59FX/5YCMP3zahwXcwLN2QT0JsBJlpcW0a67ghSazccoh/f7aTNdsLKS6tYnh6HFeeN5ABfU++MdsMgwmZvclSSSzbeJCPlu3hybdyyEyL48rzMlr9preKKi+LVu3j41XflnwumzSAXnVutJNGJZPaqzvPv7eR37+xhhunDqmZeTZcTNNk4Td7eWfJLnp0c7GnoJRFq/YzbWJqs47zzpJdRLoczDorPTyBii5HEshppMrt46sNBWSppJon5nuvGMFv/7mGV+Zu4ftXjzplTqEjxyrYklvMJWent/l8QyMy4nE6bHy6Zj8DU2K5Y9awJpOY3Wbj3NHJnDm8N0ty8pm7PJfHX19DRvJOBveLJTMtniH9ezT53nbTNMkvKmdr7lG25lnTg1dU+cgKlHxSkhruiZbWpzsP3zaev360mX8s1OzOP85NFw1p9TtT6lNR5eXv87eyWheSrZK4bUYmL8/ZwgdLd5OlkoIuSWzLK2b9riKunjwwZC9zEl2fJJDTyIrNB6mo8p7U5jGgbyzXXTiYNxZtZ8HKvFPexbF8o9U4fM7Itqu+qhbpcnDP5SOwGQYjM+Kb1abhdNiZmt2fSaP6smRdPlv3lvDZmv18/M0+7DaDjORYMtPiGJYeT0ZyLA67jaJjlWzJO1ozPfixMjcAiT0iGT+0F+eNSTml5NOQmCgnP7pmNB8s3c3c5XnsPVzGfVeMILFH6KqGCopO8Px7Gzl4tJxrzx/ExRP6YxgGN100hIde+ZrXP9b8+NrRTV43v2ny9uKdxHWPYEoT7WFC1CYJ5DRhmiafrdlPau8YBqX0OGndBeNS2LG/hPe+3E1Gco+ap3y/abJ0YwGZaXEktlOdeH09sJoj0uVg2sRUbp41nP35Jezcf8xKErnFzFmWy0fLcolw2uke7eTIsUoAYqMD04Onx5OZFtfi9gCbzeDKc63qtlfmbuHRv68ipYmBeEkJ3cgIvI2vV1zD05Kv0Yf527ytOB02Hrhu7Ekls/jYSK4+byBvLNrOyi2HOHN442/iW73tMLkHS/nuzExcLWx8F6cnSSCnCb23hANHTnDbjKGn3JQMw+CWaUPZe6iMv360mUduG0/PmAj03hKOHKvkynMz2inq0Ipw2hk+IJ7hA6yG9ROVHvRe64VFJWVVTMnuz7C0OFKSuoW0B9fYwUn86pbxvLNkFycqPY1uq/OKWbY+H4D4QLvTsLR4MtPj6BkTgd9v8t6Xu5m/Mo8BfWO574oRxMee2lvq/LEprNx8kDc/3cGIAfF0b6BHmNfn590vdtEvqVuTiUaIuiSBnCY+W7OfmCgnEzPrH8cRFeHgvitG8OvXV/Pih5t58PoxLN2QT1SEg3FDkto42rbRLdLJuCFJbfL9esdHc9+VI5vcLjExhs3bD9e8NClnxxGWbTwIQN+EaCJddvYUlDJ5TDLXTxmC01F/TyubzeCW6UN59O+r+PfnO7lj1rB6t1u87gCFJZX86NrRbTp+RnQNkkBOA0XHKlm7o5BpE1MbraJISYrhOxcrXpm7ldmf7mC1LuTskX2lWqMNGYZB7/hoesdHc/7YFPymyb5DZWzNs17rerConNumD2VSEDMV90uKYfoZacxdnsuZw/vUlLyqlVd6mbMsl8y0OEYMCG13Z3F6kARyGli87gBgVWs05awRfdmx/xiL11r7tMXUJaJhNsMgrU930vp0b3a3XIBLzkpj1bbDvP7xNh777sSTBhgu+NoaU3PN+QNlqhLRIp1zvgURNI/Xx5fr8xkzKDHoHkA3TBnMgL7dGdA3lvQ+rRs/IdqX02Hn1mmKwpJKPly6p2b50eOVfLJqH2cM6016H3mtn2gZKYF0cV9vOUxZhadZ3TOdDjsP3ZyNx+eXJ9MuQKXGce7ovnzyzT4mZvYmrU93Pli6B9M0uaKLdJAQ7UNKIF1Yddfd5MRuDG3mKHKbreXzKYmO55rzBxET7eS1BdvYe6iUZRsLuGBcP5myRLSKJJAubFf+cfIOlXLhuBQpSZzmukU6uXHqEPIOlfLUWzkyZYkIibBWYSmlbgB+ATiBZ7XWL9RZ/zBwO1AcWPRy7W2UUq8Dn2utXwtnnF3VZ2v2ExXh4MwR0r9fQLZKYsygRHJ2HuEambJEhEDYEohSKgV4HOtthlXAcqXUYq31llqbZQPXaa1X1Nk3GfgrcCHwebhi7MpKyqpYve0wF4zr1+S8T+L0YBgGt04fyvJNB7kwK7wTPIrTQzjvLFOwSg9HAZRS7wBXA4/V2iYb+LlSKg34EnhAa10J3Ah8CMhLsevw+vy89dkOukU6GZYeR0Zyj3oHky1ZdwCf3+SCcXKjEN+K7eZqUXdgIeoTzgSSjPUe9WoFwITqD0qpGGAd8CCwE3gN+CXwkNb6ycA254Qxvk5pwco8Pl97AMOAOctzcTlsDO7fk2FpcQxNiyOtd3f8pskXOfmMzEigd3x0e4cshOiiwplAbIBZ67MB1Ly4WmtdBsyo/qyUehp4FXiotSdOSGh4qu3WvheirdQX5/7DpcxZnsfZo5O5/5oxbNp1hPU7Clm/4wj/WbILsGaB7d+7O8dOuLnygsFt8n078zXtiCTO0OsssXaWOKuFM4HsBybV+twHyK/+oJRKBaZorV8NLDKAxmeaC1JRURl+v3nK8qSk7hQWlobiFGFVX5x+0+SPs9fhcti4etIAKsoqGdg7hoG9Y7jynAGUlFWxLa84MIdSMel9utM/ISrs37czX9OOSOIMvc4Sa3vGabMZjT54NyScCeRT4BGlVBJwArgKuLPW+grgCaXUYiAXuA94P4zxdGpfrc9n+74Sbp0+lB4xEaes7xkTwRnD+3CGzKgqhGgjYRsHorU+gFUdtRjIAWZrrb9RSs1XSmVrrQuBu4A5gMYqgTwdrng6s5KyKt5evIuhqT1lbiohRIcR1v6dWuvZwOw6y2bU+ve7wLuN7H9r2ILrRGYv2o7H6+eWaae+y0MIIdqLjETv4NbtKGS1LuTSs9OlR5UQokORBNKBVVR5+dcn2+mX1E367gshOhxJIB3Yu1/soqS0ilumD8Vhlx+VEKJjkbtSB7XzgPVSpwuz+jEwuUd7hyOEEKeQBNIBebx+/rFgG3GxEfK+BiFEhyUJpAN6d/EODhw5wc0XKaIiZCJEIUTHJAmkgykoOsG/F21nQmYvRg9KbO9whBCiQZJAOpDi0iqe/c96oiIcXD9lSHuHI4QQjZL6kQ7ieLmbp95aR2m5h8fvOZseUfKjEUJ0bFIC6QBOVHp4+q0cio5V8sNrRjMktXnvLxdCiPYgCaSdVVR5+ePb6ykoOsH9V41kSP+e7R2SEEIERRJIO6ry+PjTOxvILSjlnstGMGJAQnuHJIQQQZME0k48Xj8vvLeRHftK+O9LhjF2SFJ7hySEEM0iCaQdeH1+XvxwE5v2HOXW6UOZOKx3e4ckhBDNJgmkjfn9Jq/O28q6HUe4YcpgJo1Obu+QhBCiRSSBtCHTNHn9422s3HKIq87LYEp2//YOSQghWkwSSBsxTZM3P93Bl+sLmHVWGjPPTG/vkIQQolUkgbSR977czadr9jM1uz9XTJIJEoUQnZ8kkDYwd3ku81bkcd6YZK67cJC8llYI0SXIfBlhtmjVPt77cjdnDO/NzRcpSR4i7EzTpLi4ELe7EjDDco7Dh234/f6wHDvUOkusbRGn3e4gJqYnUVHdQnI8SSBh9OX6fN78bAfjhiTx3ZmZ2GySPET4lZUdwzAMevfuh2GEp5LB4bDh9Xb8mzJ0nljDHadpmng8bkpKCgFCkkSkCitMVm4+yD8WbGNERjx3XTocu00utWgbFRVldO/eM2zJQ3ROhmHgckXQs2cSZWUlITmm/IaFwRpdyCtzt6JSe3L/FSNxOuQyi7bj9/uw26VyQdTP6XTh83lDciy5s4XYxt1FvPjhJgb07c73rhqFy2lv75DEaUja2kRDQvm7IQkkhHIPHuf59zaSktiNH107Wl5HK057Tz/9B2699QZuuukaJk8+g1tvvYFbb72BefM+CvoYr7zyIkuXftHoNrfeekNrQ62xe/dOzjknmyVLPgvZMbuqsN7hlFI3AL8AnMCzWusX6qx/GLgdKA4sellr/YJSagzwChALfAncrbUOTZkrjBZ+vReXw8aPrxtDdKSzvcMRot395Cc/BaCgIJ/vfe8uXnttdrOPcccddze5TUuO25B58z7i/POn8OGH7zF58oUhO25XFLYEopRKAR4HsoAqYLlSarHWekutzbKB67TWK+rs/i/gDq31SqXU34D/Bv4SrlhDoazCw9rthUwek0JstKu9wxGiw/vb3/7K5s2bOHz4IFdd9V+kpw/gpZf+TFVVJaWlZXz/+z9i0qTJPP74I4wdm8XYsVn8/OcPkJExkO3bNfHxCfz6178nNrYH55yTzdKlq/nb3/7KkSOF7Nu3l0OHDjJr1mV897v/jdfr5cknf8uGDTkkJfXCMAxuueW7jBuXfVJMXq+XTz5ZyAsvvMw999zOgQP7SUnpB8CqVV/z/PPPYpp++vTpy8MP/waHw8kzz/yBDRtycDgc3HrrHVx44UVcffUlPPfcX+nbN5m1a1fz6qsv8fzzL3H//XcSG9uDPXt28dhjv2PDhhwWLpxPZWUFTqeLRx75Damp6fWe68EHf8htt93B+PFnYJom119/Jc8//xKJie03k3c4SyBTgM+11kcBlFLvAFcDj9XaJhv4uVIqDauk8QDQG4jSWq8MbPMa8CgdPIF8veUQXp/JOaP6tncoQtRYtrGApRsKQn5cw4CzR/bl7JGt+313u6v417/+A8AvfvE//O///pK0tHTWrFnFn/70FJMmTT5p+507d/Czn/2KIUOG8tBDD/LJJwu4+urrTtnmz39+hbKyUq699nKuvfY65s2bQ2VlBbNnv8uhQwf5zndO3qfa8uVL6dOnD6mpaUyaNJkPP3yPe+/9Pm63m8ce+yXPPPMcgwcrXnzxeRYsmIvb7aaiooI33niH4uKj/OAH93Luuec3+p0HDhzEb3/7JCdOlPH883/i+ef/SkREJK+++lfeffdt7rvvh/Wea+bMS1m4cD7jx5/B+vXrSEnp367JA8KbQJKB2r+5BcCE6g9KqRhgHfAgsBMrUfwSmFvPfv2ac+KEhJgG1yUldW/OoYK2YsshBvbrQdaI0MyuG644w6GzxHq6xHn4sA1HoOef3W4QrvZ0u92oOU/T21rb1d7eZjMYMWJkzTcfmFAAABZHSURBVLJHH32cZcu+4osvPmPTpo1UVFTgcNgwDAObzcButxEXF8+wYcMAGDRoEGVlpTX7Oxw2bDaD7OzxREVFEBUVQY8esZSVlbJ69TdcdtkVOJ12+vVLYfz4CdjttlPiX7BgDhddNA2Hw8bUqRfzyCMPcc8995GXt5ukpF5kZmYCcP/93wfgJz/5PpdddhUul4PevXvx1lvvnPSdHQ4bdrv1Haq/y8iRo3A4bPToEcuvf/1bFi9exN69e1m5cjmDBw9p8FwVFRW89NKf8Xiq+PjjecyadUnQ178um80Wkr+HcCYQGycPgzWAmlEyWusyYEb1Z6XU08CrwPzG9gtGUVEZfv+pI3CTkrpTWFjanEMFJe9gKbsPHOPGqUNCcvxwxRkOnSXW/2/v3uNsKvcHjn/2zJiRmEvCkGvkcamUyzQMPyfiaEQX4pSokDhxTv069arTIbcoOunyi3KJFEdFOMoljHuK5Jrmm0K5jJjMmDC3PXv//lhrxh72MLbR3nt8369Xr8zaez3ru5/Zs7/7edZa3+dKitPlchXckBbfKJb4RrElEVoh+Te9FffGt7w863mez3e53JQpE16w7fHH+9G0aTN7uqo5I0b8C6fThdvtxuVyk5fnIjz8zPOtm7bPxOB0unC53ISFlfE4jgO3GxyOEJzOPI99rfY840lLO87GjRtITv6ejz76D263m4yMDFauXEGtWnUKxX/y5ElOnz5FSEgYLpe7YPvBgweoUiUWh8NRcLycnBzcbnfBa8mP79dfjzBkyON069aDuLiWVKxYkeTkZPKvbTr7WJUrVyE+vhUrVixn8+ZNPPnksz7feOhyuQq9z0JCHOf94l2Uy3kV1kHAc3wbCxzO/8EYU9MY09fjcQeQe6H9AtH6nSmEhTp0YSilfJSRcYIDB36mX7+BxMcnsG7dmhIt69G8eRwrVnyB2+0mNfUYW7duOedy1qVLF9OsWRzz5y9m7txFzJv3GX369GXBgnnUrFmL9PQ09u3bC8CsWe+zYME8brnlVpKSltvlY44zePAAcnNziIqKLnjuunXeryBLTt5N9eo16NmzFw0bNmL16lW4XHlFHgugc+euTJ48kfj4VkRERJRY//jqco5AVgDDjTGVgFNAN2CAx+OZwDhjzCpgP/AEMF9EfjbGZBljEkRkA9AbWHIZ47wkuU4XX313hKb1K1H+Kr3ySilfREZGcdddd9O7dw/CwsJo2rQFWVlZZGZmlkj7d999Hz/+uIc+fXpSseK1xMZWPecDeMmSRQwY8EShbffd14PZs2dy5EgKQ4eOZPToF3E6c6lWrTpDh44kLCyM118fzyOPPADAU089Q7lyV9Ov3wAmTBjP9OlTiIuL9xpTixbxzJ8/l4ceuh+3203Tps348ccfiYiI8HosgJtvvgWHw0FiYpcS6ZdL5XC7L0+xNSi4jPefQDgwVUTGGWMWA8NE5BtjTDesE+ThwHqsy3VzjDFNgClYl/F+CzwqItnFOGRtYN8fOYW1Ofkokxbs4n97NuHGOhVLpM1gmW6B4In1SorzyJGfiY2tVUIReRcs9aXAinXt2rW43W4SEtpw8uRJHn20F9OmzSQyMsrf4RW4UJ+63W727v2J0aOHMX36pV22fPZ7xGMKqw7WF/piuaz3gYjIbGD2WdsSPf49D5jnZb/teJxwD2TrdhzmmsgIGtW6xt+hKKWKULt2HUaNGsaUKdbFnP37Px5QyaM4Pv54NrNnf8CoUS/7O5QCeqv0JTiekcV3e4/TuVVtrbSrVACrVu06Jk2a5u8wLknPnr3o2bOXv8MoREuZXIINu47gBlrfVPJXuSilVKDTBOIjt9vNhh0pNKgZTeWYcv4ORyml/nCaQHz0w4F0jqZn6p3nSqkrliYQH63fkULZ8FCamcr+DkUppfxCE4gPMrOdbJajxDWsQoSu96GUukJpAvHB5uSj5OS6aKPTV0qd16BB/VixYlmhbZmZmSQmtic9vehlVQcPHsC3335DcvJuXn551DmPp6Qcpnv3899Mt3v3LiZOfBOA9evXMHXqOz68Au/eemsCd911Bzk5OSXWZjDSBOKDdTsOU7ViOa6vFunvUJQKaJ07d+WLL5YW2rZmTRJNmzYnOjr6gvs3aNCI554b6tOx9+/fR1racQBat25brHVFisPpdLJq1QpuvPFmVq9OKpE2g5XeB3KRDqee4qdDGfS4vZ4uG6rUBbRr14G3336DjIwTBTfuLVu2mB49rBUEk5JWMGfOh2RnZ5Obm8Pzzw/jppuaFOzvuZbGDz8kF4xG6tWrX/CcvXt/ZMKE8WRmZpKWdpzevR+hffs/M3XqO2RmZjJ9+lQqVqzE1q1beOGF4ezatZM33niVnJwcoqOjeeaZf1K9eg0GDx5Ao0aN2b59G+npaTz55DO0bJlwzmvauHE91apdR6dOnfnkkzl07NgJsK7MnDTpLdauXU1YWChdu95Hjx4PsGePMG7cGLKzs4iMjGLYsFEcPHig4HUBvPTScJo1a06TJk15+ukhREVFExERwUsvjWPs2FEcO3aU1NRjNG8eV5BQzz5Wq1at+dvfBjJ37iJCQkL49ttvmDVrJv/+95uX4Tdr0QRykTbsTCHE4aBlYy2cqAJf7g8byJW1Jd6uw+EgrH4bytQ/9wPWU7ly5WjTpi1JSSu4555upKYe45dffiYuLh6Xy8XChfMYN+51oqOj+eyzhXzwwQzGjZvgta3Ro19kyJCnaNEinhkzpvLtt98AsGjRQh5+uB/Nm8dx6NBBHnnkQe65pzv9+w9k69YtPPpof/7734UA5ObmMnz4Pxk16mUaNmxMUtIKhg9/galTZ9qPO3n33emsX7+WKVMmeU0gixcvol27DrRsmcCYMSPZt28vdepcz6pVK9m5czszZ87B6XTy17/2p337DowYMZRBg4aQkNCG+fPn8sknc7y2m++XX37mk0/eomrVaixfvpQbbqjP6NGvkJuby0MP3Y9IMocPH/J6rGrVrmPr1i00a9aCpUs/JzHxrmL9Pn2lU1gXwZnnYsOuI9xctyJR5f1fCVOpYJCY2KXgPMgXXyzhz39OJDQ0lJCQEMaMGc+mTRuZOvUdliz5jMzM017bSE9PJzU1lRYtrMKEd9555oNx8OAnycnJ4YMPpjNlyqQi2wA4cOBnKlSoQMOGjQFo1+4ODh48wMmTJwG47baWAFx/fV1+/z3jnP3T0o6zadNX3H77HURElCUhoQ0LF34KwLZtW2jXrgPh4eGUK1eOGTNmExoaxm+/pZKQ0AaAe+/tzhNP/P28/RUTcw1Vq1rrCnXo0IkWLW7j449nM2HCOE6cOEFm5mmvx6pY8Vo6d+7KsmWLycrKYsuWzbRu3fa8x7pUOgK5CLv2HifjVI6ePFdBo0z9hAuOEnxxMcUUb7mlKb/9lsqvvx5h2bIljBkzHoDTp0/z2GMP07HjnTRpcit169Zj3ryPvbbhcFhTRPlCQ898dA0b9hwVKkSSkNCG9u07nnPS3pO3IqvgxuXKAyA8PNw+ngNvhWaXLVuM2w2PPdYHwJ56y2XQoMGEhYUVWrwrJeUwFSpEFprqzs7OJjX12DnT306ns+DfnlWC586dw+rVSXTtei/du8exb99P9poi5x4rOjqG22+/g8mTJ7Jq1Qpatky47CXfdQRSDDm5eXy3/ziff7WfyHJluKluyVTdVepK0alTZ2bOfI/IyMiCNcYPHPgFh8NBnz59adq0OWvWrCpyDZCoqGhiY2P58sv1ACxffubE/ObNm+jffyBt2vyJr776EoC8vDxCQ0PJy8sr1E7NmrU4ceIE33//HQArVy6nSpWqxS6suGTJZ7zwwovMnbuIuXMXsXDhUiIjI1m5cjlNmjRl9eoknE4nWVlZPP30EI4f/41KlSqzaZO1QveyZYuZNu1doqKiOXz4ENnZ2WRknGD79q1ej7d589d07XofHTveSU5ODnv2/IDL5fJ6rGPHjlK2bFni41sxefJE7rzz8pd81xGIF3kuF/tTfmf3z2l8v/84Px7KwJnnIjTEQc929QgL1byr1MVITOxC9+5deP75YQXb6tW7gXr16vPgg90JCXEQF9eSHTu2FdnG0KGjGDt2BFOmTKRx45sLtvft+xiDBvUnIiKcunVvoGrVaqSkHKZhw8a8995k3n77TWrUsEqXh4eHM3LkWF57bRxZWZlERkYxcuTYYr2G5OTdpKen0bZtu4JtISEh9OjxAAsWzGPy5BkkJ++mb99euFxu7r//AWrWrMWwYaN49dWxTJz4JlFR0QwdOpJrr72Wli0T6N27B1WrVqNJk1u9HrNHjwd59dWxfPjhdK6+ujw33ngzKSmH6dLlHq/HAmjfviM7d26nceMbi/W6LsVlXQ/ED2rj43ogLpebNdsOsXPvceRAGpnZ1jeXGpXL07BWDI1qx3BD9Wiuirj8OTdY1q6A4In1SopT1wMpLFhiLYk48/LymDx5IjExMfzlLw8V+bygWA8kmBw4epIPv/iBStFXEdewCg1rxdCgVgyR5cL9HZpSShVL//69iYqK5pVXXvtDjqcJxFYrtgKTnm5LuJYmUUoFqUtdqfBi6WS+B00eSilVfJpAlCqFStm5TVWC3G4XUDJVNDSBKFXKhIWFc+pUhiYRVYjb7cbpzCU9PZXw8LIl0qaeA1GqlImJqURa2jFOniy62u2lCgkJKfKejUATLLH+EXGGhIRy1VXlKV++ePe9XIgmEKVKmdDQMK699vJWSwiWy6IheGINljg96RSWUkopn2gCUUop5ZPSNoUVCtZdlUU532OBJFjihOCJVeMsWcESJwRPrP6K0+O4F3UvQ2krZdIaWOfvIJRSKki1AdYX98mlLYFEAC2AFCDvAs9VSillCQWqApuB7OLuVNoSiFJKqT+InkRXSinlE00gSimlfKIJRCmllE80gSillPKJJhCllFI+0QSilFLKJ5pAlFJK+aS0lTLxyhjzIPAvoAzwuoi87eeQimSMWQVUBnLtTY+LyNd+DKkQY0wk8CVwl4jsN8bcAbwGXAV8JCL/8muANi9xTseqVHDKfsoIEZnvtwABY8yLQA/7x89F5NkA7k9vsQZin44EugNuYJqIvBaIfVpEnAHXnxdS6m8kNMZch3VrfjOsOyy/BB4Qkd1+DcwLY4wDOAjUEhGnv+M5mzHmNmAK0ACoD/wKCNAWOAB8jpWgl/gtSM6N004gO4GOIpLiz9jy2R9qI4DbsT5ElgJTgVcIvP70Fuv/ASMJrD5tC7wE/Anry+Ju4B5gEQHUp0XE2QmYSwD1Z3FcCVNYdwBJInJcRE5h/ZK6+zmmohj7/18YY7YbYwb7NZpzPQY8ARy2f44D9ojIPjvhfQjc76/gPBSK0xhTDqgJvGeM2WGMGWGM8fd7PwV4WkRyRCQX+B4rKQdif3qLtSYB1qcisga43e67ylgzLNEEWJ8WEWcmAdafxRHwAZaAalh/APlSgOp+iuVCYoCVwL1Ae2CgMaaDf0M6Q0T6i4hnscqA7FsvccYCSUBfIB6rYFw/f8SWT0S+E5GvAIwxN2BND7kIzP70FutSAqxPAUQk1xgzAutb/UoC9z16dpxlCMD+vJAr4RxICNawO58D6w814IjIRmBj/s/GmGlAIrDcb0GdX1D0rYjsxUrKABhj3gL6YE1z+ZUxpjHWtMozgBNrFJIvoPrTM1YREQK0T0XkRWPMK1hTV/UJ0PfoWXG2F5GA7M/zuRJGIAexqkzmi+XMFExAMca0Nsa099jk4MzJ9EAUFH1rjLnJGNPNY1NA9KsxJgHr2+dzIvI+AdyfZ8caiH1qjGlgjLkFQEROA59inWcIqD4tIs6egdafxXEljEBWAMONMZWwrm7oBgzwb0hFigZGGmNaYQ1pHwYG+jek8/oaMMaYesA+4EHgPf+G5JUDeN0YkwScxPr9v+/PgIwxNYAFQE8RSbI3B2R/FhFrwPUpcD0wwhjTGmvUcTfwLjA+wPrUW5xrCLz+vKBSPwIRkUPAC8AqYBswW0Q2+Tcq70TkM6wpgq3AFuA9e1orIIlIFvAIMA9rLjcZ6yKFgCIiO4CxwAasOLeJyH/8GxX/AMoCrxljthljtmH15SMEXn96i7UVAdanIrKYwn8/X4rIHAKsT4uIcyQB1p/FUeov41VKKXV5lPoRiFJKqctDE4hSSimfaAJRSinlE00gSimlfKIJRCmllE+uhPtAVClijKkN/ATs9NjsAN4Qkffs55TFunT7LvuxUKwaSONExO3R1hDgTaBlfqmOIo5ZrPaCnTGmPxAuIhP9HYsKDppAVDDKFJFb8n+wKy7vMsZ8g5VYFgA/YCWGLGNMRazr7ssDQz3aGQjMAp4E/uLtQHaF5OK2F+xaA7v8HYQKHppAVNATkUPGmD1YdY9igIZAZxHJsx//zRjTG6idv48x5k/ANcCzwE/GmBoicsBL8/9zofaMMdWBSfbPDuB9ERlvj5aSsGqZNcP6exsGPI5Vav4b4AGsKqxrsAoU3ma3MVhE1hljymCtZdEeyMO6W/0pEfndGLMfmGE/VhOYKSJD7Zi6YK2BEw6cBv4hIhuNMcPtOKsCtYBDwENYBfy6Ah2MMZlYZUumYd1A6ACm6shEnU3PgaigZ4xpCdTD+nBtDnyd/2GfT0T2iIhnUcq/ArNE5DDWh3xRpfOL094sYJWI3AQkAA8ZY/JHNHWwFmBqjlUo8w2spNEYq+JqvP28msAae2T1HPCRnTz+hVVRton9Xwgw3iOU8iLSBuvO8H8YY+rYFXPHAIkicitWWYxPjTFX2/u0Ae4XkQZY5X0G2gsX/ReYYC+49gywSESaYRX0/J9gKC+u/lj6hlDB6Kr8khrGmF1YJSB62SMIFxd4XxtjYrEWGsqvNfQ+8JjHB6yn87Zn75MAvA0gIiewRgV32k/Jxaq2Cta5my9FJMMuA3MYaxQEkCYis+02lmCNNm6223lHRHJFxAW85dE2wEJ7n0PAUbu9DlgjjJV22ZFZ9uuoZ++zWkQy7H9v9YjB03zgWWPMp8B9wN/s4ytVQKewVDAqdA7kLF8BTxpjQj1HDcaYFlgfgr2xFpxyA4uMMWAliEis4pVnT9Octz2skYzjrH1CsIphAuScdaK9qAqrZ69AGYKVREIpXI7cs22wFiLK5+bMSf6VItLTI94aWAnr3iL2KUREPrNHMh2wpsheNMY0E5GDRcSvrkA6AlGlil18Mhmr8F9ZAGNMFaxv7vuMMaFYCWSgiNS2/6uJNeXzd/ukebHbE5HfsZLME/ZjUVjrOFzsGi6VjDGd7Da6YCWanVjnRQYZY8rYU0hPFKPtlUBHY0wDu71EYAfWmuDn48ROTsaY2VjVd+dgJckMoO5FviZVymkCUaVRN6xv1VuMMduxPlDnAS9iXYobgjWt42kC1loRiRfZHkAvoL297vomrPUdZlxkzFlAb7v9F4B77BHPaOAIViXp77E+4P9+voZEZDfWeY85dnujgK4icvICMSzBWgXzeXufXvb+X2NNaa29yNekSjmtxquUn9lXa+0SkfL+jkWpi6EjEKWUUj7REYhSSimf6AhEKaWUTzSBKKWU8okmEKWUUj7RBKKUUsonmkCUUkr5RBOIUkopn/w/1aRXhVc6IP0AAAAASUVORK5CYII=\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(np.arange(1,len(pcr_train_score)+1), pcr_train_score, label='Training Accuracy')\n",
    "plt.plot(np.arange(1,len(pcr_valid_score)+1), pcr_valid_score, label='Validation Accuracy')\n",
    "\n",
    "\n",
    "plt.title('Accuracy for Different PCA Components')\n",
    "plt.xlabel('PCA Components')\n",
    "plt.ylabel('Accuracy')\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best Validation Accuracy Number of Components: 23\n"
     ]
    }
   ],
   "source": [
    "pca_best_com = np.argmax(pcr_valid_score)+1\n",
    "print('Best Validation Accuracy Number of Components: {}'.format(pca_best_com))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [],
   "source": [
    "# best mod with highest validation accuracy\n",
    "pca_best = PCA(n_components=pca_best_com).fit(X_train_scaled)\n",
    "X_train_pca_best = pca_best.transform(X_train_scaled)\n",
    "X_valid_pca_best = pca_best.transform(X_valid_scaled)\n",
    "\n",
    "# fit models\n",
    "pcr_best_mod = LogisticRegressionCV(solver = 'lbfgs', \n",
    "                                    max_iter = 5000, \n",
    "                                    cv = 5, \n",
    "                                    multi_class='multinomial').fit(X_train_pca_best, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PCR (Best) Train Score: 0.5108767303889256\n",
      "PCR (Best) Validation Score: 0.5526315789473685\n"
     ]
    }
   ],
   "source": [
    "# Best Validation Accuracy\n",
    "score[\"pcr_best\"] = {}\n",
    "score[\"pcr_best\"][\"model\"] = pcr_best_mod\n",
    "score[\"pcr_best\"][\"Train Score\"] = pcr_best_mod.score(X_train_pca_best, y_train)\n",
    "score[\"pcr_best\"][\"Validation Score\"] = pcr_best_mod.score(X_valid_pca_best, y_valid)\n",
    "print(\"PCR (Best) Train Score: {}\".format(score[\"pcr_best\"][\"Train Score\"]))\n",
    "print(\"PCR (Best) Validation Score: {}\".format(score[\"pcr_best\"][\"Validation Score\"]))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PCR (Best) Test Score: 0.65625\n"
     ]
    }
   ],
   "source": [
    "# test set\n",
    "X_test_pca_best = pca_best.transform(X_test_scaled)\n",
    "pcr_best_test_pred = predict_test_data(X_test_pca_best, pcr_best_mod)\n",
    "pcr_best_test_acc = accuracy_score(y_test, pcr_best_test_pred)\n",
    "print(\"PCR (Best) Test Score: {}\".format(pcr_best_test_acc))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Partial Least Squares"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [],
   "source": [
    "lb = LabelBinarizer()\n",
    "y_train_lb = lb.fit_transform(y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "plsda_train_score = []\n",
    "plsda_valid_score = []\n",
    "\n",
    "for i in np.arange(1, X_train.shape[1]):\n",
    "    plsda_mod = PLSRegression(n_components=i, scale=False) \n",
    "    plsda_mod.fit(X_train_scaled, y_train_lb)\n",
    "\n",
    "    plsda_train_score.append(accuracy_score(y_train, np.argmax(plsda_mod.predict(X_train_scaled), axis=1) - 1))\n",
    "    plsda_valid_score.append(accuracy_score(y_valid, np.argmax(plsda_mod.predict(X_valid_scaled), axis=1) - 1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "plt.plot(np.arange(1,len(plsda_train_score)+1), plsda_train_score, label='Training Accuracy')\n",
    "plt.plot(np.arange(1,len(plsda_valid_score)+1), plsda_valid_score, label='Validation Accuracy')\n",
    "\n",
    "plt.title('Accuracy for Different PLS-DA Components')\n",
    "plt.xlabel('PLS-DA Components')\n",
    "plt.ylabel('Accuracy')\n",
    "plt.legend();"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Best Validation Accuracy Number of Components: 12\n"
     ]
    }
   ],
   "source": [
    "plsda_best_com = np.argmax(plsda_valid_score)+1\n",
    "print('Best Validation Accuracy Number of Components: {}'.format(plsda_best_com))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [],
   "source": [
    "# check test accuracy\n",
    "plsda_best_mod = PLSRegression(n_components=plsda_best_com, scale=False) \n",
    "plsda_best_mod.fit(X_train_scaled, y_train_lb);"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PLS-DA (Best) Train Score: 0.5253790375741595\n",
      "PLS-DA (Best) Validation Score: 0.55\n"
     ]
    }
   ],
   "source": [
    "# Best Validation Accuracy\n",
    "score[\"plsda_best\"] = {}\n",
    "score[\"plsda_best\"][\"model\"] = plsda_best_mod\n",
    "score[\"plsda_best\"][\"Train Score\"] = accuracy_score(y_train, np.argmax(plsda_mod.predict(X_train_scaled), axis=1) - 1)\n",
    "score[\"plsda_best\"][\"Validation Score\"] = accuracy_score(y_valid, np.argmax(plsda_mod.predict(X_valid_scaled), axis=1) - 1)\n",
    "print(\"PLS-DA (Best) Train Score: {}\".format(score[\"plsda_best\"][\"Train Score\"]))\n",
    "print(\"PLS-DA (Best) Validation Score: {}\".format(score[\"plsda_best\"][\"Validation Score\"]))\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "PLS-DA (Best) Test Score: 0.671875\n"
     ]
    }
   ],
   "source": [
    "plsda_best_test_pred = [np.where(np.argsort(val) == 1)[0][0]-1 if (i >= 48) & (np.argmax(val) == 1)\n",
    "                       else np.argmax(val)-1 for i, val in enumerate(plsda_mod.predict(X_test_scaled))]\n",
    "\n",
    "print(\"PLS-DA (Best) Test Score: {}\".format(accuracy_score(y_test, plsda_best_test_pred)))"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
