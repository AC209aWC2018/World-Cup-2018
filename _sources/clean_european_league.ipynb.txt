{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import sqlite3\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "metadata": {},
   "outputs": [],
   "source": [
    "#Credit to CS207\n",
    "\n",
    "def viz_tables(cols, query):\n",
    "    q = cursor.execute(query).fetchall()\n",
    "    framelist = dict()\n",
    "    for i, col_name in enumerate(cols):\n",
    "        framelist[col_name] = [col[i] for col in q]\n",
    "    return pd.DataFrame.from_dict(framelist)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "metadata": {},
   "outputs": [],
   "source": [
    "db = sqlite3.connect('data/database.sqlite')\n",
    "cursor = db.cursor()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_cols = [col[1] for col in cursor.execute(\"PRAGMA table_info(Match)\")]\n",
    "player_cols = [col[1] for col in cursor.execute(\"PRAGMA table_info(Player)\")]\n",
    "player_attr_cols = [col[1] for col in cursor.execute(\"PRAGMA table_info(Player_Attributes)\")]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "metadata": {},
   "outputs": [],
   "source": [
    "query = '''SELECT * FROM Match'''\n",
    "match_df = viz_tables(match_cols, query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "metadata": {},
   "outputs": [],
   "source": [
    "query = '''SELECT * FROM Player'''\n",
    "player = viz_tables(player_cols, query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "metadata": {},
   "outputs": [],
   "source": [
    "query = '''SELECT * FROM Player_Attributes'''\n",
    "player_attr = viz_tables(player_attr_cols, query)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 327,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>player_fifa_api_id</th>\n",
       "      <th>player_api_id</th>\n",
       "      <th>date</th>\n",
       "      <th>overall_rating</th>\n",
       "      <th>potential</th>\n",
       "      <th>preferred_foot</th>\n",
       "      <th>attacking_work_rate</th>\n",
       "      <th>defensive_work_rate</th>\n",
       "      <th>crossing</th>\n",
       "      <th>...</th>\n",
       "      <th>vision</th>\n",
       "      <th>penalties</th>\n",
       "      <th>marking</th>\n",
       "      <th>standing_tackle</th>\n",
       "      <th>sliding_tackle</th>\n",
       "      <th>gk_diving</th>\n",
       "      <th>gk_handling</th>\n",
       "      <th>gk_kicking</th>\n",
       "      <th>gk_positioning</th>\n",
       "      <th>gk_reflexes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>218353</td>\n",
       "      <td>505942</td>\n",
       "      <td>2016-02-18 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>49.0</td>\n",
       "      <td>...</td>\n",
       "      <td>54.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>218353</td>\n",
       "      <td>505942</td>\n",
       "      <td>2015-11-19 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>49.0</td>\n",
       "      <td>...</td>\n",
       "      <td>54.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>218353</td>\n",
       "      <td>505942</td>\n",
       "      <td>2015-09-21 00:00:00</td>\n",
       "      <td>62.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>49.0</td>\n",
       "      <td>...</td>\n",
       "      <td>54.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>11.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>218353</td>\n",
       "      <td>505942</td>\n",
       "      <td>2015-03-20 00:00:00</td>\n",
       "      <td>61.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>53.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>218353</td>\n",
       "      <td>505942</td>\n",
       "      <td>2007-02-22 00:00:00</td>\n",
       "      <td>61.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>53.0</td>\n",
       "      <td>47.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>63.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>7.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>6</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2016-04-21 00:00:00</td>\n",
       "      <td>74.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>80.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>7</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2016-04-07 00:00:00</td>\n",
       "      <td>74.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>80.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>8</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2016-01-07 00:00:00</td>\n",
       "      <td>73.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>79.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2015-12-24 00:00:00</td>\n",
       "      <td>73.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>79.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>10</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2015-12-17 00:00:00</td>\n",
       "      <td>73.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>79.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>11</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2015-10-16 00:00:00</td>\n",
       "      <td>73.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>79.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2015-09-25 00:00:00</td>\n",
       "      <td>74.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>left</td>\n",
       "      <td>high</td>\n",
       "      <td>medium</td>\n",
       "      <td>79.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>13</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2015-09-21 00:00:00</td>\n",
       "      <td>73.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>79.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2015-01-09 00:00:00</td>\n",
       "      <td>71.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>78.0</td>\n",
       "      <td>...</td>\n",
       "      <td>64.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>15</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2014-12-05 00:00:00</td>\n",
       "      <td>71.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>78.0</td>\n",
       "      <td>...</td>\n",
       "      <td>64.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>16</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2014-11-07 00:00:00</td>\n",
       "      <td>71.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>78.0</td>\n",
       "      <td>...</td>\n",
       "      <td>64.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>17</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2014-09-18 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>64.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>18</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2014-05-02 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>64.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>19</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2014-04-04 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>64.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>20</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2014-03-14 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>61.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>21</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-12-13 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>61.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>22</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-11-08 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>61.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>23</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-10-04 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>24</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-09-20 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>25</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-05-03 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>26</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-03-22 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>27</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-03-15 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>28</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-02-22 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>29</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2013-02-15 00:00:00</td>\n",
       "      <td>69.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>58.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>30</td>\n",
       "      <td>189615</td>\n",
       "      <td>155782</td>\n",
       "      <td>2012-08-31 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>58.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183948</th>\n",
       "      <td>183949</td>\n",
       "      <td>164680</td>\n",
       "      <td>111182</td>\n",
       "      <td>2012-02-22 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>73.0</td>\n",
       "      <td>...</td>\n",
       "      <td>45.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183949</th>\n",
       "      <td>183950</td>\n",
       "      <td>164680</td>\n",
       "      <td>111182</td>\n",
       "      <td>2011-08-30 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>73.0</td>\n",
       "      <td>...</td>\n",
       "      <td>45.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183950</th>\n",
       "      <td>183951</td>\n",
       "      <td>164680</td>\n",
       "      <td>111182</td>\n",
       "      <td>2011-02-22 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>71.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>69.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183951</th>\n",
       "      <td>183952</td>\n",
       "      <td>164680</td>\n",
       "      <td>111182</td>\n",
       "      <td>2010-08-30 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>68.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183952</th>\n",
       "      <td>183953</td>\n",
       "      <td>164680</td>\n",
       "      <td>111182</td>\n",
       "      <td>2007-02-22 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>77.0</td>\n",
       "      <td>left</td>\n",
       "      <td>medium</td>\n",
       "      <td>medium</td>\n",
       "      <td>68.0</td>\n",
       "      <td>...</td>\n",
       "      <td>65.0</td>\n",
       "      <td>44.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>8.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183953</th>\n",
       "      <td>183954</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2011-02-22 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>67.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183954</th>\n",
       "      <td>183955</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2010-08-30 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>5.0</td>\n",
       "      <td>6.0</td>\n",
       "      <td>6.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183955</th>\n",
       "      <td>183956</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2009-08-30 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>21.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183956</th>\n",
       "      <td>183957</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2009-02-22 00:00:00</td>\n",
       "      <td>68.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>64.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>71.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>21.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183957</th>\n",
       "      <td>183958</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2008-08-30 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>21.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183958</th>\n",
       "      <td>183959</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2007-08-30 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>21.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183959</th>\n",
       "      <td>183960</td>\n",
       "      <td>111191</td>\n",
       "      <td>36491</td>\n",
       "      <td>2007-02-22 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>left</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>62.0</td>\n",
       "      <td>...</td>\n",
       "      <td>66.0</td>\n",
       "      <td>61.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>59.0</td>\n",
       "      <td>4.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>52.0</td>\n",
       "      <td>21.0</td>\n",
       "      <td>21.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183960</th>\n",
       "      <td>183961</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2011-02-22 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183961</th>\n",
       "      <td>183962</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2010-08-30 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>45.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>10.0</td>\n",
       "      <td>12.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183962</th>\n",
       "      <td>183963</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2010-02-22 00:00:00</td>\n",
       "      <td>67.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>66.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>25.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183963</th>\n",
       "      <td>183964</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2009-08-30 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>25.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183964</th>\n",
       "      <td>183965</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2009-02-22 00:00:00</td>\n",
       "      <td>70.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>74.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>25.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183965</th>\n",
       "      <td>183966</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2008-08-30 00:00:00</td>\n",
       "      <td>72.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>25.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183966</th>\n",
       "      <td>183967</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2007-08-30 00:00:00</td>\n",
       "      <td>75.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>51.0</td>\n",
       "      <td>25.0</td>\n",
       "      <td>25.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183967</th>\n",
       "      <td>183968</td>\n",
       "      <td>47058</td>\n",
       "      <td>35506</td>\n",
       "      <td>2007-02-22 00:00:00</td>\n",
       "      <td>78.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>right</td>\n",
       "      <td>None</td>\n",
       "      <td>_0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>...</td>\n",
       "      <td>63.0</td>\n",
       "      <td>72.0</td>\n",
       "      <td>79.0</td>\n",
       "      <td>84.0</td>\n",
       "      <td>65.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>48.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>11.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183968</th>\n",
       "      <td>183969</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2012-08-31 00:00:00</td>\n",
       "      <td>78.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>77.0</td>\n",
       "      <td>...</td>\n",
       "      <td>82.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183969</th>\n",
       "      <td>183970</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2012-02-22 00:00:00</td>\n",
       "      <td>81.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>80.0</td>\n",
       "      <td>...</td>\n",
       "      <td>87.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183970</th>\n",
       "      <td>183971</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2011-08-30 00:00:00</td>\n",
       "      <td>81.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>80.0</td>\n",
       "      <td>...</td>\n",
       "      <td>87.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183971</th>\n",
       "      <td>183972</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2011-02-22 00:00:00</td>\n",
       "      <td>81.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>81.0</td>\n",
       "      <td>...</td>\n",
       "      <td>87.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183972</th>\n",
       "      <td>183973</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2010-08-30 00:00:00</td>\n",
       "      <td>83.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>84.0</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>8.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183973</th>\n",
       "      <td>183974</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2009-08-30 00:00:00</td>\n",
       "      <td>83.0</td>\n",
       "      <td>85.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>84.0</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>83.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>84.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183974</th>\n",
       "      <td>183975</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2009-02-22 00:00:00</td>\n",
       "      <td>78.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>74.0</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183975</th>\n",
       "      <td>183976</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2008-08-30 00:00:00</td>\n",
       "      <td>77.0</td>\n",
       "      <td>80.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>74.0</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>70.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>31.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183976</th>\n",
       "      <td>183977</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2007-08-30 00:00:00</td>\n",
       "      <td>78.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>74.0</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>28.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>73.0</td>\n",
       "      <td>20.0</td>\n",
       "      <td>20.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>183977</th>\n",
       "      <td>183978</td>\n",
       "      <td>102359</td>\n",
       "      <td>39902</td>\n",
       "      <td>2007-02-22 00:00:00</td>\n",
       "      <td>80.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>right</td>\n",
       "      <td>medium</td>\n",
       "      <td>low</td>\n",
       "      <td>74.0</td>\n",
       "      <td>...</td>\n",
       "      <td>88.0</td>\n",
       "      <td>53.0</td>\n",
       "      <td>38.0</td>\n",
       "      <td>32.0</td>\n",
       "      <td>30.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>9.0</td>\n",
       "      <td>78.0</td>\n",
       "      <td>7.0</td>\n",
       "      <td>15.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>183978 rows  42 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            id  player_fifa_api_id  player_api_id                 date  \\\n",
       "0            1              218353         505942  2016-02-18 00:00:00   \n",
       "1            2              218353         505942  2015-11-19 00:00:00   \n",
       "2            3              218353         505942  2015-09-21 00:00:00   \n",
       "3            4              218353         505942  2015-03-20 00:00:00   \n",
       "4            5              218353         505942  2007-02-22 00:00:00   \n",
       "5            6              189615         155782  2016-04-21 00:00:00   \n",
       "6            7              189615         155782  2016-04-07 00:00:00   \n",
       "7            8              189615         155782  2016-01-07 00:00:00   \n",
       "8            9              189615         155782  2015-12-24 00:00:00   \n",
       "9           10              189615         155782  2015-12-17 00:00:00   \n",
       "10          11              189615         155782  2015-10-16 00:00:00   \n",
       "11          12              189615         155782  2015-09-25 00:00:00   \n",
       "12          13              189615         155782  2015-09-21 00:00:00   \n",
       "13          14              189615         155782  2015-01-09 00:00:00   \n",
       "14          15              189615         155782  2014-12-05 00:00:00   \n",
       "15          16              189615         155782  2014-11-07 00:00:00   \n",
       "16          17              189615         155782  2014-09-18 00:00:00   \n",
       "17          18              189615         155782  2014-05-02 00:00:00   \n",
       "18          19              189615         155782  2014-04-04 00:00:00   \n",
       "19          20              189615         155782  2014-03-14 00:00:00   \n",
       "20          21              189615         155782  2013-12-13 00:00:00   \n",
       "21          22              189615         155782  2013-11-08 00:00:00   \n",
       "22          23              189615         155782  2013-10-04 00:00:00   \n",
       "23          24              189615         155782  2013-09-20 00:00:00   \n",
       "24          25              189615         155782  2013-05-03 00:00:00   \n",
       "25          26              189615         155782  2013-03-22 00:00:00   \n",
       "26          27              189615         155782  2013-03-15 00:00:00   \n",
       "27          28              189615         155782  2013-02-22 00:00:00   \n",
       "28          29              189615         155782  2013-02-15 00:00:00   \n",
       "29          30              189615         155782  2012-08-31 00:00:00   \n",
       "...        ...                 ...            ...                  ...   \n",
       "183948  183949              164680         111182  2012-02-22 00:00:00   \n",
       "183949  183950              164680         111182  2011-08-30 00:00:00   \n",
       "183950  183951              164680         111182  2011-02-22 00:00:00   \n",
       "183951  183952              164680         111182  2010-08-30 00:00:00   \n",
       "183952  183953              164680         111182  2007-02-22 00:00:00   \n",
       "183953  183954              111191          36491  2011-02-22 00:00:00   \n",
       "183954  183955              111191          36491  2010-08-30 00:00:00   \n",
       "183955  183956              111191          36491  2009-08-30 00:00:00   \n",
       "183956  183957              111191          36491  2009-02-22 00:00:00   \n",
       "183957  183958              111191          36491  2008-08-30 00:00:00   \n",
       "183958  183959              111191          36491  2007-08-30 00:00:00   \n",
       "183959  183960              111191          36491  2007-02-22 00:00:00   \n",
       "183960  183961               47058          35506  2011-02-22 00:00:00   \n",
       "183961  183962               47058          35506  2010-08-30 00:00:00   \n",
       "183962  183963               47058          35506  2010-02-22 00:00:00   \n",
       "183963  183964               47058          35506  2009-08-30 00:00:00   \n",
       "183964  183965               47058          35506  2009-02-22 00:00:00   \n",
       "183965  183966               47058          35506  2008-08-30 00:00:00   \n",
       "183966  183967               47058          35506  2007-08-30 00:00:00   \n",
       "183967  183968               47058          35506  2007-02-22 00:00:00   \n",
       "183968  183969              102359          39902  2012-08-31 00:00:00   \n",
       "183969  183970              102359          39902  2012-02-22 00:00:00   \n",
       "183970  183971              102359          39902  2011-08-30 00:00:00   \n",
       "183971  183972              102359          39902  2011-02-22 00:00:00   \n",
       "183972  183973              102359          39902  2010-08-30 00:00:00   \n",
       "183973  183974              102359          39902  2009-08-30 00:00:00   \n",
       "183974  183975              102359          39902  2009-02-22 00:00:00   \n",
       "183975  183976              102359          39902  2008-08-30 00:00:00   \n",
       "183976  183977              102359          39902  2007-08-30 00:00:00   \n",
       "183977  183978              102359          39902  2007-02-22 00:00:00   \n",
       "\n",
       "        overall_rating  potential preferred_foot attacking_work_rate  \\\n",
       "0                 67.0       71.0          right              medium   \n",
       "1                 67.0       71.0          right              medium   \n",
       "2                 62.0       66.0          right              medium   \n",
       "3                 61.0       65.0          right              medium   \n",
       "4                 61.0       65.0          right              medium   \n",
       "5                 74.0       76.0           left                high   \n",
       "6                 74.0       76.0           left                high   \n",
       "7                 73.0       75.0           left                high   \n",
       "8                 73.0       75.0           left                high   \n",
       "9                 73.0       75.0           left                high   \n",
       "10                73.0       77.0           left                high   \n",
       "11                74.0       78.0           left                high   \n",
       "12                73.0       77.0           left              medium   \n",
       "13                71.0       75.0           left              medium   \n",
       "14                71.0       77.0           left              medium   \n",
       "15                71.0       77.0           left              medium   \n",
       "16                70.0       77.0           left              medium   \n",
       "17                70.0       79.0           left              medium   \n",
       "18                70.0       79.0           left              medium   \n",
       "19                70.0       79.0           left              medium   \n",
       "20                70.0       79.0           left              medium   \n",
       "21                70.0       79.0           left              medium   \n",
       "22                69.0       79.0           left              medium   \n",
       "23                69.0       79.0           left              medium   \n",
       "24                69.0       80.0           left              medium   \n",
       "25                69.0       80.0           left              medium   \n",
       "26                69.0       80.0           left              medium   \n",
       "27                69.0       80.0           left              medium   \n",
       "28                69.0       80.0           left              medium   \n",
       "29                68.0       80.0           left              medium   \n",
       "...                ...        ...            ...                 ...   \n",
       "183948            68.0       76.0           left              medium   \n",
       "183949            68.0       76.0           left              medium   \n",
       "183950            68.0       79.0           left              medium   \n",
       "183951            67.0       77.0           left              medium   \n",
       "183952            67.0       77.0           left              medium   \n",
       "183953            68.0       73.0           left                None   \n",
       "183954            68.0       73.0           left                None   \n",
       "183955            68.0       74.0           left                None   \n",
       "183956            68.0       74.0           left                None   \n",
       "183957            67.0       72.0           left                None   \n",
       "183958            67.0       72.0           left                None   \n",
       "183959            67.0       72.0           left                None   \n",
       "183960            67.0       78.0          right                None   \n",
       "183961            67.0       78.0          right                None   \n",
       "183962            67.0       78.0          right                None   \n",
       "183963            70.0       78.0          right                None   \n",
       "183964            70.0       78.0          right                None   \n",
       "183965            72.0       78.0          right                None   \n",
       "183966            75.0       78.0          right                None   \n",
       "183967            78.0       79.0          right                None   \n",
       "183968            78.0       78.0          right              medium   \n",
       "183969            81.0       81.0          right              medium   \n",
       "183970            81.0       81.0          right              medium   \n",
       "183971            81.0       85.0          right              medium   \n",
       "183972            83.0       85.0          right              medium   \n",
       "183973            83.0       85.0          right              medium   \n",
       "183974            78.0       80.0          right              medium   \n",
       "183975            77.0       80.0          right              medium   \n",
       "183976            78.0       81.0          right              medium   \n",
       "183977            80.0       81.0          right              medium   \n",
       "\n",
       "       defensive_work_rate  crossing     ...       vision  penalties  marking  \\\n",
       "0                   medium      49.0     ...         54.0       48.0     65.0   \n",
       "1                   medium      49.0     ...         54.0       48.0     65.0   \n",
       "2                   medium      49.0     ...         54.0       48.0     65.0   \n",
       "3                   medium      48.0     ...         53.0       47.0     62.0   \n",
       "4                   medium      48.0     ...         53.0       47.0     62.0   \n",
       "5                   medium      80.0     ...         66.0       59.0     76.0   \n",
       "6                   medium      80.0     ...         66.0       59.0     76.0   \n",
       "7                   medium      79.0     ...         65.0       59.0     76.0   \n",
       "8                   medium      79.0     ...         65.0       59.0     76.0   \n",
       "9                   medium      79.0     ...         65.0       59.0     76.0   \n",
       "10                  medium      79.0     ...         65.0       59.0     76.0   \n",
       "11                  medium      79.0     ...         65.0       59.0     76.0   \n",
       "12                  medium      79.0     ...         65.0       59.0     76.0   \n",
       "13                  medium      78.0     ...         64.0       58.0     73.0   \n",
       "14                  medium      78.0     ...         64.0       58.0     73.0   \n",
       "15                  medium      78.0     ...         64.0       58.0     73.0   \n",
       "16                  medium      77.0     ...         64.0       58.0     73.0   \n",
       "17                  medium      77.0     ...         64.0       58.0     73.0   \n",
       "18                  medium      77.0     ...         64.0       58.0     73.0   \n",
       "19                  medium      77.0     ...         61.0       58.0     73.0   \n",
       "20                  medium      77.0     ...         61.0       58.0     73.0   \n",
       "21                  medium      77.0     ...         61.0       58.0     73.0   \n",
       "22                  medium      77.0     ...         58.0       58.0     73.0   \n",
       "23                  medium      77.0     ...         58.0       58.0     73.0   \n",
       "24                  medium      77.0     ...         58.0       58.0     72.0   \n",
       "25                  medium      77.0     ...         58.0       58.0     72.0   \n",
       "26                  medium      77.0     ...         58.0       58.0     72.0   \n",
       "27                  medium      77.0     ...         58.0       58.0     72.0   \n",
       "28                  medium      77.0     ...         58.0       58.0     72.0   \n",
       "29                  medium      77.0     ...         63.0       58.0     72.0   \n",
       "...                    ...       ...     ...          ...        ...      ...   \n",
       "183948              medium      73.0     ...         45.0       53.0     64.0   \n",
       "183949              medium      73.0     ...         45.0       53.0     64.0   \n",
       "183950              medium      71.0     ...         65.0       53.0     71.0   \n",
       "183951              medium      68.0     ...         65.0       44.0     75.0   \n",
       "183952              medium      68.0     ...         65.0       44.0     75.0   \n",
       "183953                  _0      64.0     ...         66.0       61.0     67.0   \n",
       "183954                  _0      64.0     ...         66.0       61.0     71.0   \n",
       "183955                  _0      64.0     ...         66.0       61.0     71.0   \n",
       "183956                  _0      64.0     ...         66.0       61.0     71.0   \n",
       "183957                  _0      62.0     ...         66.0       61.0     61.0   \n",
       "183958                  _0      62.0     ...         66.0       61.0     43.0   \n",
       "183959                  _0      62.0     ...         66.0       61.0     43.0   \n",
       "183960                  _0      48.0     ...         63.0       45.0     65.0   \n",
       "183961                  _0      48.0     ...         63.0       45.0     65.0   \n",
       "183962                  _0      48.0     ...         63.0       70.0     65.0   \n",
       "183963                  _0      48.0     ...         63.0       70.0     70.0   \n",
       "183964                  _0      48.0     ...         63.0       70.0     70.0   \n",
       "183965                  _0      48.0     ...         63.0       70.0     76.0   \n",
       "183966                  _0      48.0     ...         63.0       70.0     76.0   \n",
       "183967                  _0      38.0     ...         63.0       72.0     79.0   \n",
       "183968                 low      77.0     ...         82.0       78.0     22.0   \n",
       "183969                 low      80.0     ...         87.0       78.0     22.0   \n",
       "183970                 low      80.0     ...         87.0       78.0     22.0   \n",
       "183971                 low      81.0     ...         87.0       73.0     22.0   \n",
       "183972                 low      84.0     ...         88.0       73.0     22.0   \n",
       "183973                 low      84.0     ...         88.0       83.0     22.0   \n",
       "183974                 low      74.0     ...         88.0       70.0     32.0   \n",
       "183975                 low      74.0     ...         88.0       70.0     32.0   \n",
       "183976                 low      74.0     ...         88.0       53.0     28.0   \n",
       "183977                 low      74.0     ...         88.0       53.0     38.0   \n",
       "\n",
       "        standing_tackle  sliding_tackle  gk_diving  gk_handling  gk_kicking  \\\n",
       "0                  69.0            69.0        6.0         11.0        10.0   \n",
       "1                  69.0            69.0        6.0         11.0        10.0   \n",
       "2                  66.0            69.0        6.0         11.0        10.0   \n",
       "3                  63.0            66.0        5.0         10.0         9.0   \n",
       "4                  63.0            66.0        5.0         10.0         9.0   \n",
       "5                  75.0            78.0       14.0          7.0         9.0   \n",
       "6                  75.0            78.0       14.0          7.0         9.0   \n",
       "7                  75.0            78.0       14.0          7.0         9.0   \n",
       "8                  75.0            78.0       14.0          7.0         9.0   \n",
       "9                  75.0            78.0       14.0          7.0         9.0   \n",
       "10                 75.0            78.0       14.0          7.0         9.0   \n",
       "11                 75.0            78.0       14.0          7.0         9.0   \n",
       "12                 75.0            78.0       14.0          7.0         9.0   \n",
       "13                 72.0            72.0       13.0          6.0         8.0   \n",
       "14                 72.0            72.0       13.0          6.0         8.0   \n",
       "15                 72.0            72.0       13.0          6.0         8.0   \n",
       "16                 72.0            72.0       13.0          6.0         8.0   \n",
       "17                 72.0            72.0       13.0          6.0         8.0   \n",
       "18                 72.0            72.0       13.0          6.0         8.0   \n",
       "19                 72.0            72.0       13.0          6.0         8.0   \n",
       "20                 72.0            72.0       13.0          6.0         8.0   \n",
       "21                 72.0            72.0       13.0          6.0         8.0   \n",
       "22                 72.0            72.0       13.0          6.0         8.0   \n",
       "23                 72.0            72.0       13.0          6.0         8.0   \n",
       "24                 72.0            72.0       13.0          6.0         8.0   \n",
       "25                 72.0            72.0       13.0          6.0         8.0   \n",
       "26                 72.0            72.0       13.0          6.0         8.0   \n",
       "27                 72.0            72.0       13.0          6.0         8.0   \n",
       "28                 72.0            72.0       13.0          6.0         8.0   \n",
       "29                 72.0            72.0       13.0          6.0         8.0   \n",
       "...                 ...             ...        ...          ...         ...   \n",
       "183948             68.0            66.0        9.0          8.0         5.0   \n",
       "183949             68.0            66.0        9.0          8.0         5.0   \n",
       "183950             69.0            69.0        9.0          8.0         5.0   \n",
       "183951             70.0            67.0        9.0          8.0         5.0   \n",
       "183952             70.0            67.0        9.0          8.0         5.0   \n",
       "183953             71.0            59.0       15.0         13.0         5.0   \n",
       "183954             71.0            59.0       15.0         13.0         5.0   \n",
       "183955             71.0            59.0        4.0         21.0        61.0   \n",
       "183956             71.0            59.0        4.0         21.0        61.0   \n",
       "183957             62.0            59.0        4.0         21.0        61.0   \n",
       "183958             52.0            59.0        4.0         21.0        52.0   \n",
       "183959             52.0            59.0        4.0         21.0        52.0   \n",
       "183960             66.0            65.0       14.0          7.0        15.0   \n",
       "183961             66.0            65.0       14.0          7.0        15.0   \n",
       "183962             66.0            65.0       14.0         25.0        51.0   \n",
       "183963             74.0            65.0       14.0         25.0        51.0   \n",
       "183964             74.0            65.0       14.0         25.0        51.0   \n",
       "183965             78.0            65.0       14.0         25.0        51.0   \n",
       "183966             78.0            65.0       14.0         25.0        51.0   \n",
       "183967             84.0            65.0       14.0          9.0        48.0   \n",
       "183968             31.0            30.0        9.0         13.0         8.0   \n",
       "183969             31.0            30.0        9.0         13.0         8.0   \n",
       "183970             31.0            30.0        9.0         13.0         8.0   \n",
       "183971             31.0            30.0        9.0         13.0         8.0   \n",
       "183972             31.0            30.0        9.0         13.0         8.0   \n",
       "183973             31.0            30.0        9.0         20.0        84.0   \n",
       "183974             31.0            30.0        9.0         20.0        73.0   \n",
       "183975             31.0            30.0        9.0         20.0        73.0   \n",
       "183976             32.0            30.0        9.0         20.0        73.0   \n",
       "183977             32.0            30.0        9.0          9.0        78.0   \n",
       "\n",
       "        gk_positioning  gk_reflexes  \n",
       "0                  8.0          8.0  \n",
       "1                  8.0          8.0  \n",
       "2                  8.0          8.0  \n",
       "3                  7.0          7.0  \n",
       "4                  7.0          7.0  \n",
       "5                  9.0         12.0  \n",
       "6                  9.0         12.0  \n",
       "7                  9.0         12.0  \n",
       "8                  9.0         12.0  \n",
       "9                  9.0         12.0  \n",
       "10                 9.0         12.0  \n",
       "11                 9.0         12.0  \n",
       "12                 9.0         12.0  \n",
       "13                 8.0         11.0  \n",
       "14                 8.0         11.0  \n",
       "15                 8.0         11.0  \n",
       "16                 8.0         11.0  \n",
       "17                 8.0         11.0  \n",
       "18                 8.0         11.0  \n",
       "19                 8.0         11.0  \n",
       "20                 8.0         11.0  \n",
       "21                 8.0         11.0  \n",
       "22                 8.0         11.0  \n",
       "23                 8.0         11.0  \n",
       "24                 8.0         11.0  \n",
       "25                 8.0         11.0  \n",
       "26                 8.0         11.0  \n",
       "27                 8.0         11.0  \n",
       "28                 8.0         11.0  \n",
       "29                 8.0         11.0  \n",
       "...                ...          ...  \n",
       "183948             5.0          8.0  \n",
       "183949             5.0          8.0  \n",
       "183950             5.0          8.0  \n",
       "183951             5.0          8.0  \n",
       "183952             5.0          8.0  \n",
       "183953             6.0          6.0  \n",
       "183954             6.0          6.0  \n",
       "183955            21.0         21.0  \n",
       "183956            21.0         21.0  \n",
       "183957            21.0         21.0  \n",
       "183958            21.0         21.0  \n",
       "183959            21.0         21.0  \n",
       "183960            10.0         12.0  \n",
       "183961            10.0         12.0  \n",
       "183962            25.0         25.0  \n",
       "183963            25.0         25.0  \n",
       "183964            25.0         25.0  \n",
       "183965            25.0         25.0  \n",
       "183966            25.0         25.0  \n",
       "183967             7.0         11.0  \n",
       "183968            15.0          5.0  \n",
       "183969            15.0          5.0  \n",
       "183970            15.0          5.0  \n",
       "183971            15.0          5.0  \n",
       "183972            15.0          5.0  \n",
       "183973            20.0         20.0  \n",
       "183974            20.0         20.0  \n",
       "183975            20.0         20.0  \n",
       "183976            20.0         20.0  \n",
       "183977             7.0         15.0  \n",
       "\n",
       "[183978 rows x 42 columns]"
      ]
     },
     "execution_count": 327,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "player_attr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "db.close()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "id\n",
      "country_id\n",
      "league_id\n",
      "season\n",
      "stage\n",
      "date\n",
      "match_api_id\n",
      "home_team_api_id\n",
      "away_team_api_id\n",
      "home_team_goal\n",
      "away_team_goal\n",
      "home_player_X1\n",
      "home_player_X2\n",
      "home_player_X3\n",
      "home_player_X4\n",
      "home_player_X5\n",
      "home_player_X6\n",
      "home_player_X7\n",
      "home_player_X8\n",
      "home_player_X9\n",
      "home_player_X10\n",
      "home_player_X11\n",
      "away_player_X1\n",
      "away_player_X2\n",
      "away_player_X3\n",
      "away_player_X4\n",
      "away_player_X5\n",
      "away_player_X6\n",
      "away_player_X7\n",
      "away_player_X8\n",
      "away_player_X9\n",
      "away_player_X10\n",
      "away_player_X11\n",
      "home_player_Y1\n",
      "home_player_Y2\n",
      "home_player_Y3\n",
      "home_player_Y4\n",
      "home_player_Y5\n",
      "home_player_Y6\n",
      "home_player_Y7\n",
      "home_player_Y8\n",
      "home_player_Y9\n",
      "home_player_Y10\n",
      "home_player_Y11\n",
      "away_player_Y1\n",
      "away_player_Y2\n",
      "away_player_Y3\n",
      "away_player_Y4\n",
      "away_player_Y5\n",
      "away_player_Y6\n",
      "away_player_Y7\n",
      "away_player_Y8\n",
      "away_player_Y9\n",
      "away_player_Y10\n",
      "away_player_Y11\n",
      "home_player_1\n",
      "home_player_2\n",
      "home_player_3\n",
      "home_player_4\n",
      "home_player_5\n",
      "home_player_6\n",
      "home_player_7\n",
      "home_player_8\n",
      "home_player_9\n",
      "home_player_10\n",
      "home_player_11\n",
      "away_player_1\n",
      "away_player_2\n",
      "away_player_3\n",
      "away_player_4\n",
      "away_player_5\n",
      "away_player_6\n",
      "away_player_7\n",
      "away_player_8\n",
      "away_player_9\n",
      "away_player_10\n",
      "away_player_11\n",
      "goal\n",
      "shoton\n",
      "shotoff\n",
      "foulcommit\n",
      "card\n",
      "cross\n",
      "corner\n",
      "possession\n",
      "B365H\n",
      "B365D\n",
      "B365A\n",
      "BWH\n",
      "BWD\n",
      "BWA\n",
      "IWH\n",
      "IWD\n",
      "IWA\n",
      "LBH\n",
      "LBD\n",
      "LBA\n",
      "PSH\n",
      "PSD\n",
      "PSA\n",
      "WHH\n",
      "WHD\n",
      "WHA\n",
      "SJH\n",
      "SJD\n",
      "SJA\n",
      "VCH\n",
      "VCD\n",
      "VCA\n",
      "GBH\n",
      "GBD\n",
      "GBA\n",
      "BSH\n",
      "BSD\n",
      "BSA\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "[None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None,\n",
       " None]"
      ]
     },
     "execution_count": 111,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "[print(column) for column in match_df.columns]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_df['home_win'] = (match_df.home_team_goal - match_df.away_team_goal > 0).astype(int)\n",
    "match_df.loc[match_df['home_team_goal'] == match_df['away_team_goal'], 'home_win'] = 2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "metadata": {},
   "outputs": [],
   "source": [
    "home_columns = ['home_player_{}'.format(i) for i in range(1, 12)]\n",
    "away_columns = ['away_player_{}'.format(i) for i in range(1, 12)]\n",
    "match = match_df[['date', 'home_win'] + home_columns + away_columns]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1    11917\n",
       "0     7466\n",
       "2     6596\n",
       "Name: home_win, dtype: int64"
      ]
     },
     "execution_count": 114,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "match['home_win'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['id', 'player_fifa_api_id', 'player_api_id', 'date', 'overall_rating',\n",
       "       'potential', 'preferred_foot', 'attacking_work_rate',\n",
       "       'defensive_work_rate', 'crossing', 'finishing', 'heading_accuracy',\n",
       "       'short_passing', 'volleys', 'dribbling', 'curve', 'free_kick_accuracy',\n",
       "       'long_passing', 'ball_control', 'acceleration', 'sprint_speed',\n",
       "       'agility', 'reactions', 'balance', 'shot_power', 'jumping', 'stamina',\n",
       "       'strength', 'long_shots', 'aggression', 'interceptions', 'positioning',\n",
       "       'vision', 'penalties', 'marking', 'standing_tackle', 'sliding_tackle',\n",
       "       'gk_diving', 'gk_handling', 'gk_kicking', 'gk_positioning',\n",
       "       'gk_reflexes'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#player_fifa_api_id refers to sofifa id. player_api_id is used as the columns in the match dataset.\n",
    "player_attr.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "metadata": {},
   "outputs": [],
   "source": [
    "columns = list(player_attr.columns.drop(['id', 'player_fifa_api_id', 'player_api_id', 'date']))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 328,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>overall_rating</th>\n",
       "      <th>potential</th>\n",
       "      <th>preferred_foot</th>\n",
       "      <th>attacking_work_rate</th>\n",
       "      <th>defensive_work_rate</th>\n",
       "      <th>crossing</th>\n",
       "      <th>finishing</th>\n",
       "      <th>heading_accuracy</th>\n",
       "      <th>short_passing</th>\n",
       "      <th>volleys</th>\n",
       "      <th>...</th>\n",
       "      <th>vision</th>\n",
       "      <th>penalties</th>\n",
       "      <th>marking</th>\n",
       "      <th>standing_tackle</th>\n",
       "      <th>sliding_tackle</th>\n",
       "      <th>gk_diving</th>\n",
       "      <th>gk_handling</th>\n",
       "      <th>gk_kicking</th>\n",
       "      <th>gk_positioning</th>\n",
       "      <th>gk_reflexes</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>119537</th>\n",
       "      <td>74.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>right</td>\n",
       "      <td>stoc</td>\n",
       "      <td>tocky</td>\n",
       "      <td>14.0</td>\n",
       "      <td>13.0</td>\n",
       "      <td>27.0</td>\n",
       "      <td>43.0</td>\n",
       "      <td>15.0</td>\n",
       "      <td>...</td>\n",
       "      <td>41.0</td>\n",
       "      <td>14.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>29.0</td>\n",
       "      <td>22.0</td>\n",
       "      <td>76.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>68.0</td>\n",
       "      <td>75.0</td>\n",
       "      <td>76.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows  38 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        overall_rating  potential preferred_foot attacking_work_rate  \\\n",
       "119537            74.0       75.0          right                stoc   \n",
       "\n",
       "       defensive_work_rate  crossing  finishing  heading_accuracy  \\\n",
       "119537               tocky      14.0       13.0              27.0   \n",
       "\n",
       "        short_passing  volleys     ...       vision  penalties  marking  \\\n",
       "119537           43.0     15.0     ...         41.0       14.0     29.0   \n",
       "\n",
       "        standing_tackle  sliding_tackle  gk_diving  gk_handling  gk_kicking  \\\n",
       "119537             29.0            22.0       76.0         75.0        68.0   \n",
       "\n",
       "        gk_positioning  gk_reflexes  \n",
       "119537            75.0         76.0  \n",
       "\n",
       "[1 rows x 38 columns]"
      ]
     },
     "execution_count": 328,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "get_latest_rating(match[['home_player_1', 'date']].loc[11110])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 174,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_latest_rating(player_match, columns = columns):\n",
    "    #Get row of latest rating\n",
    "    #player_match is a row in match with first column being player id and second column being the date of the match.\n",
    "    #Could have also just found latest date and merge based on (date, player_api_id)\n",
    "    player_api_id = player_match[0]\n",
    "    match_date = player_match[1]\n",
    "    if pd.isnull(player_api_id):\n",
    "        df = pd.DataFrame(columns = columns)\n",
    "        df.loc[0] = [None for column in columns]\n",
    "        return df\n",
    "    player = player_attr[(player_attr['player_api_id'] == player_api_id) & (player_attr['date'] < match_date)]\n",
    "    return player.loc[player.date == player.date.max(), columns]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_final_df = match.copy()\n",
    "for i in range(1, 12):\n",
    "    print(match_final_df.columns)\n",
    "    home_column_names = ['home_player_{}_'.format(i) + column for column in columns]\n",
    "    away_column_names = ['away_player_{}_'.format(i) + column for column in columns]\n",
    "    home_player_columns = []\n",
    "    away_player_columns = []\n",
    "    for j in range(len(match)):\n",
    "        print(j)\n",
    "        home_player_columns.append(get_latest_rating(match.iloc[j][['home_player_{}'.format(i), 'date']]))\n",
    "        away_player_columns.append(get_latest_rating(match.iloc[j][['away_player_{}'.format(i), 'date']]))\n",
    "    #https://stackoverflow.com/questions/30471101/pandas-convert-series-of-dataframes-to-single-dataframe\n",
    "    home_player_columns = pd.concat([r for r in home_player_columns], ignore_index=True)\n",
    "    home_player_columns.columns = home_column_names\n",
    "    away_player_columns = pd.concat([r for r in away_player_columns], ignore_index=True)  \n",
    "    away_player_columns.columns = away_column_names\n",
    "    match_final_df = match_final_df.merge(home_player_columns, left_index= True, right_index = True)\n",
    "    match_final_df = match_final_df.merge(away_player_columns, left_index= True, right_index = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_final_df.drop(home_columns + away_columns, axis = 1).to_csv(\"data/cleaned/european_matches.csv\", index = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 216,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>date</th>\n",
       "      <th>home_team_api_id</th>\n",
       "      <th>away_team_api_id</th>\n",
       "      <th>home_win</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>24558</th>\n",
       "      <td>2008-07-18 00:00:00</td>\n",
       "      <td>10192</td>\n",
       "      <td>9931</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24559</th>\n",
       "      <td>2008-07-19 00:00:00</td>\n",
       "      <td>9930</td>\n",
       "      <td>10179</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24560</th>\n",
       "      <td>2008-07-20 00:00:00</td>\n",
       "      <td>10199</td>\n",
       "      <td>9824</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24561</th>\n",
       "      <td>2008-07-20 00:00:00</td>\n",
       "      <td>7955</td>\n",
       "      <td>10243</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24613</th>\n",
       "      <td>2008-07-23 00:00:00</td>\n",
       "      <td>6493</td>\n",
       "      <td>7955</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "                      date  home_team_api_id  away_team_api_id  home_win\n",
       "24558  2008-07-18 00:00:00             10192              9931         0\n",
       "24559  2008-07-19 00:00:00              9930             10179         1\n",
       "24560  2008-07-20 00:00:00             10199              9824         0\n",
       "24561  2008-07-20 00:00:00              7955             10243         0\n",
       "24613  2008-07-23 00:00:00              6493              7955         0"
      ]
     },
     "execution_count": 216,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "match_sorted_date = match_df[['date', 'home_team_api_id', 'away_team_api_id', 'home_win']].sort_values('date')\n",
    "match_sorted_date.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 299,
   "metadata": {},
   "outputs": [],
   "source": [
    "def get_wins_in_last_matches(df_row, df, num_games, team_id_col = ['home_team_api_id', 'away_team_api_id'],\n",
    "                            against_each_other = False):\n",
    "    \"\"\"\n",
    "    Get number of wins for home team and away team for num_games before current game. If against_each_other\n",
    "    is True, get number of wins home team has against away team had in past num_games.\n",
    "    \"\"\"\n",
    "\n",
    "    home_team_id_colname = team_id_col[0]\n",
    "    away_team_id_colname = team_id_col[1]\n",
    "    if not against_each_other:\n",
    "\n",
    "        #Get past games for both home and away teams.\n",
    "        home_past_games = df[((df[home_team_id_colname] == df_row[home_team_id_colname])\\\n",
    "                            | (df[away_team_id_colname] == df_row[home_team_id_colname]))\\\n",
    "                             & (df.date < df_row.date)][-num_games:]\n",
    "        away_past_games = df[((df[home_team_id_colname]== df_row[away_team_id_colname])\\\n",
    "                            | (df[away_team_id_colname] == df_row[away_team_id_colname]))\\\n",
    "                             & (df.date < df_row.date)][-num_games:]\n",
    "        #if not enough games played, give indicator\n",
    "        if len(home_past_games) < num_games:\n",
    "            home_not_enough = 1\n",
    "        else:\n",
    "            home_not_enough = 0\n",
    "        if len(away_past_games) < num_games:\n",
    "            away_not_enough = 1\n",
    "        else:\n",
    "            away_not_enough = 0\n",
    "\n",
    "        #get number of wins for home team \n",
    "        home_wins = 0\n",
    "        for index, game in home_past_games.iterrows():\n",
    "            if game[home_team_id_colname] == df_row[home_team_id_colname] and game.home_win == 1:\n",
    "                home_wins += 1\n",
    "            elif game[away_team_id_colname] == df_row[home_team_id_colname] and game.home_win == 0:\n",
    "                home_wins += 1\n",
    "\n",
    "        #get number of wins for away team         \n",
    "        away_wins = 0\n",
    "        for index, game in away_past_games.iterrows():\n",
    "            if game[home_team_id_colname] == df_row[away_team_id_colname] and game.home_win == 1:\n",
    "                away_wins += 1\n",
    "            elif game[away_team_id_colname] == df_row[away_team_id_colname] and game.home_win == 0:\n",
    "                away_wins += 1\n",
    "        return (home_wins, away_wins, home_not_enough, away_not_enough)\n",
    "    else:\n",
    "        #get past games where the two teams played against each other\n",
    "        past_games = df[(((df[home_team_id_colname] == df_row[home_team_id_colname])\\\n",
    "                            & (df[away_team_id_colname] == df_row[away_team_id_colname]))\\\n",
    "                        | ((df[home_team_id_colname] == df_row[away_team_id_colname])\n",
    "                        & (df[away_team_id_colname] == df_row[home_team_id_colname])))\n",
    "                        & (df.date < df_row.date)][-num_games:]\n",
    "        #if not enough games played, give indicator\n",
    "        if len(past_games) < num_games:\n",
    "            not_enough = 1\n",
    "        else:\n",
    "            not_enough = 0\n",
    "        wins = 0\n",
    "        for index, game in past_games.iterrows():\n",
    "            #home team wins in past game against away team as home team\n",
    "            if game[home_team_id_colname] == df_row[home_team_id_colname] and game.home_win == 1:\n",
    "                wins += 1\n",
    "            #home team wins in past game against away team as away team\n",
    "            elif game[away_team_id_colname] == df_row[home_team_id_colname] and game.home_win == 0:\n",
    "                wins += 1\n",
    "        return (wins, not_enough)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 253,
   "metadata": {},
   "outputs": [],
   "source": [
    "wins_past_x_games = {}\n",
    "for index, row in match_sorted_date.iterrows():\n",
    "    for i in range(1, 6):\n",
    "        if i not in wins_past_x_games.keys():\n",
    "            wins_past_x_games[i] = []\n",
    "        wins_past_x_games[i].append(get_wins_in_last_matches(row, match_sorted_date, i))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 271,
   "metadata": {},
   "outputs": [],
   "source": [
    "win_past_x_games_df = pd.DataFrame(index = match_sorted_date.index)\n",
    "for i in range(1, 6):\n",
    "    win_past_x_games_df = win_past_x_games_df.merge(\n",
    "            pd.DataFrame(wins_past_x_games[i], index = match_sorted_date.index,\\\n",
    "             columns = ['home_wins_past_{}_games'.format(i), 'away_wins_past_{}_games'.format(i), \\\n",
    "                        'home_not_enough_past_games_{}'.format(i), 'away_not_enough_past_games_{}'.format(i)]),\\\n",
    "                        left_index = True, right_index = True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 294,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_final_df = match_final_df.merge(win_past_x_games_df, left_index = True, right_index = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 295,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_final_df.drop(home_columns + away_columns, axis = 1).to_csv(\"data/cleaned/european_matches.csv\", index = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 300,
   "metadata": {},
   "outputs": [],
   "source": [
    "wins_against_past_x_games = {}\n",
    "for index, row in match_sorted_date.iterrows():\n",
    "    for i in range(1, 6):\n",
    "        if i not in wins_against_past_x_games.keys():\n",
    "            wins_against_past_x_games[i] = []\n",
    "        wins_against_past_x_games[i].append(get_wins_in_last_matches(row, match_sorted_date, i,\\\n",
    "                                                                     against_each_other=True))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 304,
   "metadata": {},
   "outputs": [],
   "source": [
    "win_against_past_x_games_df = pd.DataFrame(index = match_sorted_date.index)\n",
    "for i in range(1, 6):\n",
    "    win_against_past_x_games_df = win_against_past_x_games_df.merge(\n",
    "            pd.DataFrame(wins_against_past_x_games[i], index = match_sorted_date.index,\\\n",
    "             columns = ['wins_past_{}_games'.format(i), 'not_enough_past_games_{}'.format(i),]),\\\n",
    "                        left_index = True, right_index = True)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 307,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_final_df = match_final_df.merge(win_against_past_x_games_df, left_index = True, right_index = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 308,
   "metadata": {},
   "outputs": [],
   "source": [
    "match_final_df.drop(home_columns + away_columns, axis = 1).to_csv(\"data/cleaned/european_matches.csv\", index = False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 321,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "home_player_1     0\n",
       "home_player_2     0\n",
       "home_player_3     0\n",
       "home_player_4     0\n",
       "home_player_5     0\n",
       "home_player_6     0\n",
       "home_player_7     0\n",
       "home_player_8     0\n",
       "home_player_9     0\n",
       "home_player_10    0\n",
       "home_player_11    0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 321,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "(match_df[['home_player_{}'.format(i) for i in range(1, 12)]] == 158023).sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 326,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>player_api_id</th>\n",
       "      <th>player_name</th>\n",
       "      <th>player_fifa_api_id</th>\n",
       "      <th>birthday</th>\n",
       "      <th>height</th>\n",
       "      <th>weight</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6169</th>\n",
       "      <td>6176</td>\n",
       "      <td>30981</td>\n",
       "      <td>Lionel Messi</td>\n",
       "      <td>158023</td>\n",
       "      <td>1987-06-24 00:00:00</td>\n",
       "      <td>170.18</td>\n",
       "      <td>159</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        id  player_api_id   player_name  player_fifa_api_id  \\\n",
       "6169  6176          30981  Lionel Messi              158023   \n",
       "\n",
       "                 birthday  height  weight  \n",
       "6169  1987-06-24 00:00:00  170.18     159  "
      ]
     },
     "execution_count": 326,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "player[player.player_name.str.contains('Messi')]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 344,
   "metadata": {},
   "outputs": [],
   "source": [
    "sofifa_df = pd.read_csv('data/sofifa/CompleteDataset.csv').drop(['Unnamed: 0'], axis = 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 351,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['name',\n",
       " 'age',\n",
       " 'photo',\n",
       " 'nationality',\n",
       " 'flag',\n",
       " 'overall',\n",
       " 'potential',\n",
       " 'club',\n",
       " 'club_logo',\n",
       " 'value',\n",
       " 'wage',\n",
       " 'special',\n",
       " 'acceleration',\n",
       " 'aggression',\n",
       " 'agility',\n",
       " 'balance',\n",
       " 'ball_control',\n",
       " 'composure',\n",
       " 'crossing',\n",
       " 'curve',\n",
       " 'dribbling',\n",
       " 'finishing',\n",
       " 'free_kick_accuracy',\n",
       " 'gk_diving',\n",
       " 'gk_handling',\n",
       " 'gk_kicking',\n",
       " 'gk_positioning',\n",
       " 'gk_reflexes',\n",
       " 'heading_accuracy',\n",
       " 'interceptions',\n",
       " 'jumping',\n",
       " 'long_passing',\n",
       " 'long_shots',\n",
       " 'marking',\n",
       " 'penalties',\n",
       " 'positioning',\n",
       " 'reactions',\n",
       " 'short_passing',\n",
       " 'shot_power',\n",
       " 'sliding_tackle',\n",
       " 'sprint_speed',\n",
       " 'stamina',\n",
       " 'standing_tackle',\n",
       " 'strength',\n",
       " 'vision',\n",
       " 'volleys',\n",
       " 'cam',\n",
       " 'cb',\n",
       " 'cdm',\n",
       " 'cf',\n",
       " 'cm',\n",
       " 'id',\n",
       " 'lam',\n",
       " 'lb',\n",
       " 'lcb',\n",
       " 'lcm',\n",
       " 'ldm',\n",
       " 'lf',\n",
       " 'lm',\n",
       " 'ls',\n",
       " 'lw',\n",
       " 'lwb',\n",
       " 'preferred_positions',\n",
       " 'ram',\n",
       " 'rb',\n",
       " 'rcb',\n",
       " 'rcm',\n",
       " 'rdm',\n",
       " 'rf',\n",
       " 'rm',\n",
       " 'rs',\n",
       " 'rw',\n",
       " 'rwb',\n",
       " 'st']"
      ]
     },
     "execution_count": 351,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "[column.lower().replace(\" \", \"_\") for column in sofifa_df.columns]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 353,
   "metadata": {},
   "outputs": [],
   "source": [
    "player_pos = [\n",
    "'cam',\n",
    "'cb',\n",
    "'cdm',\n",
    "'cf',\n",
    "'cm',\n",
    "'id',\n",
    "'lam',\n",
    "'lb',\n",
    "'lcb',\n",
    "'lcm',\n",
    "'ldm',\n",
    "'lf',\n",
    "'lm',\n",
    "'ls',\n",
    "'lw',\n",
    "'lwb',\n",
    "'ram',\n",
    "'rb',\n",
    "'rcb',\n",
    "'rcm',\n",
    "'rdm',\n",
    "'rf',\n",
    "'rm',\n",
    "'rs',\n",
    "'rw',\n",
    "'rwb',\n",
    "'st'\n",
    "]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 349,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['',\n",
       " '_overall_rating',\n",
       " '_potential',\n",
       " '_preferred_foot',\n",
       " '_attacking_work_rate',\n",
       " '_defensive_work_rate',\n",
       " '_crossing',\n",
       " '_finishing',\n",
       " '_heading_accuracy',\n",
       " '_short_passing',\n",
       " '_volleys',\n",
       " '_dribbling',\n",
       " '_curve',\n",
       " '_free_kick_accuracy',\n",
       " '_long_passing',\n",
       " '_ball_control',\n",
       " '_acceleration',\n",
       " '_sprint_speed',\n",
       " '_agility',\n",
       " '_reactions',\n",
       " '_balance',\n",
       " '_shot_power',\n",
       " '_jumping',\n",
       " '_stamina',\n",
       " '_strength',\n",
       " '_long_shots',\n",
       " '_aggression',\n",
       " '_interceptions',\n",
       " '_positioning',\n",
       " '_vision',\n",
       " '_penalties',\n",
       " '_marking',\n",
       " '_standing_tackle',\n",
       " '_sliding_tackle',\n",
       " '_gk_diving',\n",
       " '_gk_handling',\n",
       " '_gk_kicking',\n",
       " '_gk_positioning',\n",
       " '_gk_reflexes']"
      ]
     },
     "execution_count": 349,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "player_columns = [column.split('11')[-1] for column in match_final_df.columns if \"home_player_11\" in column]\n",
    "player_columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
