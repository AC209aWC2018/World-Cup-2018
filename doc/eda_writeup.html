<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Exploratory Data Analysis &#8212; World Cup  documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Baseline Model" href="baseline_writeup.html" />
    <link rel="prev" title="Description of Data" href="data_description.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          World Cup</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Introduction:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="problem_statement.html">Overview and Motivation</a></li>
<li class="toctree-l1"><a class="reference internal" href="related_works.html">Literature Review and Related Works</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_description.html">Description of Data</a></li>
</ul>
<p class="caption"><span class="caption-text">EDA:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Exploratory Data Analysis</a></li>
</ul>
<p class="caption"><span class="caption-text">Models:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="baseline_writeup.html">Baseline Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="beyond_baseline_writeup.html">Beyond Baseline</a></li>
<li class="toctree-l1"><a class="reference internal" href="neural_network_writeup.html">Bonus: Neural Network on Small Training Set</a></li>
</ul>
<p class="caption"><span class="caption-text">Summary and Conclusion:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="results_writeup.html">Results Summary</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Project Summary and Future Work</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Exploratory Data Analysis</a><ul>
<li><a class="reference internal" href="#European-Matches">European Matches</a></li>
<li><a class="reference internal" href="#Conclusion-From-Europen-Dataset">Conclusion From Europen Dataset</a></li>
<li><a class="reference internal" href="#Further-Exploring-Other-Features">Further Exploring Other Features</a></li>
<li><a class="reference internal" href="#Exploring-PCA">Exploring PCA</a></li>
<li><a class="reference internal" href="#Summary">Summary</a></li>
<li><a class="reference internal" href="#Interpreting-PCA">Interpreting PCA</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="data_description.html" title="Previous Chapter: Description of Data"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Description of Data</span>
    </a>
  </li>
  <li>
    <a href="baseline_writeup.html" title="Next Chapter: Baseline Model"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">Baseline Model &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../_sources/doc/eda_writeup.ipynb.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="Exploratory-Data-Analysis">
<h1>Exploratory Data Analysis<a class="headerlink" href="#Exploratory-Data-Analysis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="European-Matches">
<h2>European Matches<a class="headerlink" href="#European-Matches" title="Permalink to this headline">¶</a></h2>
<p>For each match, we compute the average statistics for the different
ratings for each team and difference them. Just getting the total value
would not unfortunately work due to some rows potentially having uneven
number of values missing. We then take the difference in the statistic
for the home team and away team. For goal keeping ratings, we will only
look at the max of each team since in theory the goal keepers in a match
should have the best goal keeper statistics.</p>
<p>Now let’s see if there are any differences in the distributions of the
differences depending on whether the home team lost, won, or tied.</p>
<div class="figure" id="id1">
<img alt="Differences in the distributions" src="../_images/eda_mean.png" />
<p class="caption"><span class="caption-text">Differences in the distributions</span></p>
</div>
<p>From looking at the mean, it seems in general the mean value for a
difference in rating when the home team wins is the greatest out of the
three outcomes while the mean value for the difference in rating when
the home team loses is the lowest ouf the three outcomes. This seems
consistent with what we believe. However, the mean differences seem a
little low for any of these cases, especially since the rating ranges
from 0 to 100, so mean differences of such small magnitudes might not be
significant. Let’s plot the distributions themselves.</p>
<div class="figure" id="id2">
<img alt="Distributions" src="../_images/dist.png" />
<p class="caption"><span class="caption-text">Distributions</span></p>
</div>
<p>Wow! From looking at the plots the distributions of a difference in
rating among the three outcome do not really seem that different.</p>
<p>This might be an indication that using individual ratings and
aggregating them might not be the way to go. Also, so far efforts to get
the individual ratings for the actual World Cup data have been
unsuccessful, so this may be a sign to find other set of features to
predict the world cup. (Later we will see an attempt of using team
statistics)</p>
<p>Let us also look at whether previous match results will be good
predictors.</p>
<div class="figure" id="id3">
<img alt="Previous matches" src="../_images/prev_matches.png" />
<p class="caption"><span class="caption-text">Previous matches</span></p>
</div>
<p>We see a similar pattern as before, where home team winning has the
highest mean values and away team winning has the lowest mean values.
This time the small magnitudes make sense however since we are only
looking up to 5 games back. Let us also plot the distributions.</p>
<div class="figure" id="id4">
<img alt="Distribution of previous matches" src="../_images/dist_prev_matches.png" />
<p class="caption"><span class="caption-text">Distribution of previous matches</span></p>
</div>
<p>This time it is a bit more obvious that home team winning tends to have
higher values. It seems like we can probably calculate some kind of
momentum and utilize it as a predictor. We will explore more of this
concept later on when we make our advanced model.</p>
</div>
<div class="section" id="Conclusion-From-Europen-Dataset">
<h2>Conclusion From Europen Dataset<a class="headerlink" href="#Conclusion-From-Europen-Dataset" title="Permalink to this headline">¶</a></h2>
<p>From exploration of the European dataset, we saw that aggregating
individual player ratings does not seem to help that much while previous
matches seem to help. Thus, we decided to only keep the summary
statistics of the team rather than players’ individual statistics. We
will keep these discoveries in mind as we move on to the SOFIFA
datasets.</p>
</div>
<div class="section" id="Further-Exploring-Other-Features">
<h2>Further Exploring Other Features<a class="headerlink" href="#Further-Exploring-Other-Features" title="Permalink to this headline">¶</a></h2>
<div class="figure" id="id5">
<img alt="Spearman" src="../_images/spear_corr_eda.png" />
<p class="caption"><span class="caption-text">Spearman</span></p>
</div>
<p>The spearman correlation plot gives us an idea of how well these
features correlate with our dependent variable. In other words, the
highly correlated features, such as overall difference in ratings should
give us a fairly good idea of team 1/home team winning.</p>
<div class="figure" id="id6">
<img alt="Distribution" src="../_images/dist_2.png" />
<p class="caption"><span class="caption-text">Distribution</span></p>
</div>
<p>In fact, from the distribution plot we see that the features, such as
overall difference in ratings and goalkeeper rating difference, that can
better discriminate win, loss for team 1 are more highly correlated with
the win/lose. Similarly, features, such as build up dribbling
difference, which have low correlation barely show any difference
between distribution of different outcomes.</p>
<div class="figure" id="id7">
<img alt="Box plot" src="../_images/boxplot.png" />
<p class="caption"><span class="caption-text">Box plot</span></p>
</div>
<p>Inspecting one of the highly correlated features closely, we see that
when the difference is positive (team 1 has an advantage), the
likelihood of winning is much higher whereas when it’s negative it’s
much more likely to lose.</p>
<div class="figure" id="id8">
<img alt="Wage Dist" src="../_images/dist_wage.png" />
<p class="caption"><span class="caption-text">Wage Dist</span></p>
</div>
<p>However, there are also some features that don’t have really high
correlation and can still discriminate well the win/lose situations when
the difference is large. For instance, for the team wage difference, we
see when the difference is large, it is much more likely to win/lose,
but there is barely any difference in the middle peaking at 0. This is
happening because we imputed missing values with 0 to encode lack of
information. In fact, in these cases we have a lot of distributions with
a really high peak at 0, causing low correlation. Nonetheless, they can
still be useful when we do possess the information.</p>
</div>
<div class="section" id="Exploring-PCA">
<h2>Exploring PCA<a class="headerlink" href="#Exploring-PCA" title="Permalink to this headline">¶</a></h2>
<p>Inspecting these distribution of features, we noticed them a large
proportion of them are similarly shaped and distributed. Therefore, we
considered PCA to perform dimensionality reduction, aggregating similar
features.</p>
<p><img alt="PCA chart" src="../_images/pca_chart.png" /> <img alt="PCA results" src="../_images/pca_results.png" /></p>
</div>
<div class="section" id="Summary">
<h2>Summary<a class="headerlink" href="#Summary" title="Permalink to this headline">¶</a></h2>
<p>First of all, we notice that PCA helps models like LDA and QDA perhaps
because of the independent assumption of components imposed by PCA. On
the other hand, the performance for Logistic Regression, Random Forest,
XGBoost seem to be slightly hurt by the reduced information from PCA.</p>
<p>Nonetheless, we see that the best model is QDA with 9 components from
PCA. This probably means that performing dimensionality reduction is
probably quite helpful in summarizing the information from the data with
similar distributions. We will keep this in mind when picking the final
model.</p>
</div>
<div class="section" id="Interpreting-PCA">
<h2>Interpreting PCA<a class="headerlink" href="#Interpreting-PCA" title="Permalink to this headline">¶</a></h2>
<div class="figure" id="id9">
<img alt="Correlation Circle" src="doc/img/corr_circle.png" />
<p class="caption"><span class="caption-text">Correlation Circle</span></p>
</div>
<p>We only highlighted the top 20 predictors with largest correlation
magnitude as these are likely to be the more important predictors.</p>
<p><code class="docutils literal notranslate"><span class="pre">start_age_diff</span></code> and <code class="docutils literal notranslate"><span class="pre">full_age_diff</span></code> are naturally correlated, and
seem to explain a substantial amount of variation in the data.
<code class="docutils literal notranslate"><span class="pre">growth_diff</span></code>, which is on the other side of the correlation circle,
seems to explain variation that is almost the opposite of
<code class="docutils literal notranslate"><span class="pre">start_age_diff</span></code> and <code class="docutils literal notranslate"><span class="pre">full_age_diff</span></code>. This makes intuitive sense as
we would expect younger players to have more room for growth.</p>
<p><code class="docutils literal notranslate"><span class="pre">attack_away_defence_home_diff</span></code> and <code class="docutils literal notranslate"><span class="pre">rank_diff</span></code> also seem to be
explain similar variation in the data. The rest of the predictors are
all clustered at the 3 o’clock region of the circle, right across the
predictors <code class="docutils literal notranslate"><span class="pre">attack_away_defence_home_diff</span></code> and <code class="docutils literal notranslate"><span class="pre">rank_diff</span></code>. This
suggests that these predictors explain similar variation in the data and
might be correlated.</p>
<p><img alt="Overall vs Start Age" src="../_images/overall_start_age.png" /> <img alt="Offense vs Defense" src="../_images/offense_defense.png" /></p>
<p><img alt="PCA Plot" src="../_images/pca_plot.png" /> <img alt="PCA Table1" src="../_images/eda_table_1.png" /> <img alt="PCA Table2" src="../_images/eda_table_2.png" /></p>
<p>We can see that PC1 is greatly influenced by <code class="docutils literal notranslate"><span class="pre">overall</span></code>, <code class="docutils literal notranslate"><span class="pre">defence</span></code>,
and <code class="docutils literal notranslate"><span class="pre">midfield</span></code>, while PC2 is greatly influenced by <code class="docutils literal notranslate"><span class="pre">full_age</span></code>
(negative), <code class="docutils literal notranslate"><span class="pre">start_age</span></code> (negative), and <code class="docutils literal notranslate"><span class="pre">growth</span></code>. This gives us a
good way to think about the 2D representation of our dataset summarized
by the first two PCs. Teams with higher PC2s generally have lower ages
and thus more potential for growth. They are likely to have lots of
young, promising players. Teams with higher PC1s are statistically
better all-round teams.</p>
<p>While this PCA plot is not a measure of how likely a team will win the
World Cup (since PCAs only involve the predictors), it can still give us
an intuition into the various World Cup teams.</p>
<p>We immediately see that France is probably a strong all-round team that
also has young, promising players. Nigeria is probably a below-average
team but with young, promising players. Costa Rica is probably a
below-average team with older players near their peak. Spain is probably
a strong all-round team but with older players near their peak. These
largely corroborates what we know about those teams.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, Brian Lin, Shane Ong, Pat Sukhum, Matteo Zhang.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>